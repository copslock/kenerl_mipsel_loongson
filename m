Received:  by oss.sgi.com id <S42180AbQJKWgm>;
	Wed, 11 Oct 2000 15:36:42 -0700
Received: from hq.fsmlabs.com ([209.155.42.197]:36874 "EHLO hq.fsmlabs.com")
	by oss.sgi.com with ESMTP id <S42207AbQJKWgW>;
	Wed, 11 Oct 2000 15:36:22 -0700
Received: (from cort@localhost)
	by hq.fsmlabs.com (8.9.3/8.9.3) id QAA30264;
	Wed, 11 Oct 2000 16:32:42 -0600
Date:   Wed, 11 Oct 2000 16:32:42 -0600
From:   Cort Dougan <cort@fsmlabs.com>
To:     Ralf Baechle <ralf@oss.sgi.com>
Cc:     linux-mips@oss.sgi.com, linux-mips@fnet.fr
Subject: Re: modutils bug?  'if' clause executes incorrectly
Message-ID: <20001011163242.F28328@hq.fsmlabs.com>
References: <20001010224317.I733@hq.fsmlabs.com> <20001011173117.D19105@bacchus.dhis.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.4us
In-Reply-To: <20001011173117.D19105@bacchus.dhis.org>; from Ralf Baechle on Wed, Oct 11, 2000 at 05:31:17PM +0200
Sender: owner-linux-mips@oss.sgi.com
Precedence: bulk
Return-Path: <owner-linux-mips@oss.sgi.com>
X-Orcpt: rfc822;linux-mips-outgoing

} On Tue, Oct 10, 2000 at 10:43:17PM -0600, Cort Dougan wrote:
} 
} > This is with GCC version egcs-2.90.29 980515 (egcs-1.0.3 release) and
} > binutils 2.8.1 (with BFD 2.8.1).
} > 
} > The asm in this routine looks good and I can keep the code from failing by
} > removing the request_irq() and replacing it with something else that
} > doesn't call into the kernel.  I can't reproduce this in user-code or in
} > kernel code.
} > 
} > Does anyone have any suggestions?  Perhaps a suggestion for modutils
} > version?
} 
} I have an idea what's going wrong, maybe it's related to something that
} Brady Brown recently discovered.  Are the object files you are trying to
} load generated by the assembler?  If so, try to do a relocatable link
} on them with ld -r module-out.o module-in.o.

The small test case I have (bug.c) is being built through gcc and that does
shove the output through as.

I did a mips-linux-ld -r -o bug.re.o bug.o and I get the same incorrect
execution.
