Received: with ECARTIS (v1.0.0; list linux-mips); Wed, 04 Jul 2007 12:17:06 +0100 (BST)
Received: from wa-out-1112.google.com ([209.85.146.178]:21113 "EHLO
	wa-out-1112.google.com") by ftp.linux-mips.org with ESMTP
	id S20021636AbXGDIZh (ORCPT <rfc822;linux-mips@linux-mips.org>);
	Wed, 4 Jul 2007 09:25:37 +0100
Received: by wa-out-1112.google.com with SMTP id m16so3011273waf
        for <linux-mips@linux-mips.org>; Wed, 04 Jul 2007 01:25:22 -0700 (PDT)
DKIM-Signature:	a=rsa-sha1; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=PtWqmQmcqS/vHDxdmWqwLPzKPQ+n2MkyQ2jWF9sYkyYT3CPx97hVNZsPakjSZUAIyIBCJ+gzBIpaPDK4B7MHAIk5bfn4J55kOorpcJxZGHllPi1162qFfefQ3jQ/L0wAiBxe6fljpW+vAI8HoJPV5V3sAkK8TFfO1pgzLt1ZsyI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=gMmilwO+aj69ZHJB4WsDsEvSem33VqQwlVHspZzLjPDjX4ujYftB/I0ytPFq7T1BVyMxvnlZxMb6NRWil5n5Uq6BdJJtYP/zL7du2rYFzv26nZwZI0Zbwp6ST5+5IMHONqS+U2AEPHWTCVD88m4K1suB0g6hm+Csl6+vLtv3jtw=
Received: by 10.115.32.1 with SMTP id k1mr6995261waj.1183537520316;
        Wed, 04 Jul 2007 01:25:20 -0700 (PDT)
Received: by 10.114.108.4 with HTTP; Wed, 4 Jul 2007 01:25:20 -0700 (PDT)
Message-ID: <6849c8890707040125x34cb2b0jf7acfabfa0bf351f@mail.gmail.com>
Date:	Wed, 4 Jul 2007 09:25:20 +0100
From:	TJ <tj.trevelyan@gmail.com>
To:	"Linux MIPS List" <linux-mips@linux-mips.org>
Subject: Fwd: [RFC] SGI O2 MACE audio ALSA module
In-Reply-To: <6849c8890707020427q47704326od05ebb8241c3cf@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_132389_32726951.1183537520214"
References: <6849c8890707020427q47704326od05ebb8241c3cf@mail.gmail.com>
Return-Path: <tj.trevelyan@gmail.com>
X-Envelope-To: <"|/home/ecartis/ecartis -s linux-mips"> (uid 0)
X-Orcpt: rfc822;linux-mips@linux-mips.org
Original-Recipient: rfc822;linux-mips@linux-mips.org
X-archive-position: 15602
X-Approved-By: ralf@linux-mips.org
X-ecartis-version: Ecartis v1.0.0
Sender: linux-mips-bounce@linux-mips.org
Errors-to: linux-mips-bounce@linux-mips.org
X-original-sender: tj.trevelyan@gmail.com
Precedence: bulk
X-list: linux-mips

------=_Part_132389_32726951.1183537520214
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

(third day, third attempt to send this, apologies if the other
attempts arrive too and spam the list, but since the replies from
other lists are reaching this list I thought it better I keep trying
or the conversation would seem rather one sided)

Hi,

It's been a while since I last posted something. Here is the latest
version of my code. It is somewhat of a mess at the moment, but I plan
to tidy it all up when it works better, any // comments are not
permanent features. I have been using trial and error to find why it
play too fast.

I am glad to say that it does play sound correctly, bar one little
issue that has me stuck at the moment, it plays too fast (for any
sample frequency). Also how fast appears to depend on the player
(tried aplay and ogg123).

I have cc the ALSA dev too in the hope that between the two lists
someone may spot something. Please can anyone who replies cc me.

The patch was built against (applies to) linux-2.6.19.7 from
linux-mips.org. It'll probably work on other versions.

Notes on the module it self...

There are two code 'paths' depending on sma_indirect=1|0, this var
will be made a module load argument. When 0 ALSA will be writing
directly to the MACE ring buffer, currently the state of this code is
believed very broken I have not been working on it for a while. When 1
ALSA will be writing to a bounce buffer and the module will copy data
to the ring buffer as per the original driver.

Currently sma_indirect is hard coded 1 and it is this 'path' i'm
currently interested in fixing.

The module has some proc files for debugging, the contents of the
ad1843 regs, and for values in in mace. There is a _spy version of the
module (which wont exist in my final patch) that provides just these
proc files without making any (init) changes to any of the hardware
(ie read only). This allowed me to see what state the O2 jingle left
the various bit in.

The module has a limited mixer, which I want to do a lot more with in
future, and the front volume buttons are supported.

DAC1/ADC map to dev0 on the card, while DAC2 maps to dev1.

I don't know what else to say, please have a listen and a look. It
will play any samples 8k to 48k, and any bit format that ALSA knows
about.

Regards,

Thorben

------=_Part_132389_32726951.1183537520214
Content-Type: text/x-patch; name=mace_audio-20070702.patch; 
	charset=ANSI_X3.4-1968
Content-Transfer-Encoding: base64
X-Attachment-Id: f_f3mugxi3
Content-Disposition: attachment; filename="mace_audio-20070702.patch"

LS0tIGxpbnV4LTIuNi4xOS43LW9yaWdpbmFsL2luY2x1ZGUvc291bmQvYWQxODQzLmgJMTk3MC0w
MS0wMSAwMTowMDowMC4wMDAwMDAwMDAgKzAxMDAKKysrIGxpbnV4LTIuNi4xOS43L2luY2x1ZGUv
c291bmQvYWQxODQzLmgJMjAwNy0wNC0yMSAwNjo0OToyNy4wMDAwMDAwMDAgKzAxMDAKQEAgLTAs
MCArMSw0OCBAQAorLyoKKyAqIFRoaXMgZmlsZSBpcyBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBhbmQg
Y29uZGl0aW9ucyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljCisgKiBMaWNlbnNlLiAgU2VlIHRo
ZSBmaWxlICJDT1BZSU5HIiBpbiB0aGUgbWFpbiBkaXJlY3Rvcnkgb2YgdGhpcyBhcmNoaXZlCisg
KiBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqIENvcHlyaWdodCAyMDAzIFZpdmllbiBDaGFwcGVs
aWVyIDx2aXZpZW4uY2hhcHBlbGllckBsaW51eC1taXBzLm9yZz4KKyAqLworCisjaWZuZGVmIF9f
U09VTkRfQUQxODQzX0gKKyNkZWZpbmUgX19TT1VORF9BRDE4NDNfSAorCit0eXBlZGVmIHN0cnVj
dCB7CisgIHZvaWQgKmNoaXA7CisgIGludCAoKiByZWFkKSh2b2lkICpjaGlwLCBpbnQgcmVnKTsK
KyAgaW50ICgqIHdyaXRlKSh2b2lkICpjaGlwLCBpbnQgcmVnLCBpbnQgdmFsKTsKK30gYWQxODQz
X3Q7CisKKyNkZWZpbmUgQUQxODQzX0dBSU5fUkVDTEVWIDAKKyNkZWZpbmUgQUQxODQzX0dBSU5f
TElORSAgIDEKKyNkZWZpbmUgQUQxODQzX0dBSU5fQ0QgICAgIDIKKyNkZWZpbmUgQUQxODQzX0dB
SU5fTUlDICAgIDMKKyNkZWZpbmUgQUQxODQzX0dBSU5fUENNXzAgIDQKKyNkZWZpbmUgQUQxODQz
X0dBSU5fUENNXzEgIDUKKyNkZWZpbmUgQUQxODQzX0dBSU5fU0laRSAgIEFEMTg0M19HQUlOX1BD
TV8xKzEKKworaW50IGFkMTg0M19nZXRfZ2FpbihhZDE4NDNfdCAqYWQxODQzLCBpbnQgaWQpOwor
aW50IGFkMTg0M19zZXRfZ2FpbihhZDE4NDNfdCAqYWQxODQzLCBpbnQgaWQsIGludCBuZXd2YWwp
OworaW50IGFkMTg0M19nZXRfcmVjc3JjKGFkMTg0M190ICphZDE4NDMpOwordm9pZCBhZDE4NDNf
c2V0X3Jlc2FtcGxlX21vZGUoYWQxODQzX3QgKmFkMTg0MywgaW50IG9ub2ZmKTsKK2ludCBhZDE4
NDNfc2V0X3JlY3NyYyhhZDE4NDNfdCAqYWQxODQzLCBpbnQgbmV3c3JjKTsKK2ludCBhZDE4NDNf
Z2V0X291dHNyYyhhZDE4NDNfdCAqYWQxODQzKTsKK2ludCBhZDE4NDNfc2V0X291dHNyYyhhZDE4
NDNfdCAqYWQxODQzLCBpbnQgbWFzayk7Cit2b2lkIGFkMTg0M19zZXR1cF9kYWMoYWQxODQzX3Qg
KmFkMTg0MywKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaWQsCisgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZyYW1lcmF0ZSwKKyAgICAgICAgICAgICAgICAg
ICAgICBzbmRfcGNtX2Zvcm1hdF90IGZtdCwKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgY2hhbm5lbHMpOwordm9pZCBhZDE4NDNfc2h1dGRvd25fZGFjKGFkMTg0M190ICphZDE4
NDMsCisgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGlkKTsKK3ZvaWQgYWQx
ODQzX3NldHVwX2FkYyhhZDE4NDNfdCAqYWQxODQzLAorICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBmcmFtZXJhdGUsCisgICAgICAgICAgICAgICAgICAgICAgc25kX3BjbV9mb3Jt
YXRfdCBmbXQsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGNoYW5uZWxzKTsK
K3ZvaWQgYWQxODQzX3NodXRkb3duX2FkYyhhZDE4NDNfdCAqYWQxODQzKTsKK2ludCBhZDE4NDNf
aW5pdChhZDE4NDNfdCAqYWQxODQzKTsKK2NoYXIgKmFkMTg0M19kdW1wX3JlZyhhZDE4NDNfdCAq
YWQxODQzLCBpbnQgcmVnKTsKKworI2VuZGlmIC8qIF9fU09VTkRfQUQxODQzX0ggKi8KCi0tLSBs
aW51eC0yLjYuMTkuNy1vcmlnaW5hbC9zb3VuZC9taXBzL2FkMTg0My5jCTE5NzAtMDEtMDEgMDE6
MDA6MDAuMDAwMDAwMDAwICswMTAwCisrKyBsaW51eC0yLjYuMTkuNy9zb3VuZC9taXBzL2FkMTg0
My5jCTIwMDctMDctMDIgMTE6MzY6MTYuMDAwMDAwMDAwICswMTAwCkBAIC0wLDAgKzEsOTA5IEBA
CisvKgorICogICBBRDE4NDMgbG93IGxldmVsIGRyaXZlcgorICoKKyAqICAgQ29weXJpZ2h0IDIw
MDMgVml2aWVuIENoYXBwZWxpZXIgPHZpdmllbi5jaGFwcGVsaWVyQGxpbnV4LW1pcHMub3JnPgor
ICoKKyAqICAgaW5zcGlyZWQgZnJvbSB2d3NuZC5jIChTR0kgVlcgYXVkaW8gZHJpdmVyKQorICog
ICAgIENvcHlyaWdodCAxOTk5IFNpbGljb24gR3JhcGhpY3MsIEluYy4gIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICogICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogICBpdCB1bmRlciB0aGUgdGVybXMgb2Yg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogICB0aGUg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNl
LCBvcgorICogICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqICAg
VGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1
c2VmdWwsCisgKiAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBp
bXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICAgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZl
ZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAg
IEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSwgU3VpdGUgMzMwLCBCb3N0b24sIE1B
ICAwMjExMS0xMzA3IFVTQQorICoKKyAqLworCisKKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CisK
KyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+CisjaW5jbHVkZSA8bGludXgvamlmZmllcy5oPgorI2lu
Y2x1ZGUgPGxpbnV4L3NjaGVkLmg+CisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRl
IDxsaW51eC9lcnJuby5oPgorI2luY2x1ZGUgPGxpbnV4L3ZtYWxsb2MuaD4KKyNpbmNsdWRlIDxz
b3VuZC9kcml2ZXIuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb3JlLmg+CisjaW5jbHVkZSA8c291bmQv
cGNtLmg+CisjaW5jbHVkZSA8c291bmQvaW5pdHZhbC5oPgorI2luY2x1ZGUgPHNvdW5kL2FkMTg0
My5oPgorCisvLyBmaW5kIGFuZCByZW1vdmUgYW55IE9TUyBzdHVmZgorI2luY2x1ZGUgPGxpbnV4
L3NvdW5kY2FyZC5oPgorCisvKgorICogQUQxODQzIGJpdGZpZWxkIGRlZmluaXRpb25zLiAgQWxs
IGFyZSBuYW1lZCBhcyBpbiB0aGUgQUQxODQzIGRhdGEKKyAqIHNoZWV0LCB3aXRoIGFkMTg0M18g
cHJlcGVuZGVkIGFuZCBpbmRpdmlkdWFsIGJpdCBudW1iZXJzIHJlbW92ZWQuCisgKgorICogRS5n
LiwgYml0cyBMU1MwIHRocm91Z2ggTFNTMiBiZWNvbWUgYWQxODQzX0xTUy4KKyAqCisgKiBPbmx5
IHRoZSBiaXRmaWVsZHMgd2UgbmVlZCBhcmUgZGVmaW5lZC4KKyAqLworCit0eXBlZGVmIHN0cnVj
dCBhZDE4NDNfYml0ZmllbGQgeworICAgICAgIGNoYXIgcmVnOworICAgICAgIGNoYXIgbG9fYml0
OworICAgICAgIGNoYXIgbmJpdHM7Cit9IGFkMTg0M19iaXRmaWVsZF90OworCitzdGF0aWMgY29u
c3QgYWQxODQzX2JpdGZpZWxkX3QKKwlhZDE4NDNfUEROTyAgID0geyAgMCwgMTQsICAxIH0sIC8q
IENvbnZlcnRlciBQb3dlci1Eb3duIEZsYWcgKi8KKwlhZDE4NDNfSU5JVCAgID0geyAgMCwgMTUs
ICAxIH0sIC8qIENsb2NrIEluaXRpYWxpemF0aW9uIEZsYWcgKi8KKwlhZDE4NDNfUklHICAgID0g
eyAgMiwgIDAsICA0IH0sIC8qIFJpZ2h0IEFEQyBJbnB1dCBHYWluICovCisJYWQxODQzX1JNR0Ug
ICA9IHsgIDIsICA0LCAgMSB9LCAvKiBSaWdodCBBREMgTWljIEdhaW4gRW5hYmxlICovCisJYWQx
ODQzX1JTUyAgICA9IHsgIDIsICA1LCAgMyB9LCAvKiBSaWdodCBBREMgU291cmNlIFNlbGVjdCAq
LworCWFkMTg0M19MSUcgICAgPSB7ICAyLCAgOCwgIDQgfSwgLyogTGVmdCBBREMgSW5wdXQgR2Fp
biAqLworCWFkMTg0M19MTUdFICAgPSB7ICAyLCAxMiwgIDEgfSwgLyogTGVmdCBBREMgTWljIEdh
aW4gRW5hYmxlICovCisJYWQxODQzX0xTUyAgICA9IHsgIDIsIDEzLCAgMyB9LCAvKiBMZWZ0IEFE
QyBTb3VyY2UgU2VsZWN0ICovCisJYWQxODQzX1JYMU0gICA9IHsgIDQsICAwLCAgNSB9LCAvKiBS
aWdodCBBdXggMSBNaXggR2Fpbi9BdHRlbiAqLworCWFkMTg0M19SWDFNTSAgPSB7ICA0LCAgNywg
IDEgfSwgLyogUmlnaHQgQXV4IDEgTWl4IE11dGUgKi8KKwlhZDE4NDNfTFgxTSAgID0geyAgNCwg
IDgsICA1IH0sIC8qIExlZnQgQXV4IDEgTWl4IEdhaW4vQXR0ZW4gKi8KKwlhZDE4NDNfTFgxTU0g
ID0geyAgNCwgMTUsICAxIH0sIC8qIExlZnQgQXV4IDEgTWl4IE11dGUgKi8KKwlhZDE4NDNfUlgy
TSAgID0geyAgNSwgIDAsICA1IH0sIC8qIFJpZ2h0IEF1eCAyIE1peCBHYWluL0F0dGVuICovCisJ
YWQxODQzX1JYMk1NICA9IHsgIDUsICA3LCAgMSB9LCAvKiBSaWdodCBBdXggMiBNaXggTXV0ZSAq
LworCWFkMTg0M19MWDJNICAgPSB7ICA1LCAgOCwgIDUgfSwgLyogTGVmdCBBdXggMiBNaXggR2Fp
bi9BdHRlbiAqLworCWFkMTg0M19MWDJNTSAgPSB7ICA1LCAxNSwgIDEgfSwgLyogTGVmdCBBdXgg
MiBNaXggTXV0ZSAqLworCWFkMTg0M19STUNNICAgPSB7ICA3LCAgMCwgIDUgfSwgLyogUmlnaHQg
TWljIE1peCBHYWluL0F0dGVuICovCisJYWQxODQzX1JNQ01NICA9IHsgIDcsICA3LCAgMSB9LCAv
KiBSaWdodCBNaWMgTWl4IE11dGUgKi8KKwlhZDE4NDNfTE1DTSAgID0geyAgNywgIDgsICA1IH0s
IC8qIExlZnQgTWljIE1peCBHYWluL0F0dGVuICovCisJYWQxODQzX0xNQ01NICA9IHsgIDcsIDE1
LCAgMSB9LCAvKiBMZWZ0IE1pYyBNaXggTXV0ZSAqLworCWFkMTg0M19IUE9TICAgPSB7ICA4LCAg
NCwgIDEgfSwgLyogSGVhZHBob25lIE91dHB1dCBWb2x0YWdlIFN3aW5nICovCisJYWQxODQzX0hQ
T00gICA9IHsgIDgsICA1LCAgMSB9LCAvKiBIZWFkcGhvbmUgT3V0cHV0IE11dGUgKi8KKwlhZDE4
NDNfTVBPTSAgID0geyAgOCwgIDYsICAxIH0sIC8qIE1vbm8gT3V0cHV0IE11dGUgKi8KKwlhZDE4
NDNfUkRBMUcgID0geyAgOSwgIDAsICA2IH0sIC8qIFJpZ2h0IERBQzEgQW5hbG9nL0RpZ2l0YWwg
R2FpbiAqLworCWFkMTg0M19SREExR00gPSB7ICA5LCAgNywgIDEgfSwgLyogUmlnaHQgREFDMSBB
bmFsb2cgTXV0ZSAqLworCWFkMTg0M19MREExRyAgPSB7ICA5LCAgOCwgIDYgfSwgLyogTGVmdCBE
QUMxIEFuYWxvZy9EaWdpdGFsIEdhaW4gKi8KKwlhZDE4NDNfTERBMUdNID0geyAgOSwgMTUsICAx
IH0sIC8qIExlZnQgREFDMSBBbmFsb2cgTXV0ZSAqLworCWFkMTg0M19SREEyRyAgPSB7IDEwLCAg
MCwgIDYgfSwgLyogUmlnaHQgREFDMiBBbmFsb2cvRGlnaXRhbCBHYWluICovCisJYWQxODQzX1JE
QTJHTSA9IHsgMTAsICA3LCAgMSB9LCAvKiBSaWdodCBEQUMyIEFuYWxvZyBNdXRlICovCisJYWQx
ODQzX0xEQTJHICA9IHsgMTAsICA4LCAgNiB9LCAvKiBMZWZ0IERBQzIgQW5hbG9nL0RpZ2l0YWwg
R2FpbiAqLworCWFkMTg0M19MREEyR00gPSB7IDEwLCAxNSwgIDEgfSwgLyogTGVmdCBEQUMyIEFu
YWxvZyBNdXRlICovCisJYWQxODQzX1JEQTFBTSA9IHsgMTEsICA3LCAgMSB9LCAvKiBSaWdodCBE
QUMxIERpZ2l0YWwgTXV0ZSAqLworCWFkMTg0M19MREExQU0gPSB7IDExLCAxNSwgIDEgfSwgLyog
TGVmdCBEQUMxIERpZ2l0YWwgTXV0ZSAqLworCWFkMTg0M19SREEyQU0gPSB7IDEyLCAgNywgIDEg
fSwgLyogUmlnaHQgREFDMSBEaWdpdGFsIE11dGUgKi8KKwlhZDE4NDNfTERBMkFNID0geyAxMiwg
MTUsICAxIH0sIC8qIExlZnQgREFDMSBEaWdpdGFsIE11dGUgKi8KKwlhZDE4NDNfQURMQyAgID0g
eyAxNSwgIDAsICAyIH0sIC8qIEFEQyBMZWZ0IFNhbXBsZSBSYXRlIFNvdXJjZSAqLworCWFkMTg0
M19BRFJDICAgPSB7IDE1LCAgMiwgIDIgfSwgLyogQURDIFJpZ2h0IFNhbXBsZSBSYXRlIFNvdXJj
ZSAqLworCWFkMTg0M19EQTFDICAgPSB7IDE1LCAgOCwgIDIgfSwgLyogREFDMSBTYW1wbGUgUmF0
ZSBTb3VyY2UgKi8KKwlhZDE4NDNfREEyQyAgID0geyAxNSwgMTAsICAyIH0sIC8qIERBQzIgU2Ft
cGxlIFJhdGUgU291cmNlICovCisJYWQxODQzX0MxTSAgICA9IHsgMTYsICAwLCAgOCB9LCAvKiBD
bG9jayAxIFJhdGUgTW9kaWZpZXIgKi8KKwlhZDE4NDNfQzFDMTI4ID0geyAxNiwgMTAsICAxIH0s
IC8qIENsb2NrIDEgQ09OVjEgRnJlcSBzZWxlY3QgKi8KKwlhZDE4NDNfQzFDICAgID0geyAxNywg
IDAsIDE2IH0sIC8qIENsb2NrIDEgU2FtcGxlIFJhdGUgU2VsZWN0ICovCisJYWQxODQzX0MyTSAg
ICA9IHsgMTksICAwLCAgOCB9LCAvKiBDbG9jayAyIFJhdGUgTW9kaWZpZXIgKi8KKwlhZDE4NDNf
QzJDICAgID0geyAyMCwgIDAsIDE2IH0sIC8qIENsb2NrIDIgU2FtcGxlIFJhdGUgU2VsZWN0ICov
CisJYWQxODQzX0MzTSAgICA9IHsgMjIsICAwLCAgOCB9LCAvKiBDbG9jayAzIFJhdGUgTW9kaWZp
ZXIgKi8KKwlhZDE4NDNfQzNDICAgID0geyAyMywgIDAsIDE2IH0sIC8qIENsb2NrIDMgU2FtcGxl
IFJhdGUgU2VsZWN0ICovCisJYWQxODQzX0RBQURMICA9IHsgMjUsICA0LCAgMiB9LCAvKiBEaWdp
dGFsIEFEQyBMZWZ0IFNvdXJjZSBTZWxlY3QgKi8KKwlhZDE4NDNfREFBRFIgID0geyAyNSwgIDYs
ICAyIH0sIC8qIERpZ2l0YWwgQURDIFJpZ2h0IFNvdXJjZSBTZWxlY3QgKi8KKwlhZDE4NDNfRFJT
RkxUID0geyAyNSwgMTUsICAxIH0sIC8qIERpZ2l0YWwgUmVhbXBsZXIgRmlsdGVyIE1vZGUgKi8K
KwlhZDE4NDNfQURMRiAgID0geyAyNiwgIDAsICAyIH0sIC8qIEFEQyBMZWZ0IENoYW5uZWwgRGF0
YSBGb3JtYXQgKi8KKwlhZDE4NDNfQURSRiAgID0geyAyNiwgIDIsICAyIH0sIC8qIEFEQyBSaWdo
dCBDaGFubmVsIERhdGEgRm9ybWF0ICovCisJYWQxODQzX0FEVExLICA9IHsgMjYsICA0LCAgMSB9
LCAvKiBBREMgVHJhbnNtaXQgTG9jayBNb2RlIFNlbGVjdCAqLworCWFkMTg0M19GUlMgICAgPSB7
IDI2LCAgNiwgIDEgfSwgLyogRnJhbWUgc2l6ZSBzZWxlY3QgKi8KKwlhZDE4NDNfU0NGICAgID0g
eyAyNiwgIDcsICAxIH0sIC8qIFNDTEsgRnJlcXVlbmN5IFNlbGVjdCAqLworCWFkMTg0M19EQTFG
ICAgPSB7IDI2LCAgOCwgIDIgfSwgLyogREFDMSBEYXRhIEZvcm1hdCBTZWxlY3QgKi8KKwlhZDE4
NDNfREEyRiAgID0geyAyNiwgMTAsICAyIH0sIC8qIERBQzIgRGF0YSBGb3JtYXQgU2VsZWN0ICov
CisJYWQxODQzX0RBMVNNICA9IHsgMjYsIDE0LCAgMSB9LCAvKiBEQUMxIFN0ZXJlby9Nb25vIE1v
ZGUgU2VsZWN0ICovCisJYWQxODQzX0RBMlNNICA9IHsgMjYsIDE1LCAgMSB9LCAvKiBEQUMyIFN0
ZXJlby9Nb25vIE1vZGUgU2VsZWN0ICovCisJYWQxODQzX0FETEVOICA9IHsgMjcsICAwLCAgMSB9
LCAvKiBBREMgTGVmdCBDaGFubmVsIEVuYWJsZSAqLworCWFkMTg0M19BRFJFTiAgPSB7IDI3LCAg
MSwgIDEgfSwgLyogQURDIFJpZ2h0IENoYW5uZWwgRW5hYmxlICovCisJYWQxODQzX0FBTUVOICA9
IHsgMjcsICA0LCAgMSB9LCAvKiBBbmFsb2cgdG8gQW5hbG9nIE1peCBFbmFibGUgKi8KKwlhZDE4
NDNfQU5BRU4gID0geyAyNywgIDcsICAxIH0sIC8qIEFuYWxvZyBDaGFubmVsIEVuYWJsZSAqLwor
CWFkMTg0M19EQTFFTiAgPSB7IDI3LCAgOCwgIDEgfSwgLyogREFDMSBFbmFibGUgKi8KKwlhZDE4
NDNfREEyRU4gID0geyAyNywgIDksICAxIH0sIC8qIERBQzIgRW5hYmxlICovCisJYWQxODQzX0VO
QlQxICA9IHsgMjgsICAyLCAgMSB9LCAvKiBCSVQxIFBpbiBFbmFibGUgKi8KKwlhZDE4NDNfRU5D
VjEgID0geyAyOCwgIDMsICAxIH0sIC8qIENPTlYxIFBpbiBFbmFibGUgKi8KKwlhZDE4NDNfRU5C
VDIgID0geyAyOCwgIDQsICAxIH0sIC8qIEJJVDIgUGluIEVuYWJsZSAqLworCWFkMTg0M19FTkNW
MiAgPSB7IDI4LCAgNSwgIDEgfSwgLyogQ09OVjIgUGluIEVuYWJsZSAqLworCWFkMTg0M19FTkJU
MyAgPSB7IDI4LCAgNiwgIDEgfSwgLyogQklUMyBQaW4gRW5hYmxlICovCisJYWQxODQzX0VOQ1Yz
ICA9IHsgMjgsICA3LCAgMSB9LCAvKiBDT05WMyBQaW4gRW5hYmxlICovCisJYWQxODQzX0VOQ0xL
TyA9IHsgMjgsIDEwLCAgMSB9LCAvKiBDbG9ja091dCBQaW4gRW5hYmxlICovCisJYWQxODQzX0Mx
RU4gICA9IHsgMjgsIDExLCAgMSB9LCAvKiBDbG9jayBHZW5lcmF0b3IgMSBFbmFibGUgKi8KKwlh
ZDE4NDNfQzJFTiAgID0geyAyOCwgMTIsICAxIH0sIC8qIENsb2NrIEdlbmVyYXRvciAyIEVuYWJs
ZSAqLworCWFkMTg0M19DM0VOICAgPSB7IDI4LCAxMywgIDEgfSwgLyogQ2xvY2sgR2VuZXJhdG9y
IDMgRW5hYmxlICovCisJYWQxODQzX0FDRU4gICA9IHsgMjgsIDE0LCAgMSB9LCAvKiBBdXRvY2Fs
aWJyYXRpb24gZW5hYmxlICovCisJYWQxODQzX1BETkkgICA9IHsgMjgsIDE1LCAgMSB9OyAvKiBD
b252ZXJ0ZXIgUG93ZXIgRG93biAqLworCisKKy8qCisgKiBUaGUgdmFyaW91cyByZWdpc3RlcnMg
b2YgdGhlIEFEMTg0MyB1c2UgdGhyZWUgZGlmZmVyZW50IGZvcm1hdHMgZm9yCisgKiBzcGVjaWZ5
aW5nIGdhaW4uICBUaGUgYWQxODQzX2dhaW4gc3RydWN0dXJlIHBhcmFtZXRlcml6ZXMgdGhlCisg
KiBmb3JtYXRzLgorICovCisKK3R5cGVkZWYgc3RydWN0IGFkMTg0M19nYWluIHsKKyAgICAgICBp
bnQgICAgIG5lZ2F0aXZlOyAgICAgICAgICAgICAgIC8qIG5vbnplcm8gaWYgZ2FpbiBpcyBuZWdh
dGl2ZS4gKi8KKyAgICAgICBjb25zdCBhZDE4NDNfYml0ZmllbGRfdCAqbGZpZWxkOworICAgICAg
IGNvbnN0IGFkMTg0M19iaXRmaWVsZF90ICpyZmllbGQ7Cit9IGFkMTg0M19nYWluX3Q7CisKK2Nv
bnN0IGFkMTg0M19nYWluX3QgYWQxODQzX2dhaW5fUkVDTEVWCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgPSB7IDAsICZhZDE4NDNfTElHLCAgICZhZDE4NDNfUklHIH07Citjb25zdCBh
ZDE4NDNfZ2Fpbl90IGFkMTg0M19nYWluX0xJTkUKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA9IHsgMSwgJmFkMTg0M19MWDFNLCAgJmFkMTg0M19SWDFNIH07Citjb25zdCBhZDE4NDNf
Z2Fpbl90IGFkMTg0M19nYWluX0NECisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7
IDEsICZhZDE4NDNfTFgyTSwgICZhZDE4NDNfUlgyTSB9OworY29uc3QgYWQxODQzX2dhaW5fdCBh
ZDE4NDNfZ2Fpbl9NSUMKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgMSwgJmFk
MTg0M19MTUNNLCAgJmFkMTg0M19STUNNIH07Citjb25zdCBhZDE4NDNfZ2Fpbl90IGFkMTg0M19n
YWluX1BDTV8wCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IDEsICZhZDE4NDNf
TERBMUcsICZhZDE4NDNfUkRBMUcgfTsKK2NvbnN0IGFkMTg0M19nYWluX3QgYWQxODQzX2dhaW5f
UENNXzEKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgMSwgJmFkMTg0M19MREEy
RywgJmFkMTg0M19SREEyRyB9OworCitjb25zdCBhZDE4NDNfZ2Fpbl90ICphZDE4NDNfZ2FpbltB
RDE4NDNfR0FJTl9TSVpFXSA9IHsKKyAgJmFkMTg0M19nYWluX1JFQ0xFViwKKyAgJmFkMTg0M19n
YWluX0xJTkUsCisgICZhZDE4NDNfZ2Fpbl9DRCwKKyAgJmFkMTg0M19nYWluX01JQywKKyAgJmFk
MTg0M19nYWluX1BDTV8wLAorICAmYWQxODQzX2dhaW5fUENNXzEsCit9OworCisvKiByZWFkIHRo
ZSBjdXJyZW50IHZhbHVlIG9mIGFuIEFEMTg0MyBiaXRmaWVsZC4gKi8KKworc3RhdGljIGludCBh
ZDE4NDNfcmVhZF9iaXRzKGFkMTg0M190ICphZDE4NDMsIGNvbnN0IGFkMTg0M19iaXRmaWVsZF90
ICpmaWVsZCkKK3sKKyAgICAgICBpbnQgdyA9IGFkMTg0My0+cmVhZChhZDE4NDMtPmNoaXAsIGZp
ZWxkLT5yZWcpOworICAgICAgIGludCB2YWwgPSB3ID4+IGZpZWxkLT5sb19iaXQgJiAoKDEgPDwg
ZmllbGQtPm5iaXRzKSAtIDEpOworCisgICAgICAgcmV0dXJuIHZhbDsKK30KKworLyoKKyAqIHdy
aXRlIGEgbmV3IHZhbHVlIHRvIGFuIEFEMTg0MyBiaXRmaWVsZCBhbmQgcmV0dXJuIHRoZSBvbGQg
dmFsdWUuCisgKi8KKworc3RhdGljIGludCBhZDE4NDNfd3JpdGVfYml0cyhhZDE4NDNfdCAqYWQx
ODQzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkMTg0M19iaXRmaWVsZF90
ICpmaWVsZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgbmV3dmFsKQoreworICAg
ICAgIGludCB3ID0gYWQxODQzLT5yZWFkKGFkMTg0My0+Y2hpcCwgZmllbGQtPnJlZyk7CisgICAg
ICAgaW50IG1hc2sgPSAoKDEgPDwgZmllbGQtPm5iaXRzKSAtIDEpIDw8IGZpZWxkLT5sb19iaXQ7
CisgICAgICAgaW50IG9sZHZhbCA9ICh3ICYgbWFzaykgPj4gZmllbGQtPmxvX2JpdDsKKyAgICAg
ICBpbnQgbmV3Yml0cyA9IChuZXd2YWwgPDwgZmllbGQtPmxvX2JpdCkgJiBtYXNrOworICAgICAg
IHcgPSAodyAmIH5tYXNrKSB8IG5ld2JpdHM7CisgICAgICAgKHZvaWQpIGFkMTg0My0+d3JpdGUo
YWQxODQzLT5jaGlwLCBmaWVsZC0+cmVnLCB3KTsKKworICAgICAgIHJldHVybiBvbGR2YWw7Cit9
CisKKy8qCisgKiBhZDE4NDNfcmVhZF9tdWx0aSByZWFkcyBtdWx0aXBsZSBiaXRmaWVsZHMgZnJv
bSB0aGUgc2FtZSBBRDE4NDMKKyAqIHJlZ2lzdGVyLiAgSXQgdXNlcyBhIHNpbmdsZSByZWFkIGN5
Y2xlIHRvIGRvIGl0LiAgKFJlYWRpbmcgdGhlCisgKiBhZDE4NDMgcmVxdWlyZXMgMjU2IGJpdCB0
aW1lcyBhdCAxMi4yODggTUh6LCBvciBuZWFybHkgMjAKKyAqIG1pY3Jvc2Vjb25kcy4pCisgKgor
ICogQ2FsbGVkIGxpa2UgdGhpcy4KKyAqCisgKiAgYWQxODQzX3JlYWRfbXVsdGkoYWQxODQzLCBu
ZmllbGRzLAorICogICAgICAgICAgICAgICAgICAgJmFkMTg0M19GSUVMRDEsICZ2YWwxLAorICog
ICAgICAgICAgICAgICAgICAgJmFkMTg0M19GSUVMRDIsICZ2YWwyLCAuLi4pOworICovCisKK3N0
YXRpYyB2b2lkIGFkMTg0M19yZWFkX211bHRpKGFkMTg0M190ICphZDE4NDMsIGludCBhcmdjb3Vu
dCwgLi4uKQoreworICAgICAgIHZhX2xpc3QgYXA7CisgICAgICAgY29uc3QgYWQxODQzX2JpdGZp
ZWxkX3QgKmZwOworICAgICAgIGludCB3ID0gMCwgbWFzaywgKnZhbHVlLCByZWcgPSAtMTsKKwor
ICAgICAgIHZhX3N0YXJ0KGFwLCBhcmdjb3VudCk7CisgICAgICAgd2hpbGUgKC0tYXJnY291bnQg
Pj0gMCkgeworICAgICAgICAgICAgICAgZnAgPSB2YV9hcmcoYXAsIGNvbnN0IGFkMTg0M19iaXRm
aWVsZF90ICopOworICAgICAgICAgICAgICAgdmFsdWUgPSB2YV9hcmcoYXAsIGludCAqKTsKKwor
ICAgICAgICAgICAgICAgaWYgKHJlZyA9PSAtMSkgeworICAgICAgICAgICAgICAgICAgICAgICBy
ZWcgPSBmcC0+cmVnOworICAgICAgICAgICAgICAgICAgICAgICB3ID0gYWQxODQzLT5yZWFkKGFk
MTg0My0+Y2hpcCwgcmVnKTsKKyAgICAgICAgICAgICAgIH0KKworICAgICAgICAgICAgICAgbWFz
ayA9ICgxIDw8IGZwLT5uYml0cykgLSAxOworICAgICAgICAgICAgICAgKnZhbHVlID0gdyA+PiBm
cC0+bG9fYml0ICYgbWFzazsKKyAgICAgICB9CisgICAgICAgdmFfZW5kKGFwKTsKKworfQorCisv
KgorICogYWQxODQzX3dyaXRlX211bHRpIHN0b3JlcyBtdWx0aXBsZSBiaXRmaWVsZHMgaW50byB0
aGUgc2FtZSBBRDE4NDMKKyAqIHJlZ2lzdGVyLiAgSXQgdXNlcyBvbmUgcmVhZCBhbmQgb25lIHdy
aXRlIGN5Y2xlIHRvIGRvIGl0LgorICoKKyAqIENhbGxlZCBsaWtlIHRoaXMuCisgKgorICogIGFk
MTg0M193cml0ZV9tdWx0aShhZDE4NDMsIG5maWVsZHMsCisgKiAgICAgICAgICAgICAgICAgICAg
JmFkMTg0M19GSUVMRDEsIHZhbDEsCisgKiAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19GSUVM
RjIsIHZhbDIsIC4uLik7CisgKi8KKworc3RhdGljIHZvaWQgYWQxODQzX3dyaXRlX211bHRpKGFk
MTg0M190ICphZDE4NDMsIGludCBhcmdjb3VudCwgLi4uKQoreworICAgICAgIHZhX2xpc3QgYXA7
CisgICAgICAgaW50IHJlZzsKKyAgICAgICBjb25zdCBhZDE4NDNfYml0ZmllbGRfdCAqZnA7Cisg
ICAgICAgaW50IHZhbHVlOworICAgICAgIGludCB3LCBtLCBtYXNrLCBiaXRzOworCisgICAgICAg
bWFzayA9IDA7CisgICAgICAgYml0cyA9IDA7CisgICAgICAgcmVnID0gLTE7CisKKyAgICAgICB2
YV9zdGFydChhcCwgYXJnY291bnQpOworICAgICAgIHdoaWxlICgtLWFyZ2NvdW50ID49IDApIHsK
KyAgICAgICAgICAgICAgIGZwID0gdmFfYXJnKGFwLCBjb25zdCBhZDE4NDNfYml0ZmllbGRfdCAq
KTsKKyAgICAgICAgICAgICAgIHZhbHVlID0gdmFfYXJnKGFwLCBpbnQpOworICAgICAgICAgICAg
ICAgaWYgKHJlZyA9PSAtMSkKKyAgICAgICAgICAgICAgICAgICAgICAgcmVnID0gZnAtPnJlZzsK
KworICAgICAgICAgICAgICAgbSA9ICgoMSA8PCBmcC0+bmJpdHMpIC0gMSkgPDwgZnAtPmxvX2Jp
dDsKKyAgICAgICAgICAgICAgIG1hc2sgfD0gbTsKKyAgICAgICAgICAgICAgIGJpdHMgfD0gKHZh
bHVlIDw8IGZwLT5sb19iaXQpICYgbTsKKyAgICAgICB9CisgICAgICAgdmFfZW5kKGFwKTsKKwor
ICAgICAgIGlmICh+bWFzayAmIDB4RkZGRikKKyAgICAgICAgICAgICAgIHcgPSBhZDE4NDMtPnJl
YWQoYWQxODQzLT5jaGlwLCByZWcpOworICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgIHcgPSAw
OworICAgICAgIHcgPSAodyAmIH5tYXNrKSB8IGJpdHM7CisgICAgICAgKHZvaWQpIGFkMTg0My0+
d3JpdGUoYWQxODQzLT5jaGlwLCByZWcsIHcpOworfQorCisvKgorICogYWQxODQzX2dldF9nYWlu
IHJlYWRzIHRoZSBzcGVjaWZpZWQgcmVnaXN0ZXIgYW5kIGV4dHJhY3RzIHRoZSBnYWluIHZhbHVl
CisgKiB1c2luZyB0aGUgc3VwcGxpZWQgZ2FpbiB0eXBlLiAgSXQgcmV0dXJucyB0aGUgZ2FpbiBp
biBPU1MgZm9ybWF0LgorICovCisKK2ludCBhZDE4NDNfZ2V0X2dhaW4oYWQxODQzX3QgKmFkMTg0
MywgaW50IGlkKQoreworICAgICAgIGludCBsZywgcmc7CisgICAgICAgIGNvbnN0IGFkMTg0M19n
YWluX3QgKmdwID0gYWQxODQzX2dhaW5baWRdOworICAgICAgIHVuc2lnbmVkIHNob3J0IG1hc2sg
PSAoMSA8PCBncC0+bGZpZWxkLT5uYml0cykgLSAxOworCisgICAgICAgYWQxODQzX3JlYWRfbXVs
dGkoYWQxODQzLCAyLCBncC0+bGZpZWxkLCAmbGcsIGdwLT5yZmllbGQsICZyZyk7CisgICAgICAg
aWYgKGdwLT5uZWdhdGl2ZSkgeworICAgICAgICAgICAgICAgbGcgPSBtYXNrIC0gbGc7CisgICAg
ICAgICAgICAgICByZyA9IG1hc2sgLSByZzsKKyAgICAgICB9CisgICAgICAgbGcgPSAobGcgKiAx
MDAgKyAobWFzayA+PiAxKSkgLyBtYXNrOworICAgICAgIHJnID0gKHJnICogMTAwICsgKG1hc2sg
Pj4gMSkpIC8gbWFzazsKKyAgICAgICByZXR1cm4gbGcgPDwgMCB8IHJnIDw8IDg7Cit9CisKKy8q
CisgKiBTZXQgYW4gYXVkaW8gY2hhbm5lbCdzIGdhaW4uIENvbnZlcnRzIGZyb20gT1NTIGZvcm1h
dCB0byBBRDE4NDMncworICogZm9ybWF0LgorICoKKyAqIFJldHVybnMgdGhlIG5ldyBnYWluLCB3
aGljaCBtYXkgYmUgbG93ZXIgdGhhbiB0aGUgb2xkIGdhaW4uCisgKi8KKworaW50IGFkMTg0M19z
ZXRfZ2FpbihhZDE4NDNfdCAqYWQxODQzLAorICAgICAgICAgICAgICAgICAgICBpbnQgaWQsCisg
ICAgICAgICAgICAgICAgICAgIGludCBuZXd2YWwpCit7CisgICAgICAgIGNvbnN0IGFkMTg0M19n
YWluX3QgKmdwID0gYWQxODQzX2dhaW5baWRdOworICAgICAgIHVuc2lnbmVkIHNob3J0IG1hc2sg
PSAoMSA8PCBncC0+bGZpZWxkLT5uYml0cykgLSAxOworCisgICAgICAgaW50IGxnID0gbmV3dmFs
ID4+IDAgJiAweEZGOworICAgICAgIGludCByZyA9IG5ld3ZhbCA+PiA4OworICAgICAgIGlmIChs
ZyA8IDAgfHwgbGcgPiAxMDAgfHwgcmcgPCAwIHx8IHJnID4gMTAwKQorICAgICAgICAgICAgICAg
cmV0dXJuIC1FSU5WQUw7CisgICAgICAgbGcgPSAobGcgKiBtYXNrICsgKG1hc2sgPj4gMSkpIC8g
MTAwOworICAgICAgIHJnID0gKHJnICogbWFzayArIChtYXNrID4+IDEpKSAvIDEwMDsKKyAgICAg
ICBpZiAoZ3AtPm5lZ2F0aXZlKSB7CisgICAgICAgICAgICAgICBsZyA9IG1hc2sgLSBsZzsKKyAg
ICAgICAgICAgICAgIHJnID0gbWFzayAtIHJnOworICAgICAgIH0KKyAgICAgICBhZDE4NDNfd3Jp
dGVfbXVsdGkoYWQxODQzLCAyLCBncC0+bGZpZWxkLCBsZywgZ3AtPnJmaWVsZCwgcmcpOworICAg
ICAgIHJldHVybiBhZDE4NDNfZ2V0X2dhaW4oYWQxODQzLCBpZCk7Cit9CisKKy8qIFJldHVybnMg
dGhlIGN1cnJlbnQgcmVjb3JkaW5nIHNvdXJjZSwgaW4gT1NTIGZvcm1hdC4gKi8KKworaW50IGFk
MTg0M19nZXRfcmVjc3JjKGFkMTg0M190ICphZDE4NDMpCit7CisgICAgICAgaW50IGxzID0gYWQx
ODQzX3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfTFNTKTsKKworICAgICAgIHN3aXRjaCAobHMp
IHsKKyAgICAgICBjYXNlIDE6CisgICAgICAgICAgICAgICByZXR1cm4gU09VTkRfTUFTS19NSUM7
CisgICAgICAgY2FzZSAyOgorICAgICAgICAgICAgICAgcmV0dXJuIFNPVU5EX01BU0tfTElORTsK
KyAgICAgICBjYXNlIDM6CisgICAgICAgICAgICAgICByZXR1cm4gU09VTkRfTUFTS19DRDsKKyAg
ICAgICBjYXNlIDY6CisgICAgICAgICAgICAgICByZXR1cm4gU09VTkRfTUFTS19QQ007CisgICAg
ICAgZGVmYXVsdDoKKyAgICAgICAgICAgICAgIHJldHVybiAtMTsKKyAgICAgICB9Cit9CisKKy8q
CisgKiBFbmFibGUvZGlzYWJsZSBkaWdpdGFsIHJlc2FtcGxlIG1vZGUgaW4gdGhlIEFEMTg0My4K
KyAqCisgKiBUaGUgQUQxODQzIHJlcXVpcmVzIHRoYXQgQURMLCBBRFIsIERBMSBhbmQgREEyIGJl
IHBvd2VyZWQgZG93bgorICogd2hpbGUgc3dpdGNoaW5nIG1vZGVzLiAgU28gd2Ugc2F2ZSBEQSdz
IHN0YXRlLCBwb3dlciB0aGVtIGRvd24sCisgKiBzd2l0Y2ggaW50by9vdXQgb2YgcmVzYW1wbGUg
bW9kZSwgcG93ZXIgdGhlbSB1cCwgYW5kIHJlc3RvcmUgc3RhdGUuCisgKgorICogVGhpcyB3aWxs
IGNhdXNlIGF1ZGlibGUgZ2xpdGNoZXMgaWYgRC9BIG9yIEEvRCBpcyBnb2luZyBvbiwgc28gdGhl
CisgKiBkcml2ZXIgZGlzYWxsb3dzIHRoYXQgKGluIG1peGVyX3dyaXRlX2lvY3RsKCkpLgorICoK
KyAqIFRoZSBvcGVuIHF1ZXN0aW9uIGlzLCBpcyB0aGlzIHdvcnRoIGRvaW5nPyAgSSdtIGxlYXZp
bmcgaXQgaW4sCisgKiBiZWNhdXNlIGl0J3Mgd3JpdHRlbiwgYnV0Li4uCisgKi8KKwordm9pZCBh
ZDE4NDNfc2V0X3Jlc2FtcGxlX21vZGUoYWQxODQzX3QgKmFkMTg0MywgaW50IG9ub2ZmKQorewor
ICAgICAgIC8qIFNhdmUgREEncyBtdXRlIGFuZCBnYWluIChhZGRyIDkvMTAgaXMgYW5hbG9nIGdh
aW4vYXR0ZW51YXRpb24pICovCisgICAgICAgaW50IHNhdmVfZGExID0gYWQxODQzLT5yZWFkKGFk
MTg0My0+Y2hpcCwgOSk7CisgICAgICAgaW50IHNhdmVfZGEyID0gYWQxODQzLT5yZWFkKGFkMTg0
My0+Y2hpcCwgMTApOworCisgICAgICAgLyogUG93ZXIgZG93biBBL0QgYW5kIEQvQS4gKi8KKyAg
ICAgICBhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzLCA0LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAmYWQxODQzX0RBMUVOLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQz
X0RBMkVOLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0FETEVOLCAwLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0FEUkVOLCAwKTsKKworICAgICAgIC8q
IFN3aXRjaCBtb2RlICovCisgICAgICAgYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQz
X0RSU0ZMVCwgb25vZmYpOworCisgICAgICAgLyogUG93ZXIgdXAgQS9EIGFuZCBEL0EuICovCisg
ICAgICAgYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgMywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgJmFkMTg0M19EQTFFTiwgMSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0
M19EQTJFTiwgMSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19BRExFTiwgMSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19BRFJFTiwgMSk7CisKKyAgICAgICAv
KiBSZXN0b3JlIERBJ3MgbXV0ZSBhbmQgZ2Fpbi4gKi8KKyAgICAgICBhZDE4NDMtPndyaXRlKGFk
MTg0My0+Y2hpcCwgOSwgc2F2ZV9kYTEpOworICAgICAgIGFkMTg0My0+d3JpdGUoYWQxODQzLT5j
aGlwLCAxMCwgc2F2ZV9kYTIpOworfQorCisvKgorICogU2V0IHJlY29yZGluZyBzb3VyY2UuICBB
cmcgbmV3c3JjIHNwZWNpZmllcyBhbiBPU1MgY2hhbm5lbCBtYXNrLgorICoKKyAqIFRoZSBjb21w
bGljYXRpb24gaXMgdGhhdCB3aGVuIHdlIHN3aXRjaCBpbnRvL291dCBvZiBsb29wYmFjayBtb2Rl
CisgKiAoaS5lLiwgc3JjID0gU09VTkRfTUFTS19QQ00pLCB3ZSBjaGFuZ2UgdGhlIEFEMTg0MyBp
bnRvL291dCBvZgorICogZGlnaXRhbCByZXNhbXBsaW5nIG1vZGUuCisgKgorICogUmV0dXJucyBu
ZXdzcmMgb24gc3VjY2VzcywgLWVycm5vIG9uIGZhaWx1cmUuCisgKi8KKworaW50IGFkMTg0M19z
ZXRfcmVjc3JjKGFkMTg0M190ICphZDE4NDMsIGludCBuZXdzcmMpCit7CisgICAgICAgaW50IGJp
dHM7CisgICAgICAgaW50IG9sZGJpdHM7CisKKyAgICAgICBzd2l0Y2ggKG5ld3NyYykgeworICAg
ICAgIGNhc2UgU09VTkRfTUFTS19QQ006CisgICAgICAgICAgICAgICBiaXRzID0gNjsKKyAgICAg
ICAgICAgICAgIGJyZWFrOworCisgICAgICAgY2FzZSBTT1VORF9NQVNLX01JQzoKKyAgICAgICAg
ICAgICAgIGJpdHMgPSAxOworICAgICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICBjYXNlIFNP
VU5EX01BU0tfTElORToKKyAgICAgICAgICAgICAgIGJpdHMgPSAyOworICAgICAgICAgICAgICAg
YnJlYWs7CisKKyAgICAgICBjYXNlIFNPVU5EX01BU0tfQ0Q6CisgICAgICAgICAgICAgICBiaXRz
ID0gMzsKKyAgICAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgZGVmYXVsdDoKKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOworICAgICAgIH0KKyAgICAgICBvbGRiaXRzID0gYWQxODQz
X3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfTFNTKTsKKyAgICAgICBpZiAobmV3c3JjID09IFNP
VU5EX01BU0tfUENNICYmIG9sZGJpdHMgIT0gNikgeworCisgICAgICAgICAgICAgICBhZDE4NDNf
c2V0X3Jlc2FtcGxlX21vZGUoYWQxODQzLCAxKTsKKyAgICAgICAgICAgICAgIGFkMTg0M193cml0
ZV9tdWx0aShhZDE4NDMsIDIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFk
MTg0M19EQUFETCwgMiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQz
X0RBQURSLCAyKTsKKyAgICAgICB9IGVsc2UgaWYgKG5ld3NyYyAhPSBTT1VORF9NQVNLX1BDTSAm
JiBvbGRiaXRzID09IDYpIHsKKworICAgICAgICAgICAgICAgYWQxODQzX3NldF9yZXNhbXBsZV9t
b2RlKGFkMTg0MywgMCk7CisgICAgICAgICAgICAgICBhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQz
LCAyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZhZDE4NDNfREFBREwsIDAs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19EQUFEUiwgMCk7Cisg
ICAgICAgfQorICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIsICZhZDE4NDNfTFNT
LCBiaXRzLCAmYWQxODQzX1JTUywgYml0cyk7CisgICAgICAgcmV0dXJuIG5ld3NyYzsKK30KKwor
LyoKKyAqIFJldHVybiBjdXJyZW50IG91dHB1dCBzb3VyY2VzLCBpbiBPU1MgZm9ybWF0LgorICov
CisKK2ludCBhZDE4NDNfZ2V0X291dHNyYyhhZDE4NDNfdCAqYWQxODQzKQoreworICAgICAgIGlu
dCBwY20sIGxpbmUsIG1pYywgY2Q7CisKKyAgICAgICBwY20gID0gYWQxODQzX3JlYWRfYml0cyhh
ZDE4NDMsICZhZDE4NDNfTERBMUdNKSA/IDAgOiBTT1VORF9NQVNLX1BDTTsKKyAgICAgICBsaW5l
ID0gYWQxODQzX3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfTFgxTU0pICA/IDAgOiBTT1VORF9N
QVNLX0xJTkU7CisgICAgICAgY2QgICA9IGFkMTg0M19yZWFkX2JpdHMoYWQxODQzLCAmYWQxODQz
X0xYMk1NKSAgPyAwIDogU09VTkRfTUFTS19DRDsKKyAgICAgICBtaWMgID0gYWQxODQzX3JlYWRf
Yml0cyhhZDE4NDMsICZhZDE4NDNfTE1DTU0pICA/IDAgOiBTT1VORF9NQVNLX01JQzsKKworICAg
ICAgIHJldHVybiBwY20gfCBsaW5lIHwgY2QgfCBtaWM7Cit9CisKKy8qCisgKiBTZXQgb3V0cHV0
IHNvdXJjZXMuICBBcmcgaXMgYSBtYXNrIG9mIGFjdGl2ZSBzb3VyY2VzIGluIE9TUyBmb3JtYXQu
CisgKgorICogUmV0dXJucyBzb3VyY2UgbWFzayBvbiBzdWNjZXNzLCAtZXJybm8gb24gZmFpbHVy
ZS4KKyAqLworCitpbnQgYWQxODQzX3NldF9vdXRzcmMoYWQxODQzX3QgKmFkMTg0MywgaW50IG1h
c2spCit7CisgICAgICAgaW50IHBjbSwgbGluZSwgbWljLCBjZDsKKworICAgICAgIGlmIChtYXNr
ICYgfihTT1VORF9NQVNLX1BDTSB8IFNPVU5EX01BU0tfTElORSB8CisgICAgICAgICAgICAgICAg
ICAgIFNPVU5EX01BU0tfQ0QgfCBTT1VORF9NQVNLX01JQykpCisgICAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsKKyAgICAgICBwY20gID0gKG1hc2sgJiBTT1VORF9NQVNLX1BDTSkgID8gMCA6
IDE7CisgICAgICAgbGluZSA9IChtYXNrICYgU09VTkRfTUFTS19MSU5FKSA/IDAgOiAxOworICAg
ICAgIG1pYyAgPSAobWFzayAmIFNPVU5EX01BU0tfTUlDKSAgPyAwIDogMTsKKyAgICAgICBjZCAg
ID0gKG1hc2sgJiBTT1VORF9NQVNLX0NEKSAgID8gMCA6IDE7CisKKyAgICAgICBhZDE4NDNfd3Jp
dGVfbXVsdGkoYWQxODQzLCAyLCAmYWQxODQzX0xEQTFHTSwgcGNtLCAmYWQxODQzX1JEQTFHTSwg
cGNtKTsKKyAgICAgICBhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzLCAyLCAmYWQxODQzX0xYMU1N
LCBsaW5lLCAmYWQxODQzX1JYMU1NLCBsaW5lKTsKKyAgICAgICBhZDE4NDNfd3JpdGVfbXVsdGko
YWQxODQzLCAyLCAmYWQxODQzX0xYMk1NLCBjZCwgICAmYWQxODQzX1JYMk1NLCBjZCk7CisgICAg
ICAgYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgMiwgJmFkMTg0M19MTUNNTSwgbWljLCAgJmFk
MTg0M19STUNNTSwgbWljKTsKKworICAgICAgIHJldHVybiBtYXNrOworfQorCisvKiBTZXR1cCBh
ZDE4NDMgZm9yIEQvQSBjb252ZXJzaW9uLiAqLworCit2b2lkIGFkMTg0M19zZXR1cF9kYWMoYWQx
ODQzX3QgKmFkMTg0MywKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaWQsCisg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZyYW1lcmF0ZSwKKyAgICAgICAgICAg
ICAgICAgICAgICBzbmRfcGNtX2Zvcm1hdF90IGZtdCwKKyAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgY2hhbm5lbHMpCit7CisgICAgICAgaW50IGFkX2ZtdCA9IDEsIGFkX21vZGUg
PSAwOworCisgICAgICAgc3dpdGNoIChmbXQpIHsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JN
QVRfUzg6ICAgICAgIGFkX2ZtdCA9IDA7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZfUENNX0ZP
Uk1BVF9VODogICAgICAgYWRfZm10ID0gMDsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01f
Rk9STUFUX1MxNl9CRTogICBhZF9mbXQgPSAxOyBicmVhazsKKyAgICAgICBjYXNlIFNORFJWX1BD
TV9GT1JNQVRfUzI0X0JFOiAgIGFkX2ZtdCA9IDE7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZf
UENNX0ZPUk1BVF9NVV9MQVc6ICAgYWRfZm10ID0gMjsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRS
Vl9QQ01fRk9STUFUX0FfTEFXOiAgICBhZF9mbXQgPSAzOyBicmVhazsKKyAgICAgICBkZWZhdWx0
OiBwcmludGsoImVycmshXG4iKTsgYnJlYWs7CisgICAgICAgfQorCisgICAgICAgc3dpdGNoIChj
aGFubmVscykgeworICAgICAgIGNhc2UgMjogICAgICAgICAgICAgICAgIGFkX21vZGUgPSAwOyBi
cmVhazsKKyAgICAgICBjYXNlIDE6ICAgICAgICAgICAgICAgICBhZF9tb2RlID0gMTsgYnJlYWs7
CisgICAgICAgZGVmYXVsdDogcHJpbnRrKCJlcnJrIVxuIik7IGJyZWFrOworICAgICAgIH0KKwor
ICAgICAgICBpZigxID09IGlkKSB7CisJCWFkMTg0M193cml0ZV9iaXRzKGFkMTg0MywgJmFkMTg0
M19DMUMsIGZyYW1lcmF0ZSk7CisJCS8vYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQz
X0MxTSwgMHgwMCk7CisJCS8vYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0MxQzEy
OCwgMSk7CisJCS8vYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0ZSUywgMCk7CisJ
CWFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIsCisJCQkmYWQxODQzX0RBMVNNLCBhZF9tb2Rl
LAorCQkJJmFkMTg0M19EQTFGLCBhZF9mbXQpOworCQkvL2FkMTg0M193cml0ZV9iaXRzKGFkMTg0
MywgJmFkMTg0M19EQTFFTiwgMSk7CisKKyAgICAgICAgfSBlbHNlIHsKKwkJYWQxODQzX3dyaXRl
X2JpdHMoYWQxODQzLCAmYWQxODQzX0MzQywgZnJhbWVyYXRlKTsKKwkJYWQxODQzX3dyaXRlX211
bHRpKGFkMTg0MywgMiwKKwkJCSZhZDE4NDNfREEyU00sIGFkX21vZGUsCisJCQkmYWQxODQzX0RB
MkYsIGFkX2ZtdCk7CisJCS8vYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0RBMkVO
LCAxKTsKKyAgICAgICB9CisKKy8qRklYTUUgRGVidWdnaW5nLCB3aWxsIHJlbW92ZSAqLworYWQx
ODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0MxQywgZnJhbWVyYXRlKTsKK2FkMTg0M193
cml0ZV9iaXRzKGFkMTg0MywgJmFkMTg0M19DMkMsIGZyYW1lcmF0ZSk7CithZDE4NDNfd3JpdGVf
Yml0cyhhZDE4NDMsICZhZDE4NDNfQzNDLCBmcmFtZXJhdGUpOworLy9hZDE4NDNfd3JpdGVfYml0
cyhhZDE4NDMsICZhZDE4NDNfQzFNLCAweDAwKTsKKy8vYWQxODQzX3dyaXRlX2JpdHMoYWQxODQz
LCAmYWQxODQzX0MyTSwgMHgwMCk7CisvL2FkMTg0M193cml0ZV9iaXRzKGFkMTg0MywgJmFkMTg0
M19DM00sIDB4MDApOworCit9CisKK3ZvaWQgYWQxODQzX3NodXRkb3duX2RhYyhhZDE4NDNfdCAq
YWQxODQzLCB1bnNpZ25lZCBpbnQgaWQpCit7CisgICAgICAgaWYoaWQpCisgICAgICAgICAgICAg
ICBhZDE4NDNfd3JpdGVfYml0cyhhZDE4NDMsICZhZDE4NDNfREEyRiwgMSk7CisgICAgICAgIGVs
c2UKKyAgICAgICAgICAgICAgIGFkMTg0M193cml0ZV9iaXRzKGFkMTg0MywgJmFkMTg0M19EQTFG
LCAxKTsKK30KKwordm9pZCBhZDE4NDNfc2V0dXBfYWRjKGFkMTg0M190ICphZDE4NDMsCisgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZyYW1lcmF0ZSwKKyAgICAgICAgICAgICAg
ICAgICAgICBzbmRfcGNtX2Zvcm1hdF90IGZtdCwKKyAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgY2hhbm5lbHMpCit7CisgICAgICAgaW50IGRhX2ZtdCA9IDA7CisKKyAgICAgICBz
d2l0Y2ggKGZtdCkgeworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9TODogICAgICAgZGFf
Zm10ID0gMDsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01fRk9STUFUX1U4OiAgICAgICBk
YV9mbXQgPSAwOyBicmVhazsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JNQVRfUzE2X0JFOiAg
IGRhX2ZtdCA9IDE7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9NVV9MQVc6
ICAgZGFfZm10ID0gMjsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01fRk9STUFUX0FfTEFX
OiAgICBkYV9mbXQgPSAzOyBicmVhazsKKyAgICAgICBkZWZhdWx0OiBwcmludGsoImVycmshXG4i
KTsgYnJlYWs7CisgICAgICAgfQorCisgICAgICAgYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAm
YWQxODQzX0MzQywgZnJhbWVyYXRlKTsKKyAgICAgICBhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQz
LCAyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0FETEYsIGRhX2ZtdCwgJmFk
MTg0M19BRFJGLCBkYV9mbXQpOworfQorCit2b2lkIGFkMTg0M19zaHV0ZG93bl9hZGMoYWQxODQz
X3QgKmFkMTg0MykKK3sKKyAgICAgICAvKiBub3RoaW5nIHRvIGRvICovCit9CisKKy8qCisgKiBG
dWxseSBpbml0aWFsaXplIHRoZSBhZDE4NDMuICBBcyBkZXNjcmliZWQgaW4gdGhlIEFEMTg0MyBk
YXRhCisgKiBzaGVldCwgc2VjdGlvbiAiU1RBUlQtVVAgU0VRVUVOQ0UiLiAgVGhlIG51bWJlcmVk
IGNvbW1lbnRzIGFyZQorICogc3Vic2VjdGlvbiBoZWFkaW5ncyBmcm9tIHRoZSBkYXRhIHNoZWV0
LiAgU2VlIHRoZSBkYXRhIHNoZWV0LCBwYWdlcworICogNTItNTQsIGZvciBtb3JlIGluZm8uCisg
KgorICogcmV0dXJuIDAgb24gc3VjY2VzcywgLWVycm5vIG9uIGZhaWx1cmUuICAqLworCitpbnQg
YWQxODQzX2luaXQoYWQxODQzX3QgKmFkMTg0MykKK3sKKyAgICAgICB1bnNpZ25lZCBsb25nIGxh
dGVyOworCisJLyogMS4gUG93ZXIgdXAgaW4gaGFyZHdhcmUgKi8KKworCS8qIDIuIEFzc2VydCBe
UkVTRVReIHRvIDAsIHdhaXQgMTAwbnMKKwkgKiAzLiBEZWFzc2VydCBeUkVTRVReIF80MDAgdG8g
ODAwdXMsIHBvbGwgSU5JVCB0byBzZWUgd2hlbiByZWFkeQorCSAqIERvbmUgaW4gY2FsbGluZyBk
cml2ZXIgKi8KKwl1ZGVsYXkoODAwKTsKKworCS8qIDMuIENoZWNrIHRoYXQgdGhlIGNsb2NrcyBh
cmUgc3RhYmxlICovCisJaWYgKGFkMTg0M19yZWFkX2JpdHMoYWQxODQzLCAmYWQxODQzX0lOSVQp
ICE9IDApIHsKKwkJcHJpbnRrKEtFUk5fRVJSICJhZDE4NDM6IEFEMTg0MyBDbG9ja3Mgbm90IHll
dCBzdGFibGVcbiIpOworCQlyZXR1cm4gLUVJTzsKKwl9CisKKwkvKnNldCBzZXJpYWwgYnVzIHNw
ZWVkICovCisJYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX1NDRiwgMCk7CisKKwkv
KiBQb3dlciBkb3duIGNvbnYgcmVzb3VyY2VzICovCisJLyphZDE4NDNfd3JpdGVfYml0cyhhZDE4
NDMsICZhZDE4NDNfUEROSSwgMSk7CisJdWRlbGF5KDgwMCk7Ki8KKworCS8qIDQuIFB1dCB0aGUg
Y29udmVyc2lvbiByZXNvdXJjZXMgaW50byBzdGFuZGJ5IFBETkkgdG8gMAorCSAqIEZvcmNlIEVu
YWJsZSBhdXRvIGNhbGlicmF0ZSBBQ0VOIHRvIDEgKi8KKwlhZDE4NDNfd3JpdGVfbXVsdGkoYWQx
ODQzLCAyLAorCQkmYWQxODQzX1BETkksIDAsICZhZDE4NDNfQUNFTiwgMSk7CisJbGF0ZXIgPSBq
aWZmaWVzICsgSFogLyAyOyAgLyogcm91Z2hseSBoYWxmIGEgc2Vjb25kICovCisKKwkvKiA1LiBX
aGlsZSBpbiBzdGFuZGJ5CisJICogUG93ZXIgdXAgdGhlIGNsb2NrIGdlbmVyYXRvcnMgYW5kIGVu
YWJsZSBjbG9jayBvdXRwdXQgcGlucy4gKi8KKwlhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzLCAx
MCwgJmFkMTg0M19FTkNMS08sIDEsCisJCSZhZDE4NDNfQzFFTiwgMSwgJmFkMTg0M19FTkNWMSwg
MSwgJmFkMTg0M19FTkJUMSwgMSwKKwkJJmFkMTg0M19DMkVOLCAxLCAmYWQxODQzX0VOQ1YyLCAx
LCAmYWQxODQzX0VOQlQyLCAxLAorCQkmYWQxODQzX0MzRU4sIDEsICZhZDE4NDNfRU5DVjMsIDEs
ICZhZDE4NDNfRU5CVDMsIDEpOworCisJLyogNi4gQ29uZmlndXJlIGNvbnZlcnNpb24gcmVzb3Vy
Y2VzIHdoaWxlIHRoZXkgYXJlIGluIHN0YW5kYnkuICovCisKKworCisJLyogRGlkIHdlIGNvbWUg
b3V0IG9mIHN0YW5kYnkgPyAqLworCXdoaWxlIChhZDE4NDNfcmVhZF9iaXRzKGFkMTg0MywgJmFk
MTg0M19QRE5PKSkgeworCQlpZiAodGltZV9hZnRlcihqaWZmaWVzLCBsYXRlcikpIHsKKwkJCXBy
aW50ayhLRVJOX0VSUiAiYWQxODQzOiBBRDE4NDMgd29uJ3QgcG93ZXIgdXBcbiIpOworICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTzsKKwkJfQorCQlzY2hlZHVsZSgpOworCX0KKwor
CisJLyogREFDMSA9IENsb2NrMSwgQURDID0gQ2xvY2syLCBEQUMyID0gQ2xvY2szICBBbHdheXMu
CisJICogQmFzZWQgYW4gYWQxODQzIHN0YXRlIGZyb20gc3RhcnR1cCBqaW5nbGUgKi8KKwlhZDE4
NDNfd3JpdGVfbXVsdGkoYWQxODQzLCA0LAorCQkmYWQxODQzX0RBMUMsIDEsICZhZDE4NDNfREEy
QywgMywKKwkJJmFkMTg0M19BRExDLCAyLCAmYWQxODQzX0FEUkMsIDIpOworCisJLyogNy4gRW5h
YmxlIGNvbnZlcnNpb24gcmVzb3VyY2VzLiAqLworCWFkMTg0M193cml0ZV9iaXRzKGFkMTg0Mywg
JmFkMTg0M19BRFRMSywgMSk7CisJYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgNiwKKwkJJmFk
MTg0M19BTkFFTiwgMSwgJmFkMTg0M19BQU1FTiwgMSwKKwkJJmFkMTg0M19EQTFFTiwgMSwgJmFk
MTg0M19EQTJFTiwgMSwKKwkJJmFkMTg0M19BRExFTiwgMSwgJmFkMTg0M19BRFJFTiwgMSk7CisK
KyAgICAgICAvKiA4LiBDb25maWd1cmUgY29udmVyc2lvbiByZXNvdXJjZXMgd2hpbGUgdGhleSBh
cmUgZW5hYmxlZC4gKi8KKworCisgICAgICAgLyogVW5tdXRlIGFsbCBjaGFubmVscy4gKi8KKwor
ICAgICAgIGFkMTg0M19zZXRfb3V0c3JjKGFkMTg0MywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAoU09VTkRfTUFTS19QQ00gfCBTT1VORF9NQVNLX0xJTkUgfAorICAgICAgICAgICAgICAgICAg
ICAgICAgICBTT1VORF9NQVNLX01JQyB8IFNPVU5EX01BU0tfQ0QpKTsKKyAgICAgICBhZDE4NDNf
d3JpdGVfbXVsdGkoYWQxODQzLCAyLAorCQkmYWQxODQzX0xEQTFBTSwgMCwgJmFkMTg0M19SREEx
QU0sIDApOworCisJYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgMiwKKwkJJmFkMTg0M19MREEy
QU0sIDAsICZhZDE4NDNfUkRBMkFNLCAwKTsKKworCWFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMs
IDIsCisJCSZhZDE4NDNfTERBMUdNLCAwLCAmYWQxODQzX1JEQTFHTSwgMCk7CisKKyAgICAgICAv
KiBTZXQgZGVmYXVsdCByZWNvcmRpbmcgc291cmNlIHRvIExpbmUgSW4gYW5kIHNldAorICAgICAg
ICAqIG1pYyBnYWluIHRvICsyMCBkQi4KKyAgICAgICAgKi8KKyAgICAgICBhZDE4NDNfc2V0X3Jl
Y3NyYyhhZDE4NDMsIFNPVU5EX01BU0tfTElORSk7CisgICAgICAgYWQxODQzX3dyaXRlX211bHRp
KGFkMTg0MywgMiwgJmFkMTg0M19MTUdFLCAxLCAmYWQxODQzX1JNR0UsIDEpOworCisgICAgICAg
LyogU2V0IFNwZWFrZXIgT3V0IGxldmVsIHRvICsvLSA0ViBhbmQgdW5tdXRlIGl0LiAqLworICAg
ICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDMsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAmYWQxODQzX0hQT1MsIDEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQz
X0hQT00sIDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX01QT00sIDApOwor
CisgICAgICAgcmV0dXJuIDA7Cit9CisKK2NoYXIgKmFkMTg0M19kdW1wX3JlZyhhZDE4NDNfdCAq
YWQxODQzLCBpbnQgcmVnKQoreworCXN0YXRpYyBjb25zdCBjaGFyICpyZWdfZm10WzMyXSA9IHsK
KwkJIlJlZyAgMDogQ29kZWMgU3RhdHVzIGFuZCBSZXZpc2lvbiBJZGVudGlmaWNhdGlvblxuIgor
CQkifElOSVQgICAldSB8UEROTyAgICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSAiCisJCSJ8UkVT
ICAgICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHwgKCV1KVxuIgorCQkifFJF
UyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSAiCisJCSJ8SUQzICAgICV1
IMK3SUQyICAgICV1IMK3SUQxICAgICV1IMK3SUQwICAgICV1IHwgKCV1KVxuIiwKKwkJLypyZWcg
MSovCisJCSJSZWcgIDE6IENoYW5uZWwgU3RhdHVzIEZsYWdzXG4iCisJCSJ8UkVTICAgICV1IHxS
RVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1ICIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAl
dSB8U1UyICAgICV1IHxTVTEgICAgJXUgfCAoJXUpXG4iCisJCSJ8UkVTICAgICV1IHxSRVMgICAg
JXUgfFJFUyAgICAldSB8UkVTICAgICV1ICIKKwkJInxPVlIxICAgJXUgwrdPVlIwICAgJXUgfE9W
TDEgICAldSDCt09WTDAgICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDIqLworCQkiUmVnICAyOiBJ
bnB1dCBDb250cm9sIC0gQURDIFNvdXJjZSBhbmQgR2Fpbi9BdHRlbnVhdGlvblxuIgorCQkifExT
UzIgICAldSDCt0xTUzEgICAldSDCt0xTUzAgICAldSB8TE1HRSAgICV1ICIKKwkJInxMSUczICAg
JXUgwrdMSUcyICAgJXUgwrdMSUcxICAgJXUgwrdMSUcwICAgJXUgfCAoJXUpXG4iCisJCSJ8UlNT
MiAgICV1IMK3UlNTMSAgICV1IMK3UlNTMCAgICV1IHxSTUdFICAgJXUgIgorCQkifFJJRzMgICAl
dSDCt1JJRzIgICAldSDCt1JJRzEgICAldSDCt1JJRzAgICAldSB8ICgldSlcbiIsCisJCS8qcmVn
IDMqLworCQkiUmVnICAzOiBNaXggQ29udHJvbCAtIERBQzIgdG8gTWl4ZXJcbiIKKwkJInxMRDJN
TSAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHxMRDJNNCAgJXUgIgorCQkiwrdMRDJNMyAgJXUg
wrdMRDJNMiAgJXUgwrdMRDJNMSAgJXUgwrdMRDJNMCAgJXUgfCAoJXUpXG4iCisJCSJ8UkQyTU0g
ICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSB8UkQyTTQgICV1ICIKKwkJIsK3UkQyTTMgICV1IMK3
UkQyTTIgICV1IMK3UkQyTTEgICV1IMK3UkQyTTAgICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgNCov
CisJCSJSZWcgIDQ6IEF1eGlsaWFyeSAxIHRvIERBQzFcbiIKKwkJInxMWDFNTSAgJXUgfFJFUyAg
ICAldSB8UkVTICAgICV1IHxMWDFNNCAgJXUgIgorCQkiwrdMWDFNMyAgJXUgwrdMWDFNMiAgJXUg
wrdMWDFNMSAgJXUgwrdMWDFNMCAgJXUgfCAoJXUpXG4iCisJCSJ8UlgxTU0gICV1IHxSRVMgICAg
JXUgfFJFUyAgICAldSB8UlgxTTQgICV1ICIKKwkJIsK3UlgxTTMgICV1IMK3UlgxTTIgICV1IMK3
UlgxTTEgICV1IMK3UlgxTTAgICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgNSAqLworCQkiUmVnICA1
OiBNaXggQ29udHJvbCAtIEF1eGlsaWFyeSAyIHRvIE1peGVyXG4iCisJCSJ8TFgyTU0gICV1IHxS
RVMgICAgJXUgfFJFUyAgICAldSB8TFgyTTQgICV1ICIKKwkJIsK3TFgyTTMgICV1IMK3TFgyTTIg
ICV1IMK3TFgyTTEgICV1IMK3TFgyTTAgICV1IHwgKCV1KVxuIgorCQkifFJYMk1NICAldSB8UkVT
ICAgICV1IHxSRVMgICAgJXUgfFJYMk00ICAldSAiCisJCSLCt1JYMk0zICAldSDCt1JYMk0yICAl
dSDCt1JYMk0xICAldSDCt1JYMk0wICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDYqLworCQkiUmVn
ICA2OiBNaXggQ29udHJvbCAtIEF1eGlsaWFyeSAzIHRvIE1peGVyXG4iCisJCSJ8TFgzTU0gICV1
IHxSRVMgICAgJXUgfFJFUyAgICAldSB8TFgzTTQgICV1ICIKKwkJIsK3TFgzTTMgICV1IMK3TFgz
TTIgICV1IMK3TFgzTTEgICV1IMK3TFgzTTAgICV1IHwgKCV1KVxuIgorCQkifFJYM01NICAldSB8
UkVTICAgICV1IHxSRVMgICAgJXUgfFJYM000ICAldSAiCisJCSLCt1JYM00zICAldSDCt1JYM00y
ICAldSDCt1JYM00xICAldSDCt1JYM00wICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDcqLworCQki
UmVnICA3OiBNaXggQ29udHJvbCAtIE1pYyB0byBNaXhlclxuIgorCQkifExNQ01NICAldSB8UkVT
ICAgICV1IHxSRVMgICAgJXUgfExNQ000ICAldSAiCisJCSLCt0xNQ00zICAldSDCt0xNQ00yICAl
dSDCt0xNQ00xICAldSDCt0xNQ00wICAldSB8ICgldSlcbiIKKwkJInxSTUNNTSAgJXUgfFJFUyAg
ICAldSB8UkVTICAgICV1IHxSTUNNNCAgJXUgIgorCQkiwrdSTUNNMyAgJXUgwrdSTUNNMiAgJXUg
wrdSTUNNMSAgJXUgwrdSTUNNMCAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyA4Ki8KKwkJIlJlZyAg
ODogTWl4L01pc2MgQ29udHJvbCAtIE1vbm8gSW4gdG8gTWl4ZXIgYW5kIE1pc2MgU2V0dGluZ3Nc
biIKKwkJInxNTk1NICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHxNTk00ICAgJXUgIgorCQki
wrdNTk0zICAgJXUgwrdNTk0yICAgJXUgwrdNTk0xICAgJXUgwrdNTk0wICAgJXUgfCAoJXUpXG4i
CisJCSJ8QUxMTU0gICV1IHxNTk9NICAgJXUgfEhQT00gICAldSB8SFBPUyAgICV1ICIKKwkJInxT
VU1NICAgJXUgfFJFUyAgICAldSB8REFDMlQgICV1IHxEQUMxVCAgJXUgfCAoJXUpXG4iLAorCQkv
KnJlZyA5Ki8KKwkJIlJlZyAgOTogT3V0cHV0IENvbnRyb2wgLSBEQUMxIEFuYWxvZyBHYWluL0F0
dGVudWF0aW9uXG4iCisJCSJ8TERBMUdNICV1IHxSRVMgICAgJXUgfExEQTFHNSAldSDCt0xEQTFH
NCAldSAiCisJCSLCt0xEQTFHMyAldSDCt0xEQTFHMiAldSDCt0xEQTFHMSAldSDCt0xEQTFHMCAl
dSB8ICgldSlcbiIKKwkJInxSREExR00gJXUgfFJFUyAgICAldSB8UkRBMUc1ICV1IMK3UkRBMUc0
ICV1ICIKKwkJIsK3UkRBMUczICV1IMK3UkRBMUcyICV1IMK3UkRBMUcxICV1IMK3UkRBMUcwICV1
IHwgKCV1KVxuIiwKKwkJLypyZWcgMTAqLworCQkiUmVnIDEwOiBPdXRwdXQgQ29udHJvbCAtIERB
QzIgQW5hbG9nIEdhaW4vQXR0ZW51YXRpb25cbiIKKwkJInxMREEyR00gJXUgfFJFUyAgICAldSB8
TERBMkc1ICV1IMK3TERBMkc0ICV1ICIKKwkJIsK3TERBMkczICV1IMK3TERBMkcyICV1IMK3TERB
MkcxICV1IMK3TERBMkcwICV1IHwgKCV1KVxuIgorCQkifFJEQTJHTSAldSB8UkVTICAgICV1IHxS
REEyRzUgJXUgwrdSREEyRzQgJXUgIgorCQkiwrdSREEyRzMgJXUgwrdSREEyRzIgJXUgwrdSREEy
RzEgJXUgwrdSREEyRzAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyAxMSovCisJCSJSZWcgMTE6IE91
dHB1dCBDb250cm9sIC0gREFDMSBEaWdpdGFsIEF0dGVudWF0aW9uXG4iCisJCSJ8TERBMUFNICV1
IHxSRVMgICAgJXUgfExEQTFBNSAldSDCt0xEQTFBNCAldSAiCisJCSLCt0xEQTFBMyAldSDCt0xE
QTFBMiAldSDCt0xEQTFBMSAldSDCt0xEQTFBMCAldSB8ICgldSlcbiIKKwkJInxSREExQU0gJXUg
fFJFUyAgICAldSB8UkRBMUE1ICV1IMK3UkRBMUE0ICV1ICIKKwkJIsK3UkRBMUEzICV1IMK3UkRB
MUEyICV1IMK3UkRBMUExICV1IMK3UkRBMUEwICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgMTIqLwor
CQkiUmVnIDEyOiBPdXRwdXQgQ29udHJvbCAtIERBQzIgRGlnaXRhbCBBdHRlbnVhdGlvblxuIgor
CQkifExEQTJBTSAldSB8UkVTICAgICV1IHxMREEyQTUgJXUgwrdMREEyQTQgJXUgIgorCQkiwrdM
REEyQTMgJXUgwrdMREEyQTIgJXUgwrdMREEyQTEgJXUgwrdMREEyQTAgJXUgfCAoJXUpXG4iCisJ
CSJ8UkRBMkFNICV1IHxSRVMgICAgJXUgfFJEQTJBNSAldSDCt1JEQTJBNCAldSAiCisJCSLCt1JE
QTJBMyAldSDCt1JEQTJBMiAldSDCt1JEQTJBMSAldSDCt1JEQTJBMCAldSB8ICgldSlcbiIsCisJ
CS8qcmVnIDEzKi8KKwkJIlJlZyAxMzogRGlnaXRhbCBNaXggQ29udHJvbCAtIEFEQyB0byBEQUMx
XG4iCisJCSJ8TEFEMU1NICV1IHxSRVMgICAgJXUgfExBRDFNNSAldSDCt0xBRDFNNCAldSAiCisJ
CSLCt0xBRDFNMyAldSDCt0xBRDFNMiAldSDCt0xBRDFNMSAldSDCt0xBRDFNMCAldSB8ICgldSlc
biIKKwkJInxSQUQxTU0gJXUgfFJFUyAgICAldSB8UkFEMU01ICV1IMK3UkFEMU00ICV1ICIKKwkJ
IsK3UkFEMU0zICV1IMK3UkFEMU0yICV1IMK3UkFEMU0xICV1IMK3UkFEMU0wICV1IHwgKCV1KVxu
IiwKKwkJLypyZWcgMTQqLworCQkiUmVnIDE0OiBEaWdpdGFsIE1peCBDb250cm9sIC0gQURDIHRv
IERBQzJcbiIKKwkJInxMQUQyTU0gJXUgfFJFUyAgICAldSB8TEFEMk01ICV1IMK3TEFEMk00ICV1
ICIKKwkJIsK3TEFEMk0zICV1IMK3TEFEMk0yICV1IMK3TEFEMk0xICV1IMK3TEFEMk0wICV1IHwg
KCV1KVxuIgorCQkifFJBRDJNTSAldSB8UkVTICAgICV1IHxSQUQyTTUgJXUgwrdSQUQyTTQgJXUg
IgorCQkiwrdSQUQyTTMgJXUgwrdSQUQyTTIgJXUgwrdSQUQyTTEgJXUgwrdSQUQyTTAgJXUgfCAo
JXUpXG4iLAorCQkvKnJlZyAxNSovCisJCSJSZWcgMTU6IENvZGVjIENvbmZpZ3VyYXRpb24gLSBD
aGFubmVsIFNhbXBsZSBSYXRlIFNvdXJjZSBTZWxlY3RcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAg
ICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifERBMkMxICAldSDCt0RBMkMwICAldSB8
REExQzEgICV1IMK3REExQzAgICV1IHwgKCV1KVxuIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1
IHxSRVMgICAgJXUgfFJFUyAgICAldSAiCisJCSJ8QURSQzEgICV1IMK3QURSQzAgICV1IHxBRExD
MSAgJXUgwrdBRExDMCAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyAxNiovCisJCSJSZWcgMTY6IENs
b2NrIEdlbmVyYXRvciAxIENvbnRyb2wgLSBNb2RlXG4iCisJCSJ8QzFSRUYgICV1IHxDMVZJRCAg
JXUgfEMxUExMRyAldSB8QzFQMjAwICV1ICIKKwkJInxDMVg4LzcgJXUgfEMxQzEyOCAldSB8UkVT
ICAgICV1IHxSRVMgICAgJXUgfCAoJXUpXG4iCisJCSJ8QzFNNyAgICV1IMK3QzFNNiAgICV1IMK3
QzFNNSAgICV1IMK3QzFNNCAgICV1ICIKKwkJIsK3QzFNMyAgICV1IMK3QzFNMiAgICV1IMK3QzFN
MSAgICV1IMK3QzFNMCAgICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgMTcqLworCQkiUmVnIDE3OiBD
bG9jayBHZW5lcmF0b3IgMSBDb250cm9sIC0gU2FtcGxlIFJhdGVcbiIKKwkJInxDMUMxNSAgJXUg
wrdDMUMxNCAgJXUgwrdDMUMxMyAgJXUgwrdDMkMxMiAgJXUgIgorCQkiwrdDMUMxMSAgJXUgwrdD
MUMxMCAgJXUgwrdDMUM5ICAgJXUgwrdDMUM4ICAgJXUgwrcgKCV1KVxuIgorCQkiwrdDMUM3ICAg
JXUgwrdDMUM2ICAgJXUgwrdDMUM1ICAgJXUgwrdDMUM0ICAgJXUgIgorCQkiwrdDMUMzICAgJXUg
wrdDMUMyICAgJXUgwrdDMUMxICAgJXUgwrdDMUMwICAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyAx
OCovCisJCSJSZWcgMTg6IENsb2NrIEdlbmVyYXRvciAxIENvbnRyb2wgLSBTYW1wbGUgUGhhc2Ug
U2hpZnRcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUg
IgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfEMxUEQgICAldSB8ICgldSlc
biIKKwkJInxDMVA3ICAgJXUgwrdDMVA2ICAgJXUgwrdDMVA1ICAgJXUgwrdDMVA0ICAgJXUgIgor
CQkiwrdDMVAzICAgJXUgwrdDMVAyICAgJXUgwrdDMVAxICAgJXUgwrdDMVAwICAgJXUgfCAoJXUp
XG4iLAorCQkvKnJlZyAxOSovCisJCSJSZWcgMTk6IENsb2NrIEdlbmVyYXRvciAyIENvbnRyb2wg
LSBNb2RlXG4iCisJCSJ8QzJSRUYgICV1IHxDMlZJRCAgJXUgfEMyUExMRyAldSB8QzJQMjAwICV1
ICIKKwkJInxDMlg4LzcgJXUgfEMyQzEyOCAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfCAoJXUp
XG4iCisJCSJ8QzJNNyAgICV1IMK3QzJNNiAgICV1IMK3QzJNNSAgICV1IMK3QzJNNCAgICV1ICIK
KwkJIsK3QzJNMyAgICV1IMK3QzJNMiAgICV1IMK3QzJNMSAgICV1IMK3QzJNMCAgICV1IHwgKCV1
KVxuIiwKKwkJLypyZWcgMjAqLworCQkiUmVnIDIwOiBDbG9jayBHZW5lcmF0b3IgMiBDb250cm9s
IC0gU2FtcGxlIFJhdGVcbiIKKwkJInxDMkMxNSAgJXUgwrdDMkMxNCAgJXUgwrdDMkMxMyAgJXUg
wrdDMkMxMiAgJXUgIgorCQkiwrdDMkMxMSAgJXUgwrdDMkMxMCAgJXUgwrdDMkM5ICAgJXUgwrdD
MkM4ICAgJXUgwrcgKCV1KVxuIgorCQkiwrdDMkM3ICAgJXUgwrdDMkM2ICAgJXUgwrdDMkM1ICAg
JXUgwrdDMkM0ICAgJXUgIgorCQkiwrdDMkMzICAgJXUgwrdDMkMyICAgJXUgwrdDMkMxICAgJXUg
wrdDMkMwICAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyAyMSovCisJCSJSZWcgMjE6IENsb2NrIEdl
bmVyYXRvciAyIENvbnRyb2wgLSBTYW1wbGUgUGhhc2UgU2hpZnRcbiIKKwkJInxSRVMgICAgJXUg
fFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAg
ICV1IHxSRVMgICAgJXUgfEMyUEQgICAldSB8ICgldSlcbiIKKwkJInxDMlA3ICAgJXUgwrdDMlA2
ICAgJXUgwrdDMlA1ICAgJXUgwrdDMlA0ICAgJXUgIgorCQkiwrdDMlAzICAgJXUgwrdDMlAyICAg
JXUgwrdDMlAxICAgJXUgwrdDMlAwICAgJXUgfCAoJXUpXG4iLAorCQkvKnJlZyAyMiovCisJCSJS
ZWcgMjI6IENsb2NrIEdlbmVyYXRvciAzIENvbnRyb2wgLSBNb2RlXG4iCisJCSJ8QzNSRUYgICV1
IHxDM1ZJRCAgJXUgfEMzUExMRyAldSB8QzNQMjAwICV1ICIKKwkJInxDM1g4LzcgJXUgfEMzQzEy
OCAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfCAoJXUpXG4iCisJCSJ8QzNNNyAgICV1IMK3QzNN
NiAgICV1IMK3QzNNNSAgICV1IMK3QzNNNCAgICV1ICIKKwkJIsK3QzNNMyAgICV1IMK3QzNNMiAg
ICV1IMK3QzNNMSAgICV1IMK3QzNNMCAgICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgMjMqLworCQki
UmVnIDIzOiBDbG9jayBHZW5lcmF0b3IgMyBDb250cm9sIC0gU2FtcGxlIFJhdGVcbiIKKwkJInxD
M0MxNSAgJXUgwrdDM0MxNCAgJXUgwrdDM0MxMyAgJXUgwrdDM0MxMiAgJXUgIgorCQkiwrdDM0Mx
MSAgJXUgwrdDM0MxMCAgJXUgwrdDM0M5ICAgJXUgwrdDM0M4ICAgJXUgwrcgKCV1KVxuIgorCQki
wrdDM0M3ICAgJXUgwrdDM0M2ICAgJXUgwrdDM0M1ICAgJXUgwrdDM0M0ICAgJXUgIgorCQkiwrdD
M0MzICAgJXUgwrdDM0MyICAgJXUgwrdDM0MxICAgJXUgwrdDM0MwICAgJXUgfCAoJXUpXG4iLAor
CQkvKnJlZyAyNCovCisJCSJSZWcgMjQ6IENsb2NrIEdlbmVyYXRvciAzIENvbnRyb2wgLSBTYW1w
bGUgUGhhc2UgU2hpZnRcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHxS
RVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfEMzUEQgICAl
dSB8ICgldSlcbiIKKwkJInxDM1A3ICAgJXUgwrdDM1A2ICAgJXUgwrdDM1A1ICAgJXUgwrdDM1A0
ICAgJXUgIgorCQkiwrdDM1AzICAgJXUgwrdDM1AyICAgJXUgwrdDM1AxICAgJXUgwrdDM1AwICAg
JXUgfCAoJXUpXG4iLAorCQkvKnJlZyAyNSovCisJCSJSZWcgMjU6IENvZGVjIENvbmZpZ3VyYXRp
b24gLSBEaWdpdGFsIEZpbHRlciBhbmQgTW9kZSBTZWxlY3RcbiIKKwkJInxEUlNGTFQgJXUgfERB
TUlYICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1
IHxEQTJGTFQgJXUgfERBMUZMVCAldSB8ICgldSlcbiIKKwkJInxEQUFEUjEgJXUgwrdEQUFEUjAg
JXUgfERBQURMMSAldSDCt0RBQURMMCAldSAiCisJCSJ8UkVTICAgICV1IHxSRVMgICAgJXUgfEFE
UkZMVCAldSB8QURMRkxUICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgMjYqLworCQkiUmVnIDI2OiBD
b2RlYyBDb25maWd1cmF0aW9uIC0gU2VyaWFsIEludGVyZmFjZVxuIgorCQkifERBMlNNICAldSB8
REExU00gICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSAiCisJCSJ8REEyRjEgICV1IMK3REEyRjAg
ICV1IHxEQTFGMSAgJXUgwrdEQTFGMCAgJXUgfCAoJXUpXG4iCisJCSJ8U0NGICAgICV1IHxGUlMg
ICAgJXUgfEZSU1QgICAldSB8QURUTEsgICV1ICIKKwkJInxBRFJGMSAgJXUgwrdBRFJGMCAgJXUg
fEFETEYxICAldSDCt0FETEYwICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDI3Ki8KKwkJIlJlZyAy
NzogQ29kZWMgQ29uZmlndXJhdGlvbiAtIENoYW5uZWwgUG93ZXIgRG93blxuIgorCQkifERGUkVF
ICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfERETUVNICAldSAiCisJCSJ8UkVTICAgICV1IHxS
RVMgICAgJXUgfERBMkVOICAldSB8REExRU4gICV1IHwgKCV1KVxuIgorCQkifEFOQUVOICAldSB8
SFBFTiAgICV1IHxSRVMgICAgJXUgfEFBTUVOICAldSAiCisJCSJ8UkVTICAgICV1IHxSRVMgICAg
JXUgfEFEUkVOICAldSB8QURMRU4gICV1IHwgKCV1KVxuIiwKKwkJLypyZWcgMjgqLworCQkiUmVn
IDI4OiBDb2RlYyBDb25maWd1cmF0aW9uIC0gRnVuZGVtZW50YWwgU2V0dGluZ3NcbiIKKwkJInxQ
RE5JICAgJXUgfEFDRU4gICAldSB8QzNFTiAgICV1IHxDMkVOICAgJXUgIgorCQkifEMxRU4gICAl
dSB8RU5DTEtPICV1IHxYQ1RMMSAgJXUgfFhDVEwwICAldSB8ICgldSlcbiIKKwkJInxFTkNWMyAg
JXUgfEVOQlQzICAldSB8RU5DVjIgICV1IHxFTkJUMiAgJXUgIgorCQkifEVOQ1YxICAldSB8RU5C
VDEgICV1IHxMSU5SU0QgJXUgfExJTkxTRCAldSB8ICgldSlcbiIsCisJCS8qcmVnIDI5Ki8KKwkJ
IlJlZyAyOTogUmVzZXJ2ZWQgZm9yIEZ1dHVyZSBFeHBhbnNpb25cbiIKKwkJInxSRVMgICAgJXUg
fFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAg
ICV1IHxSRVMgICAgJXUgfFJFUyAgICAldSB8ICgldSlcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAg
ICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxS
RVMgICAgJXUgfFJFUyAgICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDMwKi8KKwkJIlJlZyAzMDog
UmVzZXJ2ZWQgZm9yIEZ1dHVyZSBFeHBhbnNpb25cbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAl
dSB8UkVTICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMg
ICAgJXUgfFJFUyAgICAldSB8ICgldSlcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVT
ICAgICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUg
fFJFUyAgICAldSB8ICgldSlcbiIsCisJCS8qcmVnIDMxKi8KKwkJIlJlZyAzMTogUmVzZXJ2ZWQg
Zm9yIEZ1dHVyZSBFeHBhbnNpb25cbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAg
ICV1IHxSRVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfFJF
UyAgICAldSB8ICgldSlcbiIKKwkJInxSRVMgICAgJXUgfFJFUyAgICAldSB8UkVTICAgICV1IHxS
RVMgICAgJXUgIgorCQkifFJFUyAgICAldSB8UkVTICAgICV1IHxSRVMgICAgJXUgfFJFUyAgICAl
dSB8ICgldSlcbiIsCisJCX07CisJdW5zaWduZWQgaW50IHYxID0gMCwgdjIgPSAwOworCWludCB3
ID0gYWQxODQzLT5yZWFkKGFkMTg0My0+Y2hpcCwgcmVnKTsKKwljaGFyICpzdHIgPSB2bWFsbG9j
X3VzZXIoMjU1KTsKKworCWlmIChOVUxMPT1zdHIpIHJldHVybiBOVUxMOworCisJc3dpdGNoIChy
ZWcpIHsKKwljYXNlIDA6CisJCXYyID0gdyYweEY7CisJCWJyZWFrOworCWNhc2UgMjoKKwkJdjEg
PSAodz4+OCkmMHhGOyB2MiA9IHcmMHhGOworCQlicmVhazsKKwljYXNlIDM6IGNhc2UgNDogY2Fz
ZSA1OiBjYXNlIDY6IGNhc2UgNzoKKwkJdjEgPSAodz4+OCkmMHgxRjsgdjIgPSB3JjB4MUY7CisJ
CWJyZWFrOworCWNhc2UgODoKKwkJdjEgPSAodz4+OCkmMHgxRjsKKwkJYnJlYWs7CisJY2FzZSA5
OiBjYXNlIDEwOiBjYXNlIDExOiBjYXNlIDEyOiBjYXNlIDEzOiBjYXNlIDE0OgorCQl2MSA9ICh3
Pj44KSYweDNGOyB2MiA9IHcmMHgzRjsKKwkJYnJlYWs7CisJY2FzZSAxNjogY2FzZSAxODogY2Fz
ZSAxOTogY2FzZSAyMTogY2FzZSAyMjogY2FzZSAyNDoKKwkJdjIgPSB3JjB4RkY7CisJCWJyZWFr
OworCWNhc2UgMTc6IGNhc2UgMjA6IGNhc2UgMjM6CisJCXYyID0gdyYweEZGRkY7CisJCWJyZWFr
OworCisJfQorCisJc25wcmludGYoc3RyLCAyNTUsIHJlZ19mbXRbcmVnXSwgKHc+PjE1KSYxLAor
CQkodz4+MTQpJjEsICh3Pj4xMykmMSwgKHc+PjEyKSYxLCAodz4+MTEpJjEsICh3Pj4xMCkmMSwK
KwkJKHc+PjkpJjEsICAodz4+OCkmMSwgdjEsICh3Pj43KSYxLCAgKHc+PjYpJjEsICAodz4+NSkm
MSwKKwkJKHc+PjQpJjEsICAodz4+MykmMSwgICh3Pj4yKSYxLCAgKHc+PjEpJjEsICAodz4+MCkm
MSwgdjIpOworCisJcmV0dXJuIHN0cjsKK30KCi0tLSBsaW51eC0yLjYuMTkuNy1vcmlnaW5hbC9z
b3VuZC9taXBzL21hY2VfYXVkaW8uYwkxOTcwLTAxLTAxIDAxOjAwOjAwLjAwMDAwMDAwMCArMDEw
MAorKysgbGludXgtMi42LjE5Ljcvc291bmQvbWlwcy9tYWNlX2F1ZGlvLmMJMjAwNy0wNy0wMiAx
MTo0MDozMi4wMDAwMDAwMDAgKzAxMDAKQEAgLTAsMCArMSwxMzQxIEBACisvKgorICogICBTb3Vu
ZCBkcml2ZXIgZm9yIFNpbGljb24gR3JhcGhpY3MgTzIgV29ya3N0YXRpb25zIE1BQ0UgYXVkaW8g
Ym9hcmQuCisgKgorICogICBDb3B5cmlnaHQgMjAwNyBUaG9yYmVuIErDpG5kbGluZyA8dGoudHJl
dmVseWFuQGdtYWlsLmNvbT4KKyAqICAgQmFzZWQvQ29waWVkIGhlYXZpbHkgb24vZnJvbSBzZ2lv
MmF1ZGlvLmM6CisgKiAgIENvcHlyaWdodCAyMDAzIFZpdmllbiBDaGFwcGVsaWVyIDx2aXZpZW4u
Y2hhcHBlbGllckBsaW51eC1taXBzLm9yZz4KKyAqCisgKiAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5CisgKiAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uCisgKgorICogICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhv
cGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqICAgTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogICBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICAgWW91
IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UKKyAqICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhl
IEZyZWUgU29mdHdhcmUKKyAqICAgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlLCBT
dWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcgVVNBCisgKgorICovCisKKy8qCisgKiBO
b3RlcworICoKKyAqIE1hY2UgdGFrZSAyNGJpdCBhdWRpbyBzdG9yZWQvdHJhbnNmZXJlZCBpbiAz
MiBiaXRzIGFuZCBjb252ZXJ0cworICogaXQgaW4gaGFyZHdhcmUgYmFjayB0byAxNi84Yml0Cisg
KgorICogQUQxODQzIHNwZWMgc2F5czoKKyAqICJEYXRhIGluIGFsbCBmb3VyIGZvcm1hdHMgaXMg
YWx3YXlzIHRyYW5zZmVyZWQgTVNCIGZpcnN0IgorICogVG8gbWUgdGhhdCBzYXlzIGJpZy1lbmRp
YW4KKyAqIFNvIHRlbGwgQUxTQSB3ZSBvbmx5IGRvIFNORFJWX1BDTV9GTVRCSVRfUzI0X0JFCisg
KgorICogQXBwYXJlbnRseSBSQUQxIHNpbWlsYXIgc2VlIElQMzAgcGF0Y2ggc2V0CisgKgorICog
V2h5IHJld3JpdGU/IE1vc3RseSBzbyB0aGF0IEkgY2FuIHVuZGVyc3RhbmQgdGhlIGNvZGUsIHdy
aXRpbmcgaXMKKyAqIGJldHRlciB0aGVuIHJlYWRpbmcgZm9yIHRoYXQgcHVycG9zZSBJIGZpbmQu
CisgKi8KKy8qIGNoYW5uZWwgMC9BREMsIDEvREFDMSAtPiBwY20wCisgKiBjaGFubmVsIDIvREFD
MiAtPiBwY20xCisgKi8KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKiBpbmNsdWRlICoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKworI2luY2x1ZGUgPHNvdW5kL2RyaXZlci5o
PgorI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4KKyNpbmNsdWRlIDxsaW51eC93YWl0Lmg+CisjaW5j
bHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgorI2luY2x1
ZGUgPGxpbnV4L2dmcC5oPgorI2luY2x1ZGUgPGxpbnV4L3ZtYWxsb2MuaD4KKyNpbmNsdWRlIDxs
aW51eC9pbnRlcnJ1cHQuaD4KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4KKyNpbmNsdWRlIDxsaW51
eC9saXN0Lmg+CisjaW5jbHVkZSA8bGludXgvZG1hLW1hcHBpbmcuaD4KKyNpbmNsdWRlIDxhc20v
aW8uaD4KKworI2luY2x1ZGUgPGFzbS9pcDMyL2lwMzJfaW50cy5oPgorI2luY2x1ZGUgPGFzbS9p
cDMyL21hY2UuaD4KKworI2luY2x1ZGUgPHNvdW5kL2NvcmUuaD4KKyNpbmNsdWRlIDxzb3VuZC9p
bml0dmFsLmg+CisjaW5jbHVkZSA8c291bmQvY29udHJvbC5oPgorI2luY2x1ZGUgPHNvdW5kL3Bj
bS5oPgorI2luY2x1ZGUgPHNvdW5kL2luaXR2YWwuaD4KKyNpbmNsdWRlIDxzb3VuZC9pbmZvLmg+
CisKKyNpbmNsdWRlIDxzb3VuZC9hZDE4NDMuaD4KKworLyoqKioqKioqKioqKioqKioqKioqKioq
KioqKiogZGVmaW5lcyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisvKiAxOiBy
ZXNldCBhdWRpbyBpbnRlcmZhY2UgKi8KKyNkZWZpbmUgU01BX0NUUkxfUkVTRVQgICAgICAgICAg
MHgxVUwKKy8qIDE6IGNvZGVjIGRldGVjdGVkICovCisjZGVmaW5lIFNNQV9DVFJMX0NPREVDX1BS
RVNFTlQgIDB4MlVMCisvKiAgMi04ICA6IGNoYW5uZWwgMSB3cml0ZSBwdHIgYWxpYXMgKi8KKy8q
ICA5LTE1IDogY2hhbm5lbCAyIHJlYWQgcHRyIGFsaWFzICovCisvKiAxNi0yMiA6IGNoYW5uZWwg
MyByZWFkIHB0ciBhbGlhcyAqLworLyogbGF0Y2hlZCB2b2x1bWUgYnV0dG9uICovCisjZGVmaW5l
IFNNQV9DVFJMX1ZPTF9CVVRUT05fVVAgICBCSVQoMjQpCisvKiBsYXRjaGVkIHZvbHVtZSBidXR0
b24gKi8KKyNkZWZpbmUgU01BX0NUUkxfVk9MX0JVVFRPTl9ET1dOIEJJVCgyMykKKworI2RlZmlu
ZSBTTUFfQ09ERUNfUkVBRChyZWcpICAoKHJlZykgPDwxNykgfCAweDAwMDEwMDAwVUwKKyNkZWZp
bmUgU01BX0NPREVDX1dSSVRFKHJlZywgdmFsKSAoKChyZWcpIDw8MTcpfCh2YWwpKSAmIDB4MDBG
RUZGRkZVTAorCisjZGVmaW5lIFNNQV9SSU5HX09GRlNFVChjaGkpICgoY2hpKSA8PCAxMikKKyNk
ZWZpbmUgU01BX1JJTkdfU0laRSAweDEwMDAKKyNkZWZpbmUgU01BX1JJTkdfTUFTSyAweDBGRkZV
TAorCisvKiBpbnQgb24gYnVmZmVyID41MCUgZnVsbCAqLworI2RlZmluZSBTTUFfSU5UX1RIUkVT
SE9MRF81MCAoMiA8PCA1KQorLyogMTogZW5hYmxlIERNQSB0cmFuc2ZlciAqLworI2RlZmluZSBT
TUFfRE1BX0VOQUJMRSAgIEJJVCg5KQorCisvKm9sZCwgZGVmaW5lIHN0aWxsIGluaGVydGVkIGZy
b20gc2dpbzJhdWRpbyovCisKKyNkZWZpbmUgU01BX0NUUkxfQ0hBTl9SRVNFVCBCSVQoMTApIC8q
IDE6IHJlc2V0IGNoYW5uZWwgKi8KKworI2RlZmluZSBTTUFfSU5UX1RIUkVTSE9MRF9ESVNBQkxF
RCAgKDAgPDwgNSkgLyogaW50ZXJydXB0IGRpc2FibGVkICovCisjZGVmaW5lIFNNQV9JTlRfVEhS
RVNIT0xEXzI1ICgxIDw8IDUpIC8qIGludCBvbiBidWZmZXIgPjI1JSBmdWxsICovCisjZGVmaW5l
IFNNQV9JTlRfVEhSRVNIT0xEXzc1ICgzIDw8IDUpIC8qIGludCBvbiBidWZmZXIgPjc1JSBmdWxs
ICovCisjZGVmaW5lIFNNQV9JTlRfVEhSRVNIT0xEX0VNUFRZICAgICAoNCA8PCA1KSAvKiBpbnQg
b24gYnVmZmVyIGVtcHR5ICovCisjZGVmaW5lIFNNQV9JTlRfVEhSRVNIT0xEX05PVF9FTVBUWSAo
NSA8PCA1KSAvKiBpbnQgb24gYnVmZmVyICFlbXB0eSAqLworI2RlZmluZSBTTUFfSU5UX1RIUkVT
SE9MRF9GVUxMICAgICAgKDYgPDwgNSkgLyogaW50IG9uIGJ1ZmZlciBlbXB0eSAqLworI2RlZmlu
ZSBTTUFfSU5UX1RIUkVTSE9MRF9OT1RfRlVMTCAgKDcgPDwgNSkgLyogaW50IG9uIGJ1ZmZlciAh
ZW1wdHkgKi8KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBzdHJ1Y3RzL3R5cGVz
ICoqKioqKioqKioqKioqKioqKioqKioqLworCisvKiBjaGlwIHNwZWNpZmljIHJlY29yZCAqLwor
dHlwZWRlZiBzdHJ1Y3Qgc25kX21hY2VfYXVkaW8geworCXNuZF9jYXJkX3QgKmNhcmQ7CisJc25k
X3BjbV90ICAqcGNtWzJdOworCisJc3RydWN0IHsKKwkJc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vi
c3RyZWFtOworCQlzbmRfcGNtX3VmcmFtZXNfdCAgICAgICAgZnJhbWVzOworCisJCWludCAgICAg
ICAgICAgICAgICAgIGFjazsKKwkJdm9pZCAgICAgICAgICAgICAgICAqYnVmZmVyOworCQl1NjQg
ICAgICAgICAgICAgICAgICBwb3M7CisJCXNwaW5sb2NrX3QgICAgICAgICAgIGxvY2s7CisJfSBj
aGFubmVsWzNdOworCisJLyogd2hpY2ggZ2FpbiBzaG91bGQgdGhlIE8yIHZvbCBidXRvbnMgY29u
dHJvbD8qLworCXVuc2lnbmVkIGludCBleHRfdm9sX2ZvcjsKKworCXNuZF9pbmZvX2VudHJ5X3Qg
ICpwcm9jX2RlYnVnLAorCSAgICAgICAgICAgICAgICAgICpwcm9jX2FkMTg0MywKKwkgICAgICAg
ICAgICAgICAgICAqcHJvY19tYWNlOworCisJYWQxODQzX3QgICAqYWQxODQzOworCXNwaW5sb2Nr
X3QgYWQxODQzX2xvY2s7CisKKwl2b2lkICAgICAgICAqcmluZ19iYXNlOworCWRtYV9hZGRyX3Qg
ICByaW5nX2Jhc2VfaGFuZGxlOworCXVuc2lnbmVkIGxvbmcgbWFjZWlzYV9iYXNlOworCXVuc2ln
bmVkIGludCBtYWNlX29mZnNldDsKKworfSBzbmRfbWFjZV9hdWRpb190OworCit0eXBlZGVmIHN0
cnVjdCBzbWFfcHJvY19kZWJ1ZyB7CisJc3RydWN0IGxpc3RfaGVhZCBsaW5rOworCisvKiBuYW1l
IHRvIGRpc3BsYXkgZm9yIHRoZSBlbnRyeSAqLworCWNoYXIgICpuYW1lOworCisvKiBhIHN0cmlu
ZyB2YWx1ZSAqLworCWNoYXIgICp2YWxfc3RyOworCisvKiBhbiBpbnQgdmFsIHVzZWQgaWYgdmFs
X3N0ciBpcyBudWxsICovCisJbG9uZyB2YWxfaW50OworfSBzbWFfcHJvY19kZWJ1Z190OworCisv
KioqKioqKioqKioqKioqKioqKioqKioqKiogZnVuYyBkZWNsYXJhdGlvbiAqKioqKioqKioqKioq
KioqKioqKioqKioqKioqLworLyogbWFjZSBhY2Nlc3MgKi8KK3N0YXRpYyBpbnQgbWFjZV9hdWRp
b19yZWdfcmVhZChzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQgcmVnKTsKK3N0YXRpYyBpbnQg
bWFjZV9hdWRpb19yZWdfd3JpdGUoc25kX21hY2VfYXVkaW9fdCAqY2hpcCwgaW50IHJlZywgaW50
IHdvcmQpOworLyogcGNtICovCitzdGF0aWMgaW50IHNtYV9wY21fb3BlbihzbmRfcGNtX3N1YnN0
cmVhbV90ICpzdWJzdHJlYW0pOworc3RhdGljIGludCBzbWFfcGNtX2Nsb3NlKHNuZF9wY21fc3Vi
c3RyZWFtX3QgKnN1YnN0cmVhbSk7CitzdGF0aWMgaW50IHNtYV9wY21faHdwYXJhbQorCShzbmRf
cGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0sIHNuZF9wY21faHdfcGFyYW1zX3QgKmh3X3BhcmFt
cyk7CitzdGF0aWMgaW50IHNtYV9wY21faHdmcmVlKHNuZF9wY21fc3Vic3RyZWFtX3QgKnN1YnN0
cmVhbSk7CitzdGF0aWMgaW50IHNtYV9wY21fcHJlcGFyZShzbmRfcGNtX3N1YnN0cmVhbV90ICpz
dWJzdHJlYW0pOworc3RhdGljIGludCBzbWFfcGNtX3RyaWdnZXIoc25kX3BjbV9zdWJzdHJlYW1f
dCAqc3Vic3RyZWFtLCBpbnQgY21kKTsKK3N0YXRpYyBzbmRfcGNtX3VmcmFtZXNfdCBzbWFfcGNt
X3BvaW50ZXIKKwkoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0YXRpYyBzdHJ1
Y3QgcGFnZSAqc21hX3BjbV9wYWdlCisJKHNuZF9wY21fc3Vic3RyZWFtX3QgKnN1YnN0cmVhbSwg
dW5zaWduZWQgbG9uZyBvZmZzZXQpOworc3RhdGljIGludCBzbWFfcGNtX2FjayhzbmRfcGNtX3N1
YnN0cmVhbV90ICpzdWJzdHJlYW0pOworc3RhdGljIGludCBfX2RldmluaXQgc21hX3BjbV9uZXco
c25kX21hY2VfYXVkaW9fdCAqY2hpcCk7CisvKiBpbnRlcnJ1cHQgYW5kIERNQSBlbmdpbmUgKi8K
K3N0YXRpYyBpbnQgc21hX2RtYV9zdGFydChzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0p
Oworc3RhdGljIGludCBzbWFfZG1hX3N0b3Aoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFt
KTsKK3N0YXRpYyB2b2lkIHNtYV9kbWFfcGluZyhzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQg
Y2hpKTsKK3N0YXRpYyB2b2lkIHNtYV9kbWFfcmVmaWxsKHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAs
IGludCBjaGkpOworc3RhdGljIGlycXJldHVybl90IHNtYV9pbnRlcnJ1cHQKKwkoaW50IGlycSwg
c25kX21hY2VfYXVkaW9fdCAqY2hpcCwgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOworc3RhdGljIHZv
aWQgc21hX2FkanVzdF92b2woc25kX21hY2VfYXVkaW9fdCAqY2hpcCk7CisvKiBtaXhlciBhbmQg
Y29udHJvbHMgKi8KK3N0YXRpYyBpbnQgc21hX2dhaW5faW5mbworCShzbmRfa2NvbnRyb2xfdCAq
a2NvbnRyb2wsIHNuZF9jdGxfZWxlbV9pbmZvX3QgKnVpbmZvKTsKK3N0YXRpYyBpbnQgc21hX2dh
aW5fZ2V0CisJKHNuZF9rY29udHJvbF90ICprY29udHJvbCwgc25kX2N0bF9lbGVtX3ZhbHVlX3Qg
KnVjb250cm9sKTsKK3N0YXRpYyBpbnQgc21hX2dhaW5fcHV0CisJKHNuZF9rY29udHJvbF90ICpr
Y29udHJvbCwgc25kX2N0bF9lbGVtX3ZhbHVlX3QgKnVjb250cm9sKTsKK3N0YXRpYyBpbnQgX19k
ZXZpbml0IHNtYV9jb250cm9sX25ldyhzbmRfbWFjZV9hdWRpb190ICpjaGlwKTsKKy8qIHByb2Mg
Ki8KK3N0YXRpYyB2b2lkIHNtYV9wcm9jX2FkMTg0M19yZWFkCisJKHNuZF9pbmZvX2VudHJ5X3Qg
KnByb2NfZW50cnksIHNuZF9pbmZvX2J1ZmZlcl90ICpidWZmZXIpOworc3RhdGljIHZvaWQgc21h
X3Byb2NfbWFjZV9yZWFkCisJKHNuZF9pbmZvX2VudHJ5X3QgKnByb2NfZW50cnksIHNuZF9pbmZv
X2J1ZmZlcl90ICpidWZmZXIpOworc3RhdGljIHZvaWQgc21hX3Byb2NfZGVidWdfcmVhZAorCShz
bmRfaW5mb19lbnRyeV90ICosIHNuZF9pbmZvX2J1ZmZlcl90ICopOworc3RhdGljIHNtYV9wcm9j
X2RlYnVnX3QqIHNtYV9wcm9jX2RlYnVnX2FwcGVuZChjaGFyICpuYW1lKTsKK3N0YXRpYyBpbnQg
c21hX3Byb2NfY3JlYXRlKHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXApOworLyogQUxTQSBTZXR1cCAq
Lworc3RhdGljIGludCBzbWFfZnJlZShzbmRfbWFjZV9hdWRpb190ICpjaGlwKTsKK3N0YXRpYyBp
bnQgX19kZXZpbml0IHNtYV9jcmVhdGUKKwkoc25kX2NhcmRfdCAqY2FyZCwgc25kX21hY2VfYXVk
aW9fdCAqKnJjaGlwKTsKK3N0YXRpYyBpbnQgX19kZXZpbml0IHNtYV9wcm9iZSh2b2lkKTsKKy8q
IG1vZHVsZSBzZXR1cCAqLworc3RhdGljIGludCBfX2luaXQgc25kX2NhcmRfbWFjZV9hdWRpb19p
bml0KHZvaWQpOworc3RhdGljIHZvaWQgX19leGl0IHNuZF9jYXJkX21hY2VfYXVkaW9fZXhpdCh2
b2lkKTsKKworCisvKioqKioqKioqKioqKioqKioqKioqKioqKiBkZWZpbmUgcHN1ZG8tZnVuY3Mg
KioqKioqKioqKioqKioqKioqKioqKioqKioqLworI2RlZmluZSBzbWFfcHJvY19lbnRyeV9hc3Nl
cnQoZW50cnksbmFtZSkgXAorCWlmIChOVUxMID09IGVudHJ5KSBlbnRyeSA9IHNtYV9wcm9jX2Vu
dHJ5X2FwcGVuZChuYW1lKTsKKworLyogcGNtMCBzdWJzdHJlYW0wID0gY2hhbm5lbCAxCisgKiBw
Y20wIHN1YnN0cmVhbTEgPSBjaGFubmVsIDAKKyAqIHBjbTEgc3Vic3RyZWFtMCA9IGNoYW5uZWwg
MgorICovCisjZGVmaW5lIHN1YnN0cmVhbV90b19jaGFubmVsX2luZGV4KHN1YnN0cmVhbSkgXAor
ICgoKChzbmRfbWFjZV9hdWRpb190Kikoc3Vic3RyZWFtLT5wcml2YXRlX2RhdGEpKS0+cGNtWzBd
PT1zdWJzdHJlYW0tPnBjbSlcCisgPyEoc3Vic3RyZWFtLT5udW1iZXIpOjIpCisKKy8qKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKiBnbG9iYWxzICoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKiovCisKKy8qIHVzaW5nIHNhbWUgZm9yIGFsbCAqLworc3RhdGljIHN0cnVjdCBzbmRf
cGNtX2hhcmR3YXJlIHNtYV9wY21faHdbMl0gPSB7CisJeyAvKiBEaXJlY3QgKi8KKwkuaW5mbyA9
IChTTkRSVl9QQ01fSU5GT19NTUFQIHwKKwkgICAgICAgICBTTkRSVl9QQ01fSU5GT19JTlRFUkxF
QVZFRCB8CisJICAgICAgICAgU05EUlZfUENNX0lORk9fQkxPQ0tfVFJBTlNGRVIgfAorCSAgICAg
ICAgIFNORFJWX1BDTV9JTkZPX01NQVBfVkFMSUQpLAorCS5mb3JtYXRzID0gICAgICAgICAgIFNO
RFJWX1BDTV9GTVRCSVRfUzI0X0JFLAorCS5yYXRlcyA9ICAgICAgICAgICAgIFNORFJWX1BDTV9S
QVRFXzgwMDBfNDgwMDAsCisJLnJhdGVfbWluID0gICAgICAgICAgODAwMCwKKwkucmF0ZV9tYXgg
PSAgICAgICAgICA0ODAwMCwKKwkuY2hhbm5lbHNfbWluID0gICAgICAyLAorCS5jaGFubmVsc19t
YXggPSAgICAgIDIsCisgICAgICAgIC5idWZmZXJfYnl0ZXNfbWF4ID0gIDQwOTYsCisJLnBlcmlv
ZF9ieXRlc19taW4gPSAgMzIsCisJLnBlcmlvZF9ieXRlc19tYXggPSAgMTAyNCwKKwkucGVyaW9k
c19taW4gPSAgICAgICA0LAorCS5wZXJpb2RzX21heCA9ICAgICAgIDEyOCwKKworCX0seyAvKiBp
bmRlcmN0IGJvdW5jZSBidWZmZXIgKi8KKworCS5pbmZvID0gKFNORFJWX1BDTV9JTkZPX01NQVAg
fAorCSAgICAgICAgIFNORFJWX1BDTV9JTkZPX0lOVEVSTEVBVkVEIHwKKwkgICAgICAgICBTTkRS
Vl9QQ01fSU5GT19CTE9DS19UUkFOU0ZFUiB8CisJICAgICAgICAgU05EUlZfUENNX0lORk9fTU1B
UF9WQUxJRCksCisJLmZvcm1hdHMgPSAgICAgICAgICAgU05EUlZfUENNX0ZNVEJJVF9TMjRfQkUs
CisJLnJhdGVzID0gICAgICAgICAgICAgU05EUlZfUENNX1JBVEVfODAwMF80ODAwMCwKKwkucmF0
ZV9taW4gPSAgICAgICAgICA4MDAwLAorCS5yYXRlX21heCA9ICAgICAgICAgIDQ4MDAwLAorCS5j
aGFubmVsc19taW4gPSAgICAgIDIsCisJLmNoYW5uZWxzX21heCA9ICAgICAgMiwKKyAgICAgICAg
LmJ1ZmZlcl9ieXRlc19tYXggPSAgMzI3NjgsCisJLnBlcmlvZF9ieXRlc19taW4gPSAgMzIsCisJ
LnBlcmlvZF9ieXRlc19tYXggPSAgMzI3NjgsCisJLnBlcmlvZHNfbWluID0gICAgICAgMSwKKwku
cGVyaW9kc19tYXggPSAgICAgICAxMDI0LAorCX0KK307CisKKy8qIHBjbSBvcGVyYXRvcnMgKi8K
K3N0YXRpYyBzdHJ1Y3Qgc25kX3BjbV9vcHMgc21hX3BjbV9vcHNbMl0gPSB7CisJeyAvKiBEaXJl
Y3QgKi8KKwkub3BlbiA9ICAgICAgIHNtYV9wY21fb3BlbiwKKwkuY2xvc2UgPSAgICAgIHNtYV9w
Y21fY2xvc2UsCisJLmlvY3RsID0gICAgICBzbmRfcGNtX2xpYl9pb2N0bCwKKwkuaHdfcGFyYW1z
ID0gIHNtYV9wY21faHdwYXJhbSwKKwkuaHdfZnJlZSA9ICAgIHNtYV9wY21faHdmcmVlLAorCS5w
cmVwYXJlID0gICAgc21hX3BjbV9wcmVwYXJlLAorCS50cmlnZ2VyID0gICAgc21hX3BjbV90cmln
Z2VyLAorCS5wb2ludGVyID0gICAgc21hX3BjbV9wb2ludGVyLAorCS5hY2sgICAgID0gICAgc21h
X3BjbV9hY2ssCisJLnBhZ2UgICAgPSAgICBzbWFfcGNtX3BhZ2UKKworCX0seyAvKiBpbmRlcmN0
IGJvdW5jZSBidWZmZXIgKi8KKwkub3BlbiA9ICAgICAgIHNtYV9wY21fb3BlbiwKKwkuY2xvc2Ug
PSAgICAgIHNtYV9wY21fY2xvc2UsCisJLmlvY3RsID0gICAgICBzbmRfcGNtX2xpYl9pb2N0bCwK
KwkuaHdfcGFyYW1zID0gIHNtYV9wY21faHdwYXJhbSwKKwkuaHdfZnJlZSA9ICAgIHNtYV9wY21f
aHdmcmVlLAorCS5wcmVwYXJlID0gICAgc21hX3BjbV9wcmVwYXJlLAorCS50cmlnZ2VyID0gICAg
c21hX3BjbV90cmlnZ2VyLAorCS5wb2ludGVyID0gICAgc21hX3BjbV9wb2ludGVyLAorCS5wYWdl
ICAgID0gICAgc21hX3BjbV9wYWdlCisKKwl9Cit9OworCisvKiByZWNvcmQgbGV2ZWwgbWl4ZXIg
Y29udHJvbCAqLworc3RhdGljIHNuZF9rY29udHJvbF9uZXdfdCBzbWFfY3RybF9yZWNsZXZlbCBf
X2RldmluaXRkYXRhID0geworCS5pZmFjZSAgICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0lGQUNF
X01JWEVSLAorCS5uYW1lICAgICAgICAgICA9ICJDYXB0dXJlIFZvbHVtZSIsCisJLmFjY2VzcyAg
ICAgICAgID0gU05EUlZfQ1RMX0VMRU1fQUNDRVNTX1JFQURXUklURSwKKwkucHJpdmF0ZV92YWx1
ZSAgPSBBRDE4NDNfR0FJTl9SRUNMRVYsCisJLmluZm8gICAgICAgICAgID0gc21hX2dhaW5faW5m
bywKKwkuZ2V0ICAgICAgICAgICAgPSBzbWFfZ2Fpbl9nZXQsCisJLnB1dCAgICAgICAgICAgID0g
c21hX2dhaW5fcHV0LAorfTsKKworLyogbGluZSBtaXhlciBjb250cm9sICovCitzdGF0aWMgc25k
X2tjb250cm9sX25ld190IHNtYV9jdHJsX2xpbmUgX19kZXZpbml0ZGF0YSA9IHsKKwkuaWZhY2Ug
ICAgICAgICAgPSBTTkRSVl9DVExfRUxFTV9JRkFDRV9NSVhFUiwKKwkubmFtZSAgICAgICAgICAg
PSAiTGluZSBWb2x1bWUiLAorCS5hY2Nlc3MgICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0FDQ0VT
U19SRUFEV1JJVEUsCisJLnByaXZhdGVfdmFsdWUgID0gQUQxODQzX0dBSU5fTElORSwKKwkuaW5m
byAgICAgICAgICAgPSBzbWFfZ2Fpbl9pbmZvLAorCS5nZXQgICAgICAgICAgICA9IHNtYV9nYWlu
X2dldCwKKwkucHV0ICAgICAgICAgICAgPSBzbWFfZ2Fpbl9wdXQsCit9OworCisvKiBjZCBtaXhl
ciBjb250cm9sICovCitzdGF0aWMgc25kX2tjb250cm9sX25ld190IHNtYV9jdHJsX2NkIF9fZGV2
aW5pdGRhdGEgPSB7CisJLmlmYWNlICAgICAgICAgID0gU05EUlZfQ1RMX0VMRU1fSUZBQ0VfTUlY
RVIsCisJLm5hbWUgICAgICAgICAgID0gIkNEIFZvbHVtZSIsCisJLmFjY2VzcyAgICAgICAgID0g
U05EUlZfQ1RMX0VMRU1fQUNDRVNTX1JFQURXUklURSwKKwkucHJpdmF0ZV92YWx1ZSAgPSBBRDE4
NDNfR0FJTl9DRCwKKwkuaW5mbyAgICAgICAgICAgPSBzbWFfZ2Fpbl9pbmZvLAorCS5nZXQgICAg
ICAgICAgICA9IHNtYV9nYWluX2dldCwKKwkucHV0ICAgICAgICAgICAgPSBzbWFfZ2Fpbl9wdXQs
Cit9OworCisvKiBtaWMgbWl4ZXIgY29udHJvbCAqLworc3RhdGljIHNuZF9rY29udHJvbF9uZXdf
dCBzbWFfY3RybF9taWMgX19kZXZpbml0ZGF0YSA9IHsKKwkuaWZhY2UgICAgICAgICAgPSBTTkRS
Vl9DVExfRUxFTV9JRkFDRV9NSVhFUiwKKwkubmFtZSAgICAgICAgICAgPSAiTWljIFZvbHVtZSIs
CisJLmFjY2VzcyAgICAgICAgID0gU05EUlZfQ1RMX0VMRU1fQUNDRVNTX1JFQURXUklURSwKKwku
cHJpdmF0ZV92YWx1ZSAgPSBBRDE4NDNfR0FJTl9NSUMsCisJLmluZm8gICAgICAgICAgID0gc21h
X2dhaW5faW5mbywKKwkuZ2V0ICAgICAgICAgICAgPSBzbWFfZ2Fpbl9nZXQsCisJLnB1dCAgICAg
ICAgICAgID0gc21hX2dhaW5fcHV0LAorfTsKKworLyogZGFjMS9wY20wIG1peGVyIGNvbnRyb2wg
Ki8KK3N0YXRpYyBzbmRfa2NvbnRyb2xfbmV3X3Qgc21hX2N0cmxfcGNtMCBfX2RldmluaXRkYXRh
ID0geworCS5pZmFjZSAgICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0lGQUNFX01JWEVSLAorCS5u
YW1lICAgICAgICAgICA9ICJQbGF5YmFjayBWb2x1bWUiLAorCS5hY2Nlc3MgICAgICAgICA9IFNO
RFJWX0NUTF9FTEVNX0FDQ0VTU19SRUFEV1JJVEUsCisJLnByaXZhdGVfdmFsdWUgID0gQUQxODQz
X0dBSU5fUENNXzAsCisJLmluZm8gICAgICAgICAgID0gc21hX2dhaW5faW5mbywKKwkuZ2V0ICAg
ICAgICAgICAgPSBzbWFfZ2Fpbl9nZXQsCisJLnB1dCAgICAgICAgICAgID0gc21hX2dhaW5fcHV0
LAorfTsKKworLyogZGFjMi9wY20xIG1peGVyIGNvbnRyb2wgKi8KK3N0YXRpYyBzbmRfa2NvbnRy
b2xfbmV3X3Qgc21hX2N0cmxfcGNtMSBfX2RldmluaXRkYXRhID0geworCS5pZmFjZSAgICAgICAg
ICA9IFNORFJWX0NUTF9FTEVNX0lGQUNFX01JWEVSLAorCS5uYW1lICAgICAgICAgICA9ICJQbGF5
YmFjayBBdXgtb3V0IFZvbHVtZSIsCisJLmFjY2VzcyAgICAgICAgID0gU05EUlZfQ1RMX0VMRU1f
QUNDRVNTX1JFQURXUklURSwKKwkucHJpdmF0ZV92YWx1ZSAgPSBBRDE4NDNfR0FJTl9QQ01fMSwK
KwkuaW5mbyAgICAgICAgICAgPSBzbWFfZ2Fpbl9pbmZvLAorCS5nZXQgICAgICAgICAgICA9IHNt
YV9nYWluX2dldCwKKwkucHV0ICAgICAgICAgICAgPSBzbWFfZ2Fpbl9wdXQsCit9OworCisKK0xJ
U1RfSEVBRChzbWFfcHJvY19kZWJ1Z19saXN0KTsKKworc3RhdGljIGludCAgIGFsc2FfaW5kZXgg
PSAtMTsKK3N0YXRpYyBjaGFyICphbHNhX2lkICAgID0gTlVMTDsKK3N0YXRpYyBpbnQgICBhbHNh
X2VuYWJsZT0gMTsKK3N0YXRpYyBpbnQgICBzbWFfaW5kaXJlY3QgPSAxOworCisvKiBHbG9iYWwg
bmVlZGVkIGZvciBtb2R1bGUgZXhpdCAqLworc25kX21hY2VfYXVkaW9fdCAqc25kX21hY2VfYXVk
aW9fY2hpcCA9IE5VTEw7CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBDTSAq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisvKiB0ZW1wIGRlYnVn
IGZ1bmMgKi8KKworc3RhdGljIHZvaWQgcHJpbnRfcG9pbnRlcnMoY29uc3QgY2hhciAqc3RyKQor
eworCXVuc2lnbmVkIGxvbmcgcmIsIHdwLCBycCwgZGVwdGg7CisJaW50IGNoaTsKKworCXJiID0g
cmVhZHEoJm1hY2UtPnBlcmlmLmN0cmwucmluZ2Jhc2UpOworCXByaW50ayAoIiVzLiByaW5nYmFz
ZT0weCVsWCxcbiIsIHN0ciwgcmIpOworCisJZm9yIChjaGk9MDsgY2hpPDM7IGNoaSsrKSB7CisK
KwkJd3AgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJ
CXJwID0gcmVhZHEoJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5yZWFkX3B0cik7CisJCWRl
cHRoID0gcmVhZHEoJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5kZXB0aCk7CisKKwkJcHJp
bnRrKCJcdCVkWyB3cml0ZXA9MHglbFggKCVsdSksIHJlYWRwPTB4JWxYICglbHUpLCAiCisJCQki
ZGVwdGg9MHglbFggKCVsdSkgXVxuIiwKKwkJCWNoaSwgd3AsIHdwLCBycCwgcnAsIGRlcHRoLCBk
ZXB0aCk7CisJfQorCit9CisKKworLyogcGxheSBvcGVuIGNhbGxiYWNrICovCitzdGF0aWMgaW50
IHNtYV9wY21fb3BlbihzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pCit7CisJLy9zbmRf
bWFjZV9hdWRpb190ICpjaGlwID0gc25kX3BjbV9zdWJzdHJlYW1fY2hpcChzdWJzdHJlYW0pOwor
CXNuZF9wY21fcnVudGltZV90ICpydW50aW1lID0gc3Vic3RyZWFtLT5ydW50aW1lOworCWludCBj
aGkgPSBzdWJzdHJlYW1fdG9fY2hhbm5lbF9pbmRleChzdWJzdHJlYW0pOworcHJpbnRrKCJpbiBw
Y20gb3BlbiBmb3IgY2hhbm5lbCAlZFxuIiwgY2hpKTsKKworCXJ1bnRpbWUtPmh3ID0gc21hX3Bj
bV9od1tzbWFfaW5kaXJlY3RdOworCisJcmV0dXJuIDA7Cit9CisKKy8qIHBsYXkgY2xvc2UgY2Fs
bGJhY2sgKi8KK3N0YXRpYyBpbnQgc21hX3BjbV9jbG9zZShzbmRfcGNtX3N1YnN0cmVhbV90ICpz
dWJzdHJlYW0pCit7CisJLy9zbmRfbWFjZV9hdWRpb190ICpjaGlwID0gc25kX3BjbV9zdWJzdHJl
YW1fY2hpcChzdWJzdHJlYW0pOworCS8vRklYTUUgY29kZQorcHJpbnRrKCJpbiBwY20gY2xvc2Vc
biIpOworCisJcmV0dXJuIDA7Cit9CisKKy8qIHNldHVwIGh3IGZvciBwY20gKi8KKy8qIG1heWJl
IGNhbGxlZCBtb3JlIHRoZW4gb25jZSAqLworc3RhdGljIGludCBzbWFfcGNtX2h3cGFyYW0KKwko
c25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtLCBzbmRfcGNtX2h3X3BhcmFtc190ICpod19w
YXJhbXMpCit7CisJc25kX21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9wY21fc3Vic3RyZWFtX2No
aXAoc3Vic3RyZWFtKTsKKwlpbnQgY2hpID0gc3Vic3RyZWFtX3RvX2NoYW5uZWxfaW5kZXgoc3Vi
c3RyZWFtKTsKK3ByaW50aygiSW4gaHcgcGFyYW0gZm9yIGNoYW5uZWwgJWRcbiIsIGNoaSk7CisK
KwlpZiAoc21hX2luZGlyZWN0KSB7CisKKwkJaWYgKE5VTEwgIT0gc3Vic3RyZWFtLT5ydW50aW1l
LT5kbWFfYXJlYSkKKwkJCXZmcmVlKHN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2FyZWEpOworCisJ
CXN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2J5dGVzID0KKwkJCXBhcmFtc19idWZmZXJfYnl0ZXMo
aHdfcGFyYW1zKTsKKworCQlzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hZGRyID0gMDsKKworCQlz
dWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hcmVhID0KKwkJCXZtYWxsb2NfdXNlcihzdWJzdHJlYW0t
PnJ1bnRpbWUtPmRtYV9ieXRlcyk7CisJCQorCX0gZWxzZSB7CisJCXN1YnN0cmVhbS0+cnVudGlt
ZS0+ZG1hX2J5dGVzID0gU01BX1JJTkdfU0laRTsKKworCQlzdWJzdHJlYW0tPnJ1bnRpbWUtPmRt
YV9hZGRyID0KKwkJCShjaGlwLT5yaW5nX2Jhc2VfaGFuZGxlICsgU01BX1JJTkdfT0ZGU0VUKGNo
aSkKKwkJCS8qKyBjaGlwLT5tYWNlX29mZnNldCovKTsKKwkJCS8qY2hpcC0+bWFjZWlzYV9iYXNl
ICsgU01BX1JJTkdfT0ZGU0VUKGNoaSk7Ki8KKwkJc3Vic3RyZWFtLT5ydW50aW1lLT5kbWFfYXJl
YSA9CisJCQkoY2hpcC0+cmluZ19iYXNlICsgU01BX1JJTkdfT0ZGU0VUKGNoaSkKKwkJCS8qKyBj
aGlwLT5tYWNlX29mZnNldH4qLyk7CisJfQorCitwcmludGsoInNldCBhbHNhIGRtYSBhcmVhPTB4
JWxYICglbHUpIHNpemU9MHglbFggKCVsdSlcbiIsCisJKHVuc2lnbmVkIGxvbmcpIHN1YnN0cmVh
bS0+cnVudGltZS0+ZG1hX2FyZWEsCisJKHVuc2lnbmVkIGxvbmcpIHN1YnN0cmVhbS0+cnVudGlt
ZS0+ZG1hX2FyZWEsCisJKHVuc2lnbmVkIGxvbmcpIHN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2J5
dGVzLAorCSh1bnNpZ25lZCBsb25nKSBzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9ieXRlcyk7CisK
KwlpZiAoTlVMTCA9PSBzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hcmVhKSB7CisJCXNuZF9wcmlu
dGsoS0VSTl9FUlIgIkRNQSBhcmVhIG5vdCBhbGxvY2F0ZWQhXG4iKTsKKwkJcmV0dXJuIC1FTk9N
RU07CisJfQorCisJcmV0dXJuIDE7Cit9CisKKy8qIGZyZWUgaHcgZm9yIHBjbSAqLworLyogbWF5
YmUgY2FsbGVkIG1vcmUgdGhlbiBvbmNlICovCitzdGF0aWMgaW50IHNtYV9wY21faHdmcmVlKHNu
ZF9wY21fc3Vic3RyZWFtX3QgKnN1YnN0cmVhbSkKK3sKKwlzbmRfbWFjZV9hdWRpb190ICpjaGlw
ID0gc25kX3BjbV9zdWJzdHJlYW1fY2hpcChzdWJzdHJlYW0pOworCWludCBjaGkgPSBzdWJzdHJl
YW1fdG9fY2hhbm5lbF9pbmRleChzdWJzdHJlYW0pOworcHJpbnRrKCJJbiBodyBmcmVlIGZvciBj
aGFubmVsICVkXG4iLCBjaGkpOworCisJaWYgKHNtYV9pbmRpcmVjdCAmJiBOVUxMICE9IHN1YnN0
cmVhbS0+cnVudGltZS0+ZG1hX2FyZWEpIHsKKwkJdmZyZWUoc3Vic3RyZWFtLT5ydW50aW1lLT5k
bWFfYXJlYSk7CisJfQorCisJc3Vic3RyZWFtLT5ydW50aW1lLT5kbWFfYnl0ZXMgPSAwOworCXN1
YnN0cmVhbS0+cnVudGltZS0+ZG1hX2FkZHIgPSAwOworCXN1YnN0cmVhbS0+cnVudGltZS0+ZG1h
X2FyZWEgPSBOVUxMOworCWNoaXAtPmNoYW5uZWxbY2hpXS5idWZmZXIgPSBOVUxMOworCWNoaXAt
PmNoYW5uZWxbY2hpXS5wb3MgPSAwOworCWNoaXAtPmNoYW5uZWxbY2hpXS5hY2sgPSAwOworCWNo
aXAtPmNoYW5uZWxbY2hpXS5mcmFtZXMgPSAwOworCisJcmV0dXJuIDE7Cit9CisKKy8qIHByZXBh
cmUgY2FsbGJhY2sgKi8KK3N0YXRpYyBpbnQgc21hX3BjbV9wcmVwYXJlKHNuZF9wY21fc3Vic3Ry
ZWFtX3QgKnN1YnN0cmVhbSkKK3sKKwlzbmRfbWFjZV9hdWRpb190ICpjaGlwID0gc25kX3BjbV9z
dWJzdHJlYW1fY2hpcChzdWJzdHJlYW0pOworCXNuZF9wY21fcnVudGltZV90ICpydW50aW1lID0g
c3Vic3RyZWFtLT5ydW50aW1lOworCWludCBjaGkgPSBzdWJzdHJlYW1fdG9fY2hhbm5lbF9pbmRl
eChzdWJzdHJlYW0pOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2
ZSgmY2hpcC0+Y2hhbm5lbFtjaGldLmxvY2ssIGZsYWdzKTsKKworCWNoaXAtPmNoYW5uZWxbY2hp
XS5wb3MgPSAwOworCWNoaXAtPmNoYW5uZWxbY2hpXS5mcmFtZXMgPSAwOworCWNoaXAtPmNoYW5u
ZWxbY2hpXS5hY2sgPSAwOworCWNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0gPSBzdWJzdHJl
YW07CisKKwlpZiAoMCA9PSBjaGkpIHsgLyogY2FwdHVyZSovCitwcmludGsoImluIHByZXBhcmUg
Y2FwdHVyZSBmb3IgY2hhbm5lbCAlZFxuIiwgY2hpKTsKKwkJCisJCWFkMTg0M19zZXR1cF9hZGMo
Y2hpcC0+YWQxODQzLAorCQkJcnVudGltZS0+cmF0ZSwKKwkJCVNORFJWX1BDTV9GT1JNQVRfUzI0
X0JFLAorCQkJcnVudGltZS0+Y2hhbm5lbHMpOworCX0gZWxzZSB7IC8qIHBsYXliYWNrICovCitw
cmludGsoImluIHByZXBhcmUgcGxheWJhY2sgZm9yIGNoYW5uZWwgJWQsIHJhdGUgJWQsIHN1Yi1j
aGFubmVscyAlZFxuIiwKKwljaGksIHJ1bnRpbWUtPnJhdGUsIHJ1bnRpbWUtPmNoYW5uZWxzKTsK
KworCQlhZDE4NDNfc2V0dXBfZGFjKGNoaXAtPmFkMTg0MywKKwkJCWNoaSwKKwkJCXJ1bnRpbWUt
PnJhdGUsCisJCQlTTkRSVl9QQ01fRk9STUFUX1MyNF9CRSwKKwkJCXJ1bnRpbWUtPmNoYW5uZWxz
KTsKKwl9CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjaGlwLT5jaGFubmVsW2NoaV0ubG9j
aywgZmxhZ3MpOworCisJcmV0dXJuIDA7Cit9CisKKy8qIHRyaWdnZXIgY2FsbGJhY2sgKi8KK3N0
YXRpYyBpbnQgc21hX3BjbV90cmlnZ2VyKHNuZF9wY21fc3Vic3RyZWFtX3QgKnN1YnN0cmVhbSwg
aW50IGNtZCkKK3sKK3ByaW50aygiSW4gcGNtIHRyaWdnZXJcbiIpOworCXN3aXRjaCAoY21kKSB7
CisJY2FzZSBTTkRSVl9QQ01fVFJJR0dFUl9TVEFSVDogLyogc3RhcnQgUENNIGVuZ2luZSAqLwor
CQlzbWFfZG1hX3N0YXJ0KHN1YnN0cmVhbSk7CisJCWJyZWFrOworCWNhc2UgU05EUlZfUENNX1RS
SUdHRVJfU1RPUDogLyogc3RvcCBQQ00gZW5naW5lICovCisJCXNtYV9kbWFfc3RvcChzdWJzdHJl
YW0pOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1
cm4gMDsKK30KKworLyogcG9pbnRlciBjYWxsYmFjayAqLworc3RhdGljIHNuZF9wY21fdWZyYW1l
c190IHNtYV9wY21fcG9pbnRlcgorCShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pCit7
CisJc25kX21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9wY21fc3Vic3RyZWFtX2NoaXAoc3Vic3Ry
ZWFtKTsKKwlpbnQgY2hpID0gc3Vic3RyZWFtX3RvX2NoYW5uZWxfaW5kZXgoc3Vic3RyZWFtKTsK
Kwl1bnNpZ25lZCBsb25nIHA7CisKKwlpZiAoc21hX2luZGlyZWN0KSB7CisKKwkJcCA9IGNoaXAt
PmNoYW5uZWxbY2hpXS5wb3M7CisKKwl9IGVsc2UgeworCisJCXAgPSByZWFkcSgmbWFjZS0+cGVy
aWYuYXVkaW8uY2hhbltjaGldLnJlYWRfcHRyKTsKKworCX0KKworLy9wcmludGsoInJldHVybmlu
ZyBwb2ludGVyIDB4JWxYICglbHUpIGZvciBjaGFubmVsICVkXG4iLCBwLCBwLCBjaGkpOworCisK
KwlyZXR1cm4gIGJ5dGVzX3RvX2ZyYW1lcyhzdWJzdHJlYW0tPnJ1bnRpbWUsIHApOworfQorCisv
KiBnZXQgcGFnZSBjYWxsYmFjayAqLworc3RhdGljIHN0cnVjdCBwYWdlICpzbWFfcGNtX3BhZ2UK
Kwkoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtLCB1bnNpZ25lZCBsb25nIG9mZnNldCkK
K3sKKwlzdHJ1Y3QgcGFnZSAqcDsKK3ByaW50aygiaW4gcGFnZVxuIik7CisKKwlpZiAoc21hX2lu
ZGlyZWN0KSB7CisJCXAgPSB2bWFsbG9jX3RvX3BhZ2UoKHN1YnN0cmVhbS0+cnVudGltZS0+ZG1h
X2FyZWEgKyBvZmZzZXQpKTsKKwl9IGVsc2UgeworCQkvKkZJWE1FIHVzaW5nIENBQ19BQURSIHVu
dGlsIGEgcHJvcGVyIGFsc2EgZG1hIG9uIG1pcHMgZml4ICovCisJCXAgPSB2aXJ0X3RvX3BhZ2Uo
CisJCQlDQUNfQUREUigoc3Vic3RyZWFtLT5ydW50aW1lLT5kbWFfYXJlYSArIG9mZnNldCkpKTsK
Kwl9CisKKwlyZXR1cm4gcDsKK30KKworLyogYWNrIGNhbGxiYWNrLCB3aGVuIHNvbWUgbW9yZSBk
YXRhIGlzIHdyaXR0ZW4gKi8KK3N0YXRpYyBpbnQgc21hX3BjbV9hY2soc25kX3BjbV9zdWJzdHJl
YW1fdCAqc3Vic3RyZWFtKQoreworCS8vc25kX21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9wY21f
c3Vic3RyZWFtX2NoaXAoc3Vic3RyZWFtKTsKKwlpbnQgY2hpID0gc3Vic3RyZWFtX3RvX2NoYW5u
ZWxfaW5kZXgoc3Vic3RyZWFtKTsKKwl1bnNpZ25lZCBsb25nIGFwOworCisJYXAgPSBmcmFtZXNf
dG9fYnl0ZXMoc3Vic3RyZWFtLT5ydW50aW1lLAorCQlzdWJzdHJlYW0tPnJ1bnRpbWUtPmNvbnRy
b2wtPmFwcGxfcHRyKTsKKworCS8vYXAgPS0gU01BX1JJTkdfU0laRTsKKwlpZiAoMzIgPiBhcCkg
YXAgKz0gU01BX1JJTkdfU0laRTsKKwlhcCAtPSAzMjsKKwlhcCAmPSBTTUFfUklOR19NQVNLOwor
CitwcmludGsoImluIGFjaywgYXA9MHglbFggKCVsdSksIGZvciBjaGFubmVsICVkXG4iLCBhcCwg
YXAsIGNoaSk7CisJd3JpdGVxKGFwLCAmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRl
X3B0cik7CisKKwkvKiBzZXQgRE1BIHRvIHdha2Ugb24gNTAlIGVtcHR5IGFuZCBlbmFibGUgaW50
ZXJydXB0ICovCisvKgl3cml0ZXEoU01BX0RNQV9FTkFCTEUgfCBTTUFfSU5UX1RIUkVTSE9MRF81
MCwKKwkJJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5jb250cm9sKTsqLworCW1iKCk7CisK
KwlyZXR1cm4gMDsKK30KKworCisvKiBjcmVhdGUgcGNtIGRldmljZSAqLworc3RhdGljIGludCBf
X2RldmluaXQgc21hX3BjbV9uZXcoc25kX21hY2VfYXVkaW9fdCAqY2hpcCkKK3sKKwlzbmRfcGNt
X3QgKnBjbTsKKwlpbnQgZXJyLCBjaGk7CisKKwkvKiByZXNldCBjaGFubmVscyBhbmQgbGVhdmUg
dGhlbSBvZmYgKi8KKwlmb3IgKGNoaT0wOyBjaGk8MzsgY2hpKyspIHsKKwkJd3JpdGVxKDAsCisJ
CQkmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLmNvbnRyb2wpOworCisJCXdyaXRlcSgwLCAm
bWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJCXdyaXRlcSgwLCAmbWFj
ZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLnJlYWRfcHRyKTsKKworCQl3cml0ZXEoU01BX0NUUkxf
Q0hBTl9SRVNFVCwKKwkJCSZtYWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0uY29udHJvbCk7CisJ
CQkKKwkJc3Bpbl9sb2NrX2luaXQoJmNoaXAtPmNoYW5uZWxbY2hpXS5sb2NrKTsKKwl9CisKKwlw
Y20gPSBOVUxMOworCWVyciA9IHNuZF9wY21fbmV3KGNoaXAtPmNhcmQsICJNYWNlIEF1ZGlvIDEi
LCAwLCAxLCAxLCAmcGNtKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVycjsKKworCXBjbS0+cHJp
dmF0ZV9kYXRhID0gY2hpcDsKKwlzdHJjcHkocGNtLT5uYW1lLCAiTWFjZSBBdWRpbyBQcmltYXJ5
Iik7CisKKwkvKiBzZXQgb3BlcmF0b3JzICovCisJc25kX3BjbV9zZXRfb3BzKHBjbSwgU05EUlZf
UENNX1NUUkVBTV9QTEFZQkFDSywKKwkJJnNtYV9wY21fb3BzW3NtYV9pbmRpcmVjdF0pOworCXNu
ZF9wY21fc2V0X29wcyhwY20sIFNORFJWX1BDTV9TVFJFQU1fQ0FQVFVSRSwKKwkJJnNtYV9wY21f
b3BzW3NtYV9pbmRpcmVjdF0pOworCisJY2hpcC0+cGNtWzBdID0gcGNtOworCisKKwlwY20gPSBO
VUxMOworCWVyciA9IHNuZF9wY21fbmV3KGNoaXAtPmNhcmQsICJNYWNlIEF1ZGlvIDEiLCAxLCAx
LCAwLCAmcGNtKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVycjsgLypmcmVlIHBjbTAgPyAqLwor
CisJcGNtLT5wcml2YXRlX2RhdGEgPSBjaGlwOworCXN0cmNweShwY20tPm5hbWUsICJNYWNlIEF1
ZGlvIFNlY29uZGFyeSIpOworCisJLyogc2V0IG9wZXJhdG9ycyAqLworCXNuZF9wY21fc2V0X29w
cyhwY20sIFNORFJWX1BDTV9TVFJFQU1fUExBWUJBQ0ssCisJCSZzbWFfcGNtX29wc1tzbWFfaW5k
aXJlY3RdKTsKKworCWNoaXAtPnBjbVsxXSA9IHBjbTsKKworCXJldHVybiAwOworfQorCisvKioq
KioqKioqKioqKioqKioqKioqKioqKioqIEludGVycnVwdHMgYW5kIERNQSBlbmdpbmUgKioqKioq
KioqKioqKioqKi8KK3N0YXRpYyBpbnQgc21hX2RtYV9zdGFydChzbmRfcGNtX3N1YnN0cmVhbV90
ICpzdWJzdHJlYW0pCit7CisJc25kX21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9wY21fc3Vic3Ry
ZWFtX2NoaXAoc3Vic3RyZWFtKTsKKwlpbnQgY2hpID0gc3Vic3RyZWFtX3RvX2NoYW5uZWxfaW5k
ZXgoc3Vic3RyZWFtKTsKKworcHJpbnRrKCJJbiBETUEgZW5hYmxlIGZvciBjaGFubmVsICVkXG4i
LCBjaGkpOworCisJaWYgKHNtYV9pbmRpcmVjdCkgeworCQlzbWFfZG1hX3JlZmlsbChjaGlwLCBj
aGkpOworCX0JCisKKwkvKiBzZXQgRE1BIHRvIHdha2Ugb24gNTAlIGVtcHR5IGFuZCBlbmFibGUg
aW50ZXJydXB0ICovCisJd3JpdGVxKFNNQV9ETUFfRU5BQkxFIHwgU01BX0lOVF9USFJFU0hPTERf
NTAsCisJCSZtYWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0uY29udHJvbCk7CisJbWIoKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHNtYV9kbWFfc3RvcChzbmRfcGNtX3N1YnN0cmVh
bV90ICpzdWJzdHJlYW0pCit7CisJaW50IGNoaSA9IHN1YnN0cmVhbV90b19jaGFubmVsX2luZGV4
KHN1YnN0cmVhbSk7CitwcmludGsoIkluIERNQSBzdG9wIGZvciBjaGFubmVsICVkXG4iLCBjaGkp
OworCisJd3JpdGVxKFNNQV9DVFJMX0NIQU5fUkVTRVQsCisJCSZtYWNlLT5wZXJpZi5hdWRpby5j
aGFuW2NoaV0uY29udHJvbCk7CisJbWIoKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9p
ZCBzbWFfZG1hX3Bpbmcoc25kX21hY2VfYXVkaW9fdCAqY2hpcCwgaW50IGNoaSkKK3sKKworCWlm
IChzbWFfaW5kaXJlY3QpeworCQlzbWFfZG1hX3JlZmlsbChjaGlwLCBjaGkpOworCQlzbmRfcGNt
X3BlcmlvZF9lbGFwc2VkKGNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0pOworCX0gZWxzZSB7
CisJCXNuZF9wY21fcGVyaW9kX2VsYXBzZWQoY2hpcC0+Y2hhbm5lbFtjaGldLnN1YnN0cmVhbSk7
CisJCS8qIFN0b3AgRE1BIGlmIHJ1bm5pbmcgbG93ICovCisJCS8qZGVwdGggPSByZWFkcSgmbWFj
ZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLmRlcHRoKTsKKwkJaWYgKDEwMjQgPiBkZXB0aCkgc21h
X2RtYV9zdG9wKGNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0pOyovCisJfQorCit9CisKK3N0
YXRpYyB2b2lkIHNtYV9kbWFfcmVmaWxsKHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIGludCBjaGkp
Cit7CisJdTY0ICpkc3QsIGRzdF9iYXNlLCBkc3RfcG9zLCAqc3JjLCBzcmNfYmFzZSwgc3JjX3Bv
cywgc3JjX21hc2s7CisJdW5zaWduZWQgbG9uZyBmbGFncywgZmlsbGVkLCBhdmFpbGFibGU7CisJ
aW50IGk7CisJc3RydWN0IHNuZF9wY21fcnVudGltZSAqcnVudGltZSA9CisJCWNoaXAtPmNoYW5u
ZWxbY2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWU7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+
Y2hhbm5lbFtjaGldLmxvY2ssIGZsYWdzKTsKKworCWRzdF9iYXNlID0gKHU2NCljaGlwLT5yaW5n
X2Jhc2UgKyBTTUFfUklOR19PRkZTRVQoY2hpKSArIGNoaXAtPm1hY2Vfb2Zmc2V0OworCXNyY19i
YXNlID0gKHU2NClydW50aW1lLT5kbWFfYXJlYTsKKworCWRzdF9wb3MgPSByZWFkcSgmbWFjZS0+
cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJc3JjX3BvcyA9IGNoaXAtPmNoYW5u
ZWxbY2hpXS5wb3M7CisKKwkvL3NyY19tYXNrID0gcnVudGltZS0+ZG1hX2J5dGVzIC0xOworCXNy
Y19tYXNrID0gZnJhbWVzX3RvX2J5dGVzKHJ1bnRpbWUsIHJ1bnRpbWUtPmJ1ZmZlcl9zaXplKSAt
IDE7CisKKwlkc3QgPSAodTY0KikoZHN0X2Jhc2UgKyBkc3RfcG9zKTsKKwlzcmMgPSAodTY0Kiko
c3JjX2Jhc2UgKyBzcmNfcG9zKTsKKzsKKwlmaWxsZWQgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVk
aW8uY2hhbltjaGldLmRlcHRoKTsKKwlhdmFpbGFibGUgPSBTTUFfUklOR19TSVpFIC0gZmlsbGVk
OworCisJLyogZG9uJ3QgY2F0Y2ggdXAgd2l0aCB0aGUgZW5kLCBub3RlIDMyIGJ5dGUgY2h1bmtz
Ki8KKwlpZiAoU01BX1JJTkdfU0laRSA8PSBhdmFpbGFibGUpIGF2YWlsYWJsZSAtPSAzMjsKKwor
CS8qIGNvcHkgaW4gMzIgYnl0ZSBibG9ja3MgKi8KKwl3aGlsZSAoMzEgPCBhdmFpbGFibGUpIGZv
ciAoaT0wOyBpPDMyOyBpKz1zaXplb2YodTY0KSkgeworCisJCSpkc3QgPSAqc3JjOworCisJCWRz
dF9wb3MgKz0gc2l6ZW9mKHU2NCk7CisJCWRzdF9wb3MgJj0gU01BX1JJTkdfTUFTSzsKKwkJZHN0
ID0gKHU2NCopKGRzdF9iYXNlICsgZHN0X3Bvcyk7CisKKwkJc3JjX3BvcyArPSBzaXplb2YodTY0
KTsKKwkJc3JjX3BvcyAmPSBzcmNfbWFzazsKKwkJc3JjID0gKHU2NCopKHNyY19iYXNlICsgc3Jj
X3Bvcyk7CisKKwkJYXZhaWxhYmxlIC09IHNpemVvZih1NjQpOworCX0KKworCXdyaXRlcShkc3Rf
cG9zLCAmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJY2hpcC0+Y2hh
bm5lbFtjaGldLnBvcyA9IHNyY19wb3M7CisJbWIoKTsKKworCXNyY19wb3MgPSByZWFkcSgmbWFj
ZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJaWYgKHNyY19wb3MgIT0gZHN0
X3BvcykKKwkJcHJpbnRrKCJvaG9oIHJpbmcgYm91bmRhcnkgbm90IG1hdGNoZWQhIDB4JWxYICE9
IDB4JWxYXG4iLAorCQkJc3JjX3BvcywgZHN0X3Bvcyk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZjaGlwLT5jaGFubmVsW2NoaV0ubG9jaywgZmxhZ3MpOworfQorCitzdGF0aWMgaXJxcmV0
dXJuX3Qgc21hX2ludGVycnVwdAorCShpbnQgaXJxLCBzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBz
dHJ1Y3QgcHRfcmVncyAqcmVncykKK3sKKwlzd2l0Y2ggKGlycSkgeworCWNhc2UgTUFDRUlTQV9B
VURJT19TV19JUlE6CisJCXByaW50aygiR290IE1BQ0VJU0EgQVVESU8gU1cgSVJRXG4iKTsKKwkJ
cmV0dXJuIElSUV9OT05FOyAvKlRPRE8qLworCisJY2FzZSBNQUNFSVNBX0FVRElPX1NDX0lSUToK
KwkJc21hX2FkanVzdF92b2woY2hpcCk7CisJCWJyZWFrOworCisJY2FzZSBNQUNFSVNBX0FVRElP
MV9ETUFUX0lSUToKKwkJc21hX2RtYV9waW5nKGNoaXAsIDApOworCQlicmVhazsKKworCWNhc2Ug
TUFDRUlTQV9BVURJTzFfT0ZfSVJROgorCQlwcmludGsoIkdvdCBNQUNFSVNBIEFVRElPMSBPRiBJ
UlFcbiIpOworCQlyZXR1cm4gSVJRX05PTkU7IC8qVE9ETyovCisKKwljYXNlIE1BQ0VJU0FfQVVE
SU8yX0RNQVRfSVJROgorCQlzbWFfZG1hX3BpbmcoY2hpcCwgMSk7CisJCWJyZWFrOworCisJY2Fz
ZSBNQUNFSVNBX0FVRElPMl9NRVJSX0lSUToKKwkJcHJpbnRrKCJHb3QgTUFDRUlTQSBBVURJTzIg
TUVSUiBJUlFcbiIpOworCQlyZXR1cm4gSVJRX05PTkU7IC8qVE9ETyovCisKKwljYXNlIE1BQ0VJ
U0FfQVVESU8zX0RNQVRfSVJROgorCQlzbWFfZG1hX3BpbmcoY2hpcCwgMik7CisJCWJyZWFrOwor
CisJY2FzZSBNQUNFSVNBX0FVRElPM19NRVJSX0lSUToKKwkJcHJpbnRrKCJHb3QgTUFDRUlTQSBB
VURJTzMgTUVSUiBJUlFcbiIpOworCQlyZXR1cm4gSVJRX05PTkU7IC8qVE9ETyovCisKKwlkZWZh
dWx0OgorCQlzbmRfcHJpbnRrKEtFUk5fRVJSICJVbmtub3duIElSUSByZWNlaXZlZCFcbiIpOwor
CQlyZXR1cm4gSVJRX05PTkU7CisJfQorCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorCitzdGF0
aWMgdm9pZCBzbWFfYWRqdXN0X3ZvbChzbmRfbWFjZV9hdWRpb190ICpjaGlwKQoreworCXVuc2ln
bmVkIGxvbmcgc3RhdHVzLCBmbGFnczsKKwl1bnNpZ25lZCBpbnQgcnZvbCxsdm9sOworCisJc3Bp
bl9sb2NrX2lycXNhdmUoJmNoaXAtPmFkMTg0M19sb2NrLCBmbGFncyk7CisKKwlzdGF0dXMgPSBy
ZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29udHJvbCk7CisJcnZvbCA9IGFkMTg0M19nZXRfZ2Fp
bihjaGlwLT5hZDE4NDMsIGNoaXAtPmV4dF92b2xfZm9yKTsKKwlsdm9sID0gKHJ2b2w+PjgpJjB4
RkY7CisJcnZvbCAmPSAweEZGOworCitwcmludGsoImluIHZvbHVtZSBhZGp1c3QgZm9yICVkLCBj
dXJyZW50IHZvbCAlZHwlZCwgc3RhdHVzICVsZFxuIiwKKwljaGlwLT5leHRfdm9sX2ZvciwgbHZv
bCwgcnZvbCwgc3RhdHVzKTsKKworCWlmICgoc3RhdHVzICYgU01BX0NUUkxfVk9MX0JVVFRPTl9V
UCkgPjApIHsKKwkJc3RhdHVzICY9IH5TTUFfQ1RSTF9WT0xfQlVUVE9OX1VQOworCQl3cml0ZXEo
c3RhdHVzLCAmbWFjZS0+cGVyaWYuYXVkaW8uY29udHJvbCk7CisJCW1iKCk7CisKKwkJaWYgKDEw
MCA+IGx2b2wpIGx2b2wrKzsKKwkJaWYgKDEwMCA+IHJ2b2wpIHJ2b2wrKzsKKwl9CisKKwlpZiAo
KHN0YXR1cyAmIFNNQV9DVFJMX1ZPTF9CVVRUT05fRE9XTikgPjApIHsKKwkJc3RhdHVzICY9IH5T
TUFfQ1RSTF9WT0xfQlVUVE9OX0RPV047CisJCXdyaXRlcShzdGF0dXMsICZtYWNlLT5wZXJpZi5h
dWRpby5jb250cm9sKTsKKwkJbWIoKTsKKworCQlpZiAoMCA8IGx2b2wpIGx2b2wtLTsKKwkJaWYg
KDAgPCBydm9sKSBydm9sLS07CisJfQorCisJYWQxODQzX3NldF9nYWluKGNoaXAtPmFkMTg0Mywg
Y2hpcC0+ZXh0X3ZvbF9mb3IsICgobHZvbDw8OCl8cnZvbCkpOworCisJbWIoKTsKKworCXN0YXR1
cyA9IHJlYWRxKCZtYWNlLT5wZXJpZi5hdWRpby5jb250cm9sKTsKK3ByaW50aygibGVhdmluZyB2
b2x1bWUgYWRqdXN0LCB2b2wgbm93ICVkfCVkLCBzdGF0dXMgJWxkXG4iLAorCWx2b2wsIHJ2b2ws
IHN0YXR1cyk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjaGlwLT5hZDE4NDNfbG9jaywg
ZmxhZ3MpOworCit9CisKKy8qKioqKioqKioqKioqKioqKioqKiBNaXhlciBhbmQgY29udHJvbHMg
KioqKioqKioqKioqKioqKioqKiovCisKK3N0YXRpYyBpbnQgc21hX2dhaW5faW5mbworCShzbmRf
a2NvbnRyb2xfdCAqa2NvbnRyb2wsIHNuZF9jdGxfZWxlbV9pbmZvX3QgKnVpbmZvKQoreworCXVp
bmZvLT50eXBlID0gU05EUlZfQ1RMX0VMRU1fVFlQRV9JTlRFR0VSOworCXVpbmZvLT5jb3VudCA9
IDI7CisJdWluZm8tPnZhbHVlLmludGVnZXIubWluID0gMDsKKwl1aW5mby0+dmFsdWUuaW50ZWdl
ci5tYXggPSAxMDA7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBzbWFfZ2Fpbl9nZXQK
Kwkoc25kX2tjb250cm9sX3QgKmtjb250cm9sLCBzbmRfY3RsX2VsZW1fdmFsdWVfdCAqdWNvbnRy
b2wpCit7CisJc25kX21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9rY29udHJvbF9jaGlwKGtjb250
cm9sKTsKKwlpbnQgdm9sOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJx
c2F2ZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZsYWdzKTsKKworCXZvbCA9IGFkMTg0M19nZXRfZ2Fp
bihjaGlwLT5hZDE4NDMsIChpbnQpa2NvbnRyb2wtPnByaXZhdGVfdmFsdWUpOworCisJdWNvbnRy
b2wtPnZhbHVlLmludGVnZXIudmFsdWVbMF0gPSB2b2wgJiAweEZGOworCXVjb250cm9sLT52YWx1
ZS5pbnRlZ2VyLnZhbHVlWzFdID0gKHZvbCA+PiA4KSAmIDB4RkY7CisKKwlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZjaGlwLT5hZDE4NDNfbG9jaywgZmxhZ3MpOworCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBpbnQgc21hX2dhaW5fcHV0CisJKHNuZF9rY29udHJvbF90ICprY29udHJvbCwgc25k
X2N0bF9lbGVtX3ZhbHVlX3QgKnVjb250cm9sKQoreworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAg
PSBzbmRfa2NvbnRyb2xfY2hpcChrY29udHJvbCk7CisJaW50IG5ld3ZvbCwgb2xkdm9sOworCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+YWQxODQzX2xv
Y2ssIGZsYWdzKTsKKworCW9sZHZvbCA9IGFkMTg0M19nZXRfZ2FpbihjaGlwLT5hZDE4NDMsIGtj
b250cm9sLT5wcml2YXRlX3ZhbHVlKTsKKwluZXd2b2wgPSAodWNvbnRyb2wtPnZhbHVlLmludGVn
ZXIudmFsdWVbMV0gPDwgOCkgfAorCQl1Y29udHJvbC0+dmFsdWUuaW50ZWdlci52YWx1ZVswXTsK
KworCW5ld3ZvbCA9IGFkMTg0M19zZXRfZ2FpbihjaGlwLT5hZDE4NDMsIGtjb250cm9sLT5wcml2
YXRlX3ZhbHVlLAorCQluZXd2b2wpOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+
YWQxODQzX2xvY2ssIGZsYWdzKTsKKworCXJldHVybiAobmV3dm9sICE9IG9sZHZvbCk7Cit9CisK
K3N0YXRpYyBpbnQgX19kZXZpbml0IHNtYV9jb250cm9sX25ldyhzbmRfbWFjZV9hdWRpb190ICpj
aGlwKQoreworCWludCBlcnI7CisKKwllcnIgPSBzbmRfY3RsX2FkZChjaGlwLT5jYXJkLAorCQlz
bmRfY3RsX25ldzEoJnNtYV9jdHJsX3JlY2xldmVsLCBjaGlwKSk7CisJaWYgKDAgPiBlcnIpIHJl
dHVybiBlcnI7CisKKwllcnIgPSBzbmRfY3RsX2FkZChjaGlwLT5jYXJkLAorCQlzbmRfY3RsX25l
dzEoJnNtYV9jdHJsX2xpbmUsIGNoaXApKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVycjsKKwor
CWVyciA9IHNuZF9jdGxfYWRkKGNoaXAtPmNhcmQsCisJCXNuZF9jdGxfbmV3MSgmc21hX2N0cmxf
Y2QsIGNoaXApKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVycjsKKworCWVyciA9IHNuZF9jdGxf
YWRkKGNoaXAtPmNhcmQsCisJCXNuZF9jdGxfbmV3MSgmc21hX2N0cmxfbWljLCBjaGlwKSk7CisJ
aWYgKDAgPiBlcnIpIHJldHVybiBlcnI7CisKKwllcnIgPSBzbmRfY3RsX2FkZChjaGlwLT5jYXJk
LAorCQlzbmRfY3RsX25ldzEoJnNtYV9jdHJsX3BjbTAsIGNoaXApKTsKKwlpZiAoMCA+IGVycikg
cmV0dXJuIGVycjsKKworCWVyciA9IHNuZF9jdGxfYWRkKGNoaXAtPmNhcmQsCisJCXNuZF9jdGxf
bmV3MSgmc21hX2N0cmxfcGNtMSwgY2hpcCkpOworCWlmICgwID4gZXJyKSByZXR1cm4gZXJyOwor
CisJLypwbGFuIGEgbWl4ZXIgY29udHJvbCB0aGF0IGNhbiBjaGFuZ2UgdGhpcyovCisJY2hpcC0+
ZXh0X3ZvbF9mb3IgPSBBRDE4NDNfR0FJTl9QQ01fMDsKKworCXJldHVybiAwOworfQorCisvKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqIFByb2MgZmlsZXMgKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KK3N0YXRpYyB2b2lkIHNtYV9wcm9jX2FkMTg0M19yZWFkCisJKHNu
ZF9pbmZvX2VudHJ5X3QgKnByb2NfZW50cnksIHNuZF9pbmZvX2J1ZmZlcl90ICpidWZmZXIpCit7
CisJaW50IGk7CisJY2hhciAqc3RyOworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAgPSBwcm9jX2Vu
dHJ5LT5wcml2YXRlX2RhdGE7CisKKwlzbmRfaXByaW50ZihidWZmZXIsCisJCSJ8ICAxNS83ICAg
fCAgMTQvNiAgIHwgIDEzLzUgICB8ICAxMi80ICAgIgorCQkifCAgMTEvMyAgIHwgIDEwLzIgICB8
ICAgOS8xICAgfCAgIDgvMCAgIHxcbiIpOworCisJZm9yIChpPTA7IGk8MzI7IGkrKyl7CisKKwkJ
c3RyID0gYWQxODQzX2R1bXBfcmVnKGNoaXAtPmFkMTg0MywgaSk7CisJCWlmIChOVUxMID09IHN0
cikgY29udGludWU7CisKKwkJc25kX2lwcmludGYoYnVmZmVyLCBzdHIpOworCisJCXZmcmVlKHN0
cik7CisJfQorCit9CisKK3N0YXRpYyB2b2lkIHNtYV9wcm9jX21hY2VfcmVhZAorCShzbmRfaW5m
b19lbnRyeV90ICpwcm9jX2VudHJ5LCBzbmRfaW5mb19idWZmZXJfdCAqYnVmZmVyKQoreworCXNu
ZF9tYWNlX2F1ZGlvX3QgKmNoaXAgPSBwcm9jX2VudHJ5LT5wcml2YXRlX2RhdGE7CisJdW5zaWdu
ZWQgbG9uZyByLHcsYyxkOworCWludCBjaGk7CisKKwltYigpOworCXIgPSByZWFkcSgmbWFjZS0+
cGVyaWYuY3RybC5yaW5nYmFzZSk7CisJc25kX2lwcmludGYoYnVmZmVyLCAiTUFDRSBQZXJpZmVy
YWxzIFJpbmdiYXNlOiAweCVsWCAoJWx1KVxuIgorCQkiXHQoQ1BVIEFkZHJlc3M6IDB4JWxYICgl
bHUpLCBTZXQgQnVzIEFkZHJlc3M6IDB4JWxYICglbHUpKVxuIiwKKwkJKHVuc2lnbmVkIGxvbmcp
ciwgKHVuc2lnbmVkIGxvbmcpciwKKwkJKHVuc2lnbmVkIGxvbmcpY2hpcC0+cmluZ19iYXNlLCAo
dW5zaWduZWQgbG9uZyljaGlwLT5yaW5nX2Jhc2UsCisJCWNoaXAtPnJpbmdfYmFzZV9oYW5kbGUs
IGNoaXAtPnJpbmdfYmFzZV9oYW5kbGUpOworCisJYyA9IHJlYWRxKCZtYWNlLT5wZXJpZi5hdWRp
by5jb250cm9sKTsKKwlzbmRfaXByaW50ZihidWZmZXIsICJNQUNFIEF1ZGlvIENvbnRyb2w6IDB4
JWxYICglbHUpXG4iLCBjLCBjKTsKKworCWMgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29k
ZWNfY29udHJvbCk7CisJc25kX2lwcmludGYoYnVmZmVyLCAiTUFDRSBBdWRpbyBDb2RlYyBTdGF0
dXMgQ29udHJvbDogMHglbFggKCVsdSlcbiIsIGMsIGMpOworCisJZCA9IHJlYWRxKCZtYWNlLT5w
ZXJpZi5hdWRpby5jb2RlY19tYXNrKTsKKwlzbmRfaXByaW50ZihidWZmZXIsICJNQUNFIEF1ZGlv
IENvZGVjIFN0YXR1cyBJUlEgTWFzazogMHglbFggKCVsdSlcbiIsIGQsIGQpOworCisJciA9IHJl
YWRxKCZtYWNlLT5wZXJpZi5hdWRpby5jb2RlY19yZWFkKTsKKwlzbmRfaXByaW50ZihidWZmZXIs
ICJNQUNFIEF1ZGlvIENvZGVjIFN0YXR1cyBWYWx1ZTogMHglbFggKCVsdSlcbiIsIHIsIHIpOwor
CisJZm9yIChjaGk9MDsgY2hpPDM7IGNoaSsrKSB7CisKKwkJbWIoKTsKKwkJYyA9IHJlYWRxKCZt
YWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0uY29udHJvbCk7CisJCXIgPSByZWFkcSgmbWFjZS0+
cGVyaWYuYXVkaW8uY2hhbltjaGldLnJlYWRfcHRyKTsKKwkJdyA9IHJlYWRxKCZtYWNlLT5wZXJp
Zi5hdWRpby5jaGFuW2NoaV0ud3JpdGVfcHRyKTsKKwkJZCA9IHJlYWRxKCZtYWNlLT5wZXJpZi5h
dWRpby5jaGFuW2NoaV0uZGVwdGgpOworCisJCXNuZF9pcHJpbnRmKGJ1ZmZlciwgIk1BQ0UgQXVk
aW8gQ2hhbm5lbCAldTotXG4iCisJCQkiXHRDb250cm9sOiAweCVsWCAoJWx1KVxuIgorCQkJIlx0
UmVhZCBQb2ludGVyOiAweCVsWCAoJWx1KVxuIgorCQkJIlx0V3JpdGUgUG9pbnRlcjogMHglbFgg
KCVsdSlcbiIKKwkJCSJcdERlcHRoOiAweCVsWCAoJWx1KVxuIiwKKwkJCWNoaSwgYywgYywgciwg
ciwgdywgdywgZCwgZCk7CisKKwkJaWYgKGNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0gJiYK
KwkJICAgIGNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWUgKSB7CisJCQl1bnNp
Z25lZCBsb25nIGFwID0gZnJhbWVzX3RvX2J5dGVzKAorCQkJCWNoaXAtPmNoYW5uZWxbY2hpXS5z
dWJzdHJlYW0tPnJ1bnRpbWUsCisJCQkJY2hpcC0+Y2hhbm5lbFtjaGldLnN1YnN0cmVhbS0+cnVu
dGltZS0+Y29udHJvbAorCQkJCQktPmFwcGxfcHRyKTsKKworCisJCQlzbmRfaXByaW50ZihidWZm
ZXIsICJcdEFMU0EgUnVudGltZSBETUEgYXJlYTogMHglbFggKCVsdSlcbiIsCisJCQkJY2hpcC0+
Y2hhbm5lbFtjaGldLnN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2FyZWEsCisJCQkJY2hpcC0+Y2hh
bm5lbFtjaGldLnN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2FyZWEpOworCisJCQlzbmRfaXByaW50
ZihidWZmZXIsICJcdEFMU0EgQXBwIFBvaW50ZXI6IDB4JWxYICglbHUpIFsweCVsWCAoJWx1KV1c
biIsCisJCQkJYXAsYXAsCisJCQkJY2hpcC0+Y2hhbm5lbFtjaGldLnN1YnN0cmVhbS0+cnVudGlt
ZS0+Y29udHJvbAorCQkJCQktPmFwcGxfcHRyLAorCQkJCWNoaXAtPmNoYW5uZWxbY2hpXS5zdWJz
dHJlYW0tPnJ1bnRpbWUtPmNvbnRyb2wKKwkJCQkJLT5hcHBsX3B0cik7CisKKwkJfQorCX0KK30K
Kworc3RhdGljIHZvaWQgc21hX3Byb2NfZGVidWdfcmVhZAorCShzbmRfaW5mb19lbnRyeV90ICpw
cm9jX2VudHJ5LCBzbmRfaW5mb19idWZmZXJfdCAqYnVmZmVyKQoreworCXNtYV9wcm9jX2RlYnVn
X3QgKmVudHJ5OworCisJc25kX2lwcmludGYoYnVmZmVyLCAiTUFDRSBBdWRpbyBkZWJ1ZyBpbmZv
LlxuIik7CisKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGVudHJ5LCAmc21hX3Byb2NfZGVidWdfbGlz
dCwgbGluaykgeworCisJCWlmIChOVUxMID09IGVudHJ5LT52YWxfc3RyKQorCQkJc25kX2lwcmlu
dGYoYnVmZmVyLCAiJXM6IFx0JWxkXG4iLAorCQkJCWVudHJ5LT5uYW1lLCBlbnRyeS0+dmFsX2lu
dCk7CisJCWVsc2UKKwkJCXNuZF9pcHJpbnRmKGJ1ZmZlciwgIiVzOiBcdCVzXG4iLAorCQkJCWVu
dHJ5LT5uYW1lLCBlbnRyeS0+dmFsX3N0cik7CisJfQorCit9CisKKy8qIHRoaXMgaXMgY2FsbGVk
IGluc2lkZSB0aGUgdm9sdW1lIGludGVycnVwdCwgYnV0IGlzIGl0IGFwcHJvcHJpYXRlCisgKiB0
byBiZSBhbGxvY2F0aW5nIG1lbW9yeSBkdXJpbmcgYW4gaW50ZXJydXB0PyAqLworc3RhdGljIHNt
YV9wcm9jX2RlYnVnX3QqIHNtYV9wcm9jX2RlYnVnX2FwcGVuZAorCShjaGFyICpuYW1lKQorewor
CXNtYV9wcm9jX2RlYnVnX3QgKmVudHJ5ID0KKwkJa3phbGxvYyhzaXplb2Yoc21hX3Byb2NfZGVi
dWdfdCksIEdGUF9BVE9NSUMpOworCisJZW50cnktPm5hbWUgPSBuYW1lOworCisJbGlzdF9hZGRf
dGFpbCgmZW50cnktPmxpbmssICZzbWFfcHJvY19kZWJ1Z19saXN0KTsKKworCXJldHVybiBlbnRy
eTsKKworfQorCitzdGF0aWMgaW50IHNtYV9wcm9jX2NyZWF0ZShzbmRfbWFjZV9hdWRpb190ICpj
aGlwKQoreworCWludCBlcnI7CisKKwllcnIgPSBzbmRfY2FyZF9wcm9jX25ldyhjaGlwLT5jYXJk
LCAiZGVidWciLCAmY2hpcC0+cHJvY19kZWJ1Zyk7CisJaWYgKDAgPiBlcnIpIHJldHVybiBlcnI7
CisKKwlzbmRfaW5mb19zZXRfdGV4dF9vcHMoY2hpcC0+cHJvY19kZWJ1ZywgY2hpcCwKKwkJc21h
X3Byb2NfZGVidWdfcmVhZCk7CisKKwllcnIgPSBzbmRfY2FyZF9wcm9jX25ldyhjaGlwLT5jYXJk
LCAiYWQxODQzIiwgJmNoaXAtPnByb2NfYWQxODQzKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVy
cjsKKworCXNuZF9pbmZvX3NldF90ZXh0X29wcyhjaGlwLT5wcm9jX2FkMTg0MywgY2hpcCwKKwkJ
c21hX3Byb2NfYWQxODQzX3JlYWQpOworCisJZXJyID0gc25kX2NhcmRfcHJvY19uZXcoY2hpcC0+
Y2FyZCwgIm1hY2UiLCAmY2hpcC0+cHJvY19tYWNlKTsKKwlpZiAoMCA+IGVycikgcmV0dXJuIGVy
cjsKKworCXNuZF9pbmZvX3NldF90ZXh0X29wcyhjaGlwLT5wcm9jX21hY2UsIGNoaXAsCisJCXNt
YV9wcm9jX21hY2VfcmVhZCk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiogQUxTQSBzZXR1cCAqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKwor
LyogY2hpcCBzcGVjaWZpYyBkZXN0cnVjdG9yICovCitzdGF0aWMgaW50IHNtYV9mcmVlKHNuZF9t
YWNlX2F1ZGlvX3QgKmNoaXApCit7CisJaW50IGlycTsKKworcHJpbnRrKCJzbWFfZnJlZSBjYWxs
ZWRcbiIpOworCisJLyogcmVzZXQgdGhlIGludGVyZmFjZSAqLworCXdyaXRlcShTTUFfQ1RSTF9S
RVNFVCwgJm1hY2UtPnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCXVkZWxheSgxKTsKKwl3cml0ZXEo
MEwsICZtYWNlLT5wZXJpZi5hdWRpby5jb250cm9sKTsKKworCS8qIHVuZG8gRE1BID8gKi8KKwlk
bWFfZnJlZV9jb2hlcmVudChOVUxMLCBNQUNFSVNBX1JJTkdCVUZGRVJTX1NJWkUgKyA2MiwKKwkJ
Y2hpcC0+cmluZ19iYXNlLCBjaGlwLT5yaW5nX2Jhc2VfaGFuZGxlKTsKKwkJCSAgIAorCS8qIHJl
bGVhc2UgSVJRJ3MgKi8KKwlmb3IgKGlycT1NQUNFSVNBX0FVRElPX1NXX0lSUTsgaXJxPD1NQUNF
SVNBX0FVRElPM19NRVJSX0lSUTsgaXJxKyspeworCQlmcmVlX2lycShpcnEsIGNoaXApOworCX0K
KworCS8qIHNodXRkb3duIHRoZSBhZDE4NDM/ICovCisKKworCS8qIGZyZWUgY29kZWMgc3RydWN0
Ki8KKwlrZnJlZShjaGlwLT5hZDE4NDMpOworCXNuZF9tYWNlX2F1ZGlvX2NoaXAgPSBOVUxMOwor
CisJcmV0dXJuIDA7Cit9CisKKy8qIGNoaXAgc3BlY2lmaWMgY29uc3RydWN0b3IgKi8KK3N0YXRp
YyBpbnQgX19kZXZpbml0IHNtYV9jcmVhdGUKKwkoc25kX2NhcmRfdCAqY2FyZCwgc25kX21hY2Vf
YXVkaW9fdCAqKnJjaGlwKQoreworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXA7CisJaW50IGVyciwg
aXJxOworCXVuc2lnbmVkIGxvbmcgbWFjZV9yZWcsIG1yaW5nYmFzZTsKKworCSpyY2hpcCA9IE5V
TEw7CisJY2hpcCA9IGNhcmQtPnByaXZhdGVfZGF0YTsKKwljaGlwLT5jYXJkID0gY2FyZDsKKwor
CS8qIERNQSByaW5nIGJ1ZmZlciAqLworCWNoaXAtPnJpbmdfYmFzZSA9IGRtYV9hbGxvY19jb2hl
cmVudCAoTlVMTCwKKwkJTUFDRUlTQV9SSU5HQlVGRkVSU19TSVpFICsgNjIsICZjaGlwLT5yaW5n
X2Jhc2VfaGFuZGxlLCBHRlBfVVNFUik7CisKKwllcnIgPSAoTlVMTCA9PSBjaGlwLT5yaW5nX2Jh
c2UpPy1FTk9NRU06MDsgLyogdWdseSAqLworCWlmICgwPiBlcnIpIGdvdG8gRVJST1JfRVhJVDsK
KworCS8qIHNldCByaW5nIGJhc2UgKi8KKwl3cml0ZXEoY2hpcC0+cmluZ19iYXNlX2hhbmRsZSwg
Jm1hY2UtPnBlcmlmLmN0cmwucmluZ2Jhc2UpOworCW1iKCk7CisKKwljaGlwLT5tYWNlaXNhX2Jh
c2UgPSByZWFkcSgmbWFjZS0+cGVyaWYuY3RybC5yaW5nYmFzZSk7CisJY2hpcC0+bWFjZV9vZmZz
ZXQgPSBjaGlwLT5tYWNlaXNhX2Jhc2UgLSBjaGlwLT5yaW5nX2Jhc2VfaGFuZGxlOworCS8qY2hp
cC0+cmluZ19iYXNlICs9IGNoaXAtPm1hY2Vfb2Zmc2V0OyovCisKK3ByaW50aygiYWxsb2NhdGVk
IHJpbmcgYmFzZS4gQ1BVIGFkZHI9MHglbFgsIEJ1cyBhZGRyPTB4JWxYXG4iCisJIlx0bWFjZWJh
c2U9MHglbFgsIG9mZnNldD0weCVsWFxuIiwKKwljaGlwLT5yaW5nX2Jhc2UsIGNoaXAtPnJpbmdf
YmFzZV9oYW5kbGUsCisJY2hpcC0+bWFjZWlzYV9iYXNlLCBjaGlwLT5tYWNlX29mZnNldCk7CisK
KwkvKiBBbGxvY2F0ZSBJUlFzICovCisJZm9yIChpcnE9TUFDRUlTQV9BVURJT19TV19JUlE7IGly
cTw9TUFDRUlTQV9BVURJTzNfTUVSUl9JUlE7IGlycSsrKXsKKwkJLypOT1RFIFdoYXQgZG9lcyBy
ZXFldXN0X2lycSByZXR1cm4/ICovCisJCWVyciA9IHJlcXVlc3RfaXJxKGlycSwKKwkJCShpcnFy
ZXR1cm5fdCgqKShpbnQsIHZvaWQqLCBzdHJ1Y3QgcHRfcmVncyopKQorCQkJCSZzbWFfaW50ZXJy
dXB0LAorCQkJU0FfSU5URVJSVVBUfFNBX1NISVJRLCAiTWFjZSBBdWRpbyIsIGNoaXApOworCQlp
ZiAoMCA+IGVycikgZ290byBFUlJPUl9FWElUOworCX0KKworCS8qIGNoZWNrIGlmIHRoZSBjb2Rl
YyBpcyBwcmVzZW50ICovCisJbWFjZV9yZWcgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29u
dHJvbCk7CisJZXJyID0gKG1hY2VfcmVnICYgU01BX0NUUkxfQ09ERUNfUFJFU0VOVCk+MD8gMCA6
IC1FTk9FTlQ7CisJaWYgKDAgPiBlcnIpIGdvdG8gRVJST1JfRVhJVDsKKworCS8qIHJlc2V0IHRo
ZSBpbnRlcmZhY2UgYW5kIGFkMTg0MyAqLworCXdyaXRlcShTTUFfQ1RSTF9SRVNFVCwgJm1hY2Ut
PnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCXVkZWxheSgxMDApOworCXdyaXRlcSgwTCwgJm1hY2Ut
PnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCisJLyogc3BpbiBsb2NrcyAqLworCXNwaW5fbG9ja19p
bml0KCZjaGlwLT5hZDE4NDNfbG9jayk7CisKKwkvKiBhZDE4NDMgc2V0dXAgKi8KKwljaGlwLT5h
ZDE4NDMgPSBrbWFsbG9jKHNpemVvZihhZDE4NDNfdCksIEdGUF9LRVJORUwpOworCWVyciA9IChO
VUxMID09IGNoaXAtPmFkMTg0Myk/LUVOT01FTTowOworCWlmICgwID4gZXJyKSBnb3RvIEVSUk9S
X0VYSVQ7CisKKwljaGlwLT5hZDE4NDMtPmNoaXAgPSAgY2hpcDsKKwljaGlwLT5hZDE4NDMtPnJl
YWQgPQorCQkoaW50KCopKHZvaWQqLCBpbnQpKSZtYWNlX2F1ZGlvX3JlZ19yZWFkOworCWNoaXAt
PmFkMTg0My0+d3JpdGUgPQorCQkoaW50KCopKHZvaWQqLCBpbnQsIGludCkpJm1hY2VfYXVkaW9f
cmVnX3dyaXRlOworCisJLyogYXQgbW8gd2UgZG9udCB3YW50IGFueSBjb2RlYyB1cGRhdGUgaXJx
cyAoU1cpICovCisJd3JpdGVxKDBMLCAmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfbWFzayk7CisK
KwllcnIgPSBhZDE4NDNfaW5pdChjaGlwLT5hZDE4NDMpOworCWlmICgwID4gZXJyKSBnb3RvIEVS
Uk9SX0VYSVQ7CisKKwkqcmNoaXAgPSBjaGlwOworCXNuZF9tYWNlX2F1ZGlvX2NoaXAgPSBjaGlw
OworCisJcmV0dXJuIDA7CisKK0VSUk9SX0VYSVQ6CisJc25kX3ByaW50ayhLRVJOX0VSUiAiQXR0
ZW1wIHRvIGluaXRpYWxpc2UgTUFDRSBBdWRpbyBmYWlsZWRcbiIpOworCXNtYV9mcmVlKGNoaXAp
OworCXJldHVybiBlcnI7Cit9CisKKy8qIGNvbnN0cnVjdGVyICovCitzdGF0aWMgaW50IF9fZGV2
aW5pdCBzbWFfcHJvYmUodm9pZCkKK3sKKwlzbmRfY2FyZF90ICAgICAgKmNhcmQ7CisJc25kX21h
Y2VfYXVkaW9fdCAqY2hpcDsKKwlpbnQgZXJyOworCisJLyogY3JlYXRlIGFsc2Egc3R1ZmYqLwor
CWNhcmQgPSBzbmRfY2FyZF9uZXcoYWxzYV9pbmRleCwgYWxzYV9pZCwKKwkJVEhJU19NT0RVTEUs
IHNpemVvZihzbmRfbWFjZV9hdWRpb190KSk7CisJaWYgKE5VTEwgPT0gY2FyZCkgcmV0dXJuIC1F
Tk9NRU07CisKKwkvKiBzdXR1cCBvdXIgc3R1ZmYqLworCWVyciA9IHNtYV9jcmVhdGUoY2FyZCwg
JmNoaXApOworCWlmICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkvKiB0ZWxsIHRoZSB3
b3JsZCB3aG8gd2UgYXJlICovCisJc3RyY3B5KGNhcmQtPmRyaXZlciwgIlNHSSBPMiBNQUNFIEF1
ZGlvIERpcnZlciIpOworCXN0cmNweShjYXJkLT5zaG9ydG5hbWUsICJNQUNFIEF1ZGlvIik7CisJ
c3ByaW50ZihjYXJkLT5sb25nbmFtZSwgIiVzIiwKKwkJY2FyZC0+c2hvcnRuYW1lICk7CisKKwkv
KiBhdHRhY2ggb3VyIGJpdHMnbidib2JzICovCisJZXJyID0gc21hX3BjbV9uZXcoY2hpcCk7CisJ
aWYgKDAgPiBlcnIpIGdvdG8gRVJST1JfRVhJVDsKKworCWVyciA9IHNtYV9jb250cm9sX25ldyhj
aGlwKTsKKwlpZiAoMCA+IGVycikgZ290byBFUlJPUl9FWElUOworCisJZXJyID0gc21hX3Byb2Nf
Y3JlYXRlKGNoaXApOworCWlmICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkvKiBhbmQg
d2UncmUgZG9uZSAqLworCWVyciA9IHNuZF9jYXJkX3JlZ2lzdGVyKGNhcmQpOworCWlmICgwID4g
ZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwlyZXR1cm4gMDsKK0VSUk9SX0VYSVQ6CisJc25kX3By
aW50ayhLRVJOX0VSUiAiUHJvYmUgZm9yIE1BQ0UgQXVkaW8gZmFpbGVkXG4iKTsKKwlzbmRfY2Fy
ZF9mcmVlKGNhcmQpOworCisJcmV0dXJuIGVycjsKK30KKworLyoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqIE1BQ0UgYWNjZXNzICoqKioqKioqKioqKioqKioqKioqKioqKioqKi8KK3N0YXRp
YyBpbnQgbWFjZV9hdWRpb19yZWdfcmVhZChzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQgcmVn
KQoreworCWludCB2YWw7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwl1bnNpZ25lZCBpbnQgY2hl
Y2s7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZsYWdzKTsKKwl3
cml0ZXEoU01BX0NPREVDX1JFQUQocmVnKSwKKwkJJm1hY2UtPnBlcmlmLmF1ZGlvLmNvZGVjX2Nv
bnRyb2wpOworCW1iKCk7CisJdWRlbGF5KDIwMCk7CisKKwljaGVjayA9IHJlYWRxKCZtYWNlLT5w
ZXJpZi5hdWRpby5jb2RlY19jb250cm9sKTsgLyogZmx1c2ggYnVzICovCisJaWYgKHVubGlrZWx5
KChTTUFfQ09ERUNfUkVBRChyZWcpKSAhPSBjaGVjaykpCisJCXByaW50aygiTUFDRSBBdWRpbyBy
ZWcgcmVhZCBoaWMtdXAgc2VudCAlbFgsIGdvdCAlWFxuIiwKKwkJCShTTUFfQ09ERUNfUkVBRChy
ZWcpKSwgY2hlY2spOworCisJdmFsID0gKGludClyZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29k
ZWNfcmVhZCk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjaGlwLT5hZDE4NDNfbG9jaywg
ZmxhZ3MpOworCisJcmV0dXJuIHZhbDsKK30KKworc3RhdGljIGludCBtYWNlX2F1ZGlvX3JlZ193
cml0ZShzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQgcmVnLCBpbnQgd29yZCkKK3sKKwl1bnNp
Z25lZCBsb25nIGZsYWdzOworCXVuc2lnbmVkIGludCBjaGVjazsKKworCXNwaW5fbG9ja19pcnFz
YXZlKCZjaGlwLT5hZDE4NDNfbG9jaywgZmxhZ3MpOworCisJd3JpdGVxKFNNQV9DT0RFQ19XUklU
RShyZWcsIHdvcmQpLAorCQkmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfY29udHJvbCk7CisJbWIo
KTsKKworCXVkZWxheSgyMDApOworCisJY2hlY2sgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8u
Y29kZWNfY29udHJvbCk7IC8qIGZsdXNoIGJ1cyAqLworCWlmICh1bmxpa2VseSgoU01BX0NPREVD
X1dSSVRFKHJlZywgd29yZCkpICE9IGNoZWNrKSkKKwkJcHJpbnRrKCJNQUNFIEF1ZGlvIHJlZyB3
cml0ZSBoaWMtdXAgc2VudCAlbFgsIGdvdCAlWFxuIiwKKwkJCShTTUFfQ09ERUNfV1JJVEUocmVn
LCB3b3JkKSksIGNoZWNrKTsKKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNoaXAtPmFkMTg0
M19sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqKioqKioqKioqKioqKioqKioq
KioqIG1vZHVsZSBzZXR1cCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisKK3N0YXRp
YyBpbnQgX19pbml0IHNuZF9jYXJkX21hY2VfYXVkaW9faW5pdCh2b2lkKQoreworCWludCBlcnI7
CisKKwllcnIgPSBzbWFfcHJvYmUoKTsKKwlpZiAoMCA+IGVycikgZ290byBFUlJPUl9FWElUOwor
CisJcmV0dXJuIDA7CitFUlJPUl9FWElUOgorI2lmZGVmIE1PRFVMRQorCXByaW50ayhLRVJOX0VS
UiAiTWFjZSBBdWRpbyBub3QgZm91bmQgb3IgZGV2aWNlIGJ1c3lcbiIpOworI2VuZGlmCisJcmV0
dXJuIGVycjsKK30KKworc3RhdGljIHZvaWQgX19leGl0IHNuZF9jYXJkX21hY2VfYXVkaW9fZXhp
dCh2b2lkKQoreworCWlmIChOVUxMICE9IHNuZF9tYWNlX2F1ZGlvX2NoaXApIHsKKwkJc25kX2Nh
cmRfdCAqY2FyZCA9IHNuZF9tYWNlX2F1ZGlvX2NoaXAtPmNhcmQ7CisJCXNtYV9mcmVlKHNuZF9t
YWNlX2F1ZGlvX2NoaXApOworCQlzbmRfY2FyZF9mcmVlKGNhcmQpOworCX0KK30KKworTU9EVUxF
X0FVVEhPUigiVGhvcmJlbiBKw6RuZGxpbmcgPHRqLnRyZXZlbHlhbkBnbWFpbC5jb20+Iik7CitN
T0RVTEVfREVTQ1JJUFRJT04oIlNHSSBPMiBNQUNFIEF1ZGlvIik7CitNT0RVTEVfTElDRU5TRSgi
R1BMIik7CitNT0RVTEVfU1VQUE9SVEVEX0RFVklDRSgie3tTaWxpY29uIEdyYXBoaWNzLCBPMiBN
QUNFIEF1ZGlvfX0iKTsKKworbW9kdWxlX3BhcmFtKGFsc2FfaW5kZXgsIGludCwgMDQ0NCk7CitN
T0RVTEVfUEFSTV9ERVNDKGFsc2FfaW5kZXgsICJJbmRleCB2YWx1ZSBmb3IgTUFDRSBBdWRpbyIp
OworbW9kdWxlX3BhcmFtKGFsc2FfaWQsIGNoYXJwLCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0Mo
YWxzYV9pZCwgIklEIHN0cmluZyBmb3IgTUFDRSBBdWRpbyIpOworbW9kdWxlX3BhcmFtKGFsc2Ff
ZW5hYmxlLCBib29sLCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoYWxzYV9lbmFibGUsICJFbmFi
bGUgTUFDRSBBdWRpbyIpOworCittb2R1bGVfaW5pdChzbmRfY2FyZF9tYWNlX2F1ZGlvX2luaXQp
Cittb2R1bGVfZXhpdChzbmRfY2FyZF9tYWNlX2F1ZGlvX2V4aXQpCisKCi0tLSBsaW51eC0yLjYu
MTkuNy1vcmlnaW5hbC9zb3VuZC9taXBzL21hY2VfYXVkaW9fc3B5LmMJMTk3MC0wMS0wMSAwMTow
MDowMC4wMDAwMDAwMDAgKzAxMDAKKysrIGxpbnV4LTIuNi4xOS43L3NvdW5kL21pcHMvbWFjZV9h
dWRpb19zcHkuYwkyMDA3LTA2LTI4IDEwOjQ2OjI0LjAwMDAwMDAwMCArMDEwMApAQCAtMCwwICsx
LDUyNCBAQAorLyoKKyAqICAgU291bmQgZHJpdmVyIGZvciBTaWxpY29uIEdyYXBoaWNzIE8yIFdv
cmtzdGF0aW9ucyBNQUNFIGF1ZGlvIGJvYXJkLgorICoKKyAqICAgQ29weXJpZ2h0IDIwMDcgVGhv
cmJlbiBKw6RuZGxpbmcgPHRqLnRyZXZlbHlhbkBnbWFpbC5jb20+CisgKiAgIEJhc2VkL0NvcGll
ZCBoZWF2aWx5IG9uL2Zyb20gc2dpbzJhdWRpby5jOgorICogICBDb3B5cmlnaHQgMjAwMyBWaXZp
ZW4gQ2hhcHBlbGllciA8dml2aWVuLmNoYXBwZWxpZXJAbGludXgtbWlwcy5vcmc+CisgKgorICog
ICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQorICogICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogICB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAoYXQg
eW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqICAgVGhpcyBwcm9ncmFtIGlz
IGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgIGJ1
dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCisgKiAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVS
UE9TRS4gIFNlZSB0aGUKKyAqICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUg
ZGV0YWlscy4KKyAqCisgKiAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAgIEZvdW5kYXRpb24sIElu
Yy4sIDU5IFRlbXBsZSBQbGFjZSwgU3VpdGUgMzMwLCBCb3N0b24sIE1BICAwMjExMS0xMzA3IFVT
QQorICoKKyAqLworCisvKgorICogVG8gc25vb3AgYXQgdGhlIHN0YXRlIG1hY2UgYXVkaW8gaXMg
aW4gYWZ0ZXIgaGUgQVJDUyBqaW5nbGUKKyAqCisgKi8KKworCisvKioqKioqKioqKioqKioqKioq
KioqKioqKioqIGluY2x1ZGUgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisjaW5j
bHVkZSA8c291bmQvZHJpdmVyLmg+CisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1ZGUg
PGxpbnV4L3dhaXQuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4
L3NwaW5sb2NrLmg+CisjaW5jbHVkZSA8bGludXgvZ2ZwLmg+CisjaW5jbHVkZSA8bGludXgvdm1h
bGxvYy5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4L3Bj
aS5oPgorI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGlu
Zy5oPgorI2luY2x1ZGUgPGFzbS9pby5oPgorCisjaW5jbHVkZSA8YXNtL2lwMzIvaXAzMl9pbnRz
Lmg+CisjaW5jbHVkZSA8YXNtL2lwMzIvbWFjZS5oPgorCisjaW5jbHVkZSA8c291bmQvY29yZS5o
PgorI2luY2x1ZGUgPHNvdW5kL2luaXR2YWwuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb250cm9sLmg+
CisjaW5jbHVkZSA8c291bmQvcGNtLmg+CisjaW5jbHVkZSA8c291bmQvaW5pdHZhbC5oPgorI2lu
Y2x1ZGUgPHNvdW5kL2luZm8uaD4KKworI2luY2x1ZGUgPHNvdW5kL2FkMTg0My5oPgorCisvKioq
KioqKioqKioqKioqKioqKioqKioqKioqKiBkZWZpbmVzICoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKiovCisKKy8qIDE6IHJlc2V0IGF1ZGlvIGludGVyZmFjZSAqLworI2RlZmluZSBTTUFf
Q1RSTF9SRVNFVCAgICAgICAgICAweDFVTAorLyogMTogY29kZWMgZGV0ZWN0ZWQgKi8KKyNkZWZp
bmUgU01BX0NUUkxfQ09ERUNfUFJFU0VOVCAgMHgyVUwKKy8qICAyLTggIDogY2hhbm5lbCAxIHdy
aXRlIHB0ciBhbGlhcyAqLworLyogIDktMTUgOiBjaGFubmVsIDIgcmVhZCBwdHIgYWxpYXMgKi8K
Ky8qIDE2LTIyIDogY2hhbm5lbCAzIHJlYWQgcHRyIGFsaWFzICovCisvKiBsYXRjaGVkIHZvbHVt
ZSBidXR0b24gKi8KKyNkZWZpbmUgU01BX0NUUkxfVk9MX0JVVFRPTl9VUCAgIEJJVCgyNCkKKy8q
IGxhdGNoZWQgdm9sdW1lIGJ1dHRvbiAqLworI2RlZmluZSBTTUFfQ1RSTF9WT0xfQlVUVE9OX0RP
V04gQklUKDIzKQorCisjZGVmaW5lIFNNQV9DT0RFQ19SRUFEKHJlZykgICgocmVnKSA8PDE3KSB8
IDB4MDAwMTAwMDBVTAorI2RlZmluZSBTTUFfQ09ERUNfV1JJVEUocmVnLCB2YWwpICgoKHJlZykg
PDwxNyl8KHZhbCkpICYgMHgwMEZFRkZGRlVMCisKKyNkZWZpbmUgU01BX1JJTkdfT0ZGU0VUKGNo
aSkgKChjaGkpIDw8IDEyKQorI2RlZmluZSBTTUFfUklOR19TSVpFIDB4MTAwMAorI2RlZmluZSBT
TUFfUklOR19NQVNLIDB4MEZGRlVMCisKKy8qIGludCBvbiBidWZmZXIgPjUwJSBmdWxsICovCisj
ZGVmaW5lIFNNQV9JTlRfVEhSRVNIT0xEXzUwICgyIDw8IDUpCisvKiAxOiBlbmFibGUgRE1BIHRy
YW5zZmVyICovCisjZGVmaW5lIFNNQV9ETUFfRU5BQkxFICAgQklUKDkpCisKKy8qb2xkLCBkZWZp
bmUgc3RpbGwgaW5oZXJ0ZWQgZnJvbSBzZ2lvMmF1ZGlvKi8KKworI2RlZmluZSBTTUFfQ1RSTF9D
SEFOX1JFU0VUIEJJVCgxMCkgLyogMTogcmVzZXQgY2hhbm5lbCAqLworCisjZGVmaW5lIFNNQV9J
TlRfVEhSRVNIT0xEX0RJU0FCTEVEICAoMCA8PCA1KSAvKiBpbnRlcnJ1cHQgZGlzYWJsZWQgKi8K
KyNkZWZpbmUgU01BX0lOVF9USFJFU0hPTERfMjUgKDEgPDwgNSkgLyogaW50IG9uIGJ1ZmZlciA+
MjUlIGZ1bGwgKi8KKyNkZWZpbmUgU01BX0lOVF9USFJFU0hPTERfNzUgKDMgPDwgNSkgLyogaW50
IG9uIGJ1ZmZlciA+NzUlIGZ1bGwgKi8KKyNkZWZpbmUgU01BX0lOVF9USFJFU0hPTERfRU1QVFkg
ICAgICg0IDw8IDUpIC8qIGludCBvbiBidWZmZXIgZW1wdHkgKi8KKyNkZWZpbmUgU01BX0lOVF9U
SFJFU0hPTERfTk9UX0VNUFRZICg1IDw8IDUpIC8qIGludCBvbiBidWZmZXIgIWVtcHR5ICovCisj
ZGVmaW5lIFNNQV9JTlRfVEhSRVNIT0xEX0ZVTEwgICAgICAoNiA8PCA1KSAvKiBpbnQgb24gYnVm
ZmVyIGVtcHR5ICovCisjZGVmaW5lIFNNQV9JTlRfVEhSRVNIT0xEX05PVF9GVUxMICAoNyA8PCA1
KSAvKiBpbnQgb24gYnVmZmVyICFlbXB0eSAqLworCisvKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqIHN0cnVjdHMvdHlwZXMgKioqKioqKioqKioqKioqKioqKioqKiovCisKKy8qIGNoaXAg
c3BlY2lmaWMgcmVjb3JkICovCit0eXBlZGVmIHN0cnVjdCBzbmRfbWFjZV9hdWRpbyB7CisJc25k
X2NhcmRfdCAqY2FyZDsKKwlzbmRfcGNtX3QgICpwY21bMl07CisKKwlzdHJ1Y3QgeworCQlzbmRf
cGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW07CisJCXNuZF9wY21fdWZyYW1lc190ICAgICAgICBm
cmFtZXM7CisKKwkJaW50ICAgICAgICAgICAgICAgICAgYWNrOworCQl2b2lkICAgICAgICAgICAg
ICAgICpidWZmZXI7CisJCXU2NCAgICAgICAgICAgICAgICAgIHBvczsKKwkJc3BpbmxvY2tfdCAg
ICAgICAgICAgbG9jazsKKwl9IGNoYW5uZWxbM107CisKKwkvKiB3aGljaCBnYWluIHNob3VsZCB0
aGUgTzIgdm9sIGJ1dG9ucyBjb250cm9sPyovCisJdW5zaWduZWQgaW50IGV4dF92b2xfZm9yOwor
CisJc25kX2luZm9fZW50cnlfdCAgKnByb2NfZGVidWcsCisJICAgICAgICAgICAgICAgICAgKnBy
b2NfYWQxODQzLAorCSAgICAgICAgICAgICAgICAgICpwcm9jX21hY2U7CisKKwlhZDE4NDNfdCAg
ICphZDE4NDM7CisJc3BpbmxvY2tfdCBhZDE4NDNfbG9jazsKKworCXZvaWQgICAgICAgICpyaW5n
X2Jhc2U7CisJZG1hX2FkZHJfdCAgIHJpbmdfYmFzZV9oYW5kbGU7CisJdW5zaWduZWQgbG9uZyBt
YWNlaXNhX2Jhc2U7CisJdW5zaWduZWQgaW50IG1hY2Vfb2Zmc2V0OworCit9IHNuZF9tYWNlX2F1
ZGlvX3Q7CisKK3R5cGVkZWYgc3RydWN0IHNtYV9wcm9jX2RlYnVnIHsKKwlzdHJ1Y3QgbGlzdF9o
ZWFkIGxpbms7CisKKy8qIG5hbWUgdG8gZGlzcGxheSBmb3IgdGhlIGVudHJ5ICovCisJY2hhciAg
Km5hbWU7CisKKy8qIGEgc3RyaW5nIHZhbHVlICovCisJY2hhciAgKnZhbF9zdHI7CisKKy8qIGFu
IGludCB2YWwgdXNlZCBpZiB2YWxfc3RyIGlzIG51bGwgKi8KKwlsb25nIHZhbF9pbnQ7Cit9IHNt
YV9wcm9jX2RlYnVnX3Q7CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKiBmdW5jIGRlY2xh
cmF0aW9uICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisvKiBtYWNlIGFjY2VzcyAqLwor
c3RhdGljIGludCBtYWNlX2F1ZGlvX3JlZ19yZWFkKHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIGlu
dCByZWcpOworc3RhdGljIGludCBtYWNlX2F1ZGlvX3JlZ193cml0ZShzbmRfbWFjZV9hdWRpb190
ICpjaGlwLCBpbnQgcmVnLCBpbnQgd29yZCk7CisvKiBwcm9jICovCitzdGF0aWMgdm9pZCBzbWFf
cHJvY19hZDE4NDNfcmVhZAorCShzbmRfaW5mb19lbnRyeV90ICpwcm9jX2VudHJ5LCBzbmRfaW5m
b19idWZmZXJfdCAqYnVmZmVyKTsKK3N0YXRpYyB2b2lkIHNtYV9wcm9jX21hY2VfcmVhZAorCShz
bmRfaW5mb19lbnRyeV90ICpwcm9jX2VudHJ5LCBzbmRfaW5mb19idWZmZXJfdCAqYnVmZmVyKTsK
K3N0YXRpYyB2b2lkIHNtYV9wcm9jX2RlYnVnX3JlYWQKKwkoc25kX2luZm9fZW50cnlfdCAqLCBz
bmRfaW5mb19idWZmZXJfdCAqKTsKK3N0YXRpYyBzbWFfcHJvY19kZWJ1Z190KiBzbWFfcHJvY19k
ZWJ1Z19hcHBlbmQoY2hhciAqbmFtZSk7CitzdGF0aWMgaW50IHNtYV9wcm9jX2NyZWF0ZShzbmRf
bWFjZV9hdWRpb190ICpjaGlwKTsKKy8qIEFMU0EgU2V0dXAgKi8KK3N0YXRpYyBpbnQgc21hX2Zy
ZWUoc25kX21hY2VfYXVkaW9fdCAqY2hpcCk7CitzdGF0aWMgaW50IF9fZGV2aW5pdCBzbWFfY3Jl
YXRlCisJKHNuZF9jYXJkX3QgKmNhcmQsIHNuZF9tYWNlX2F1ZGlvX3QgKipyY2hpcCk7CitzdGF0
aWMgaW50IF9fZGV2aW5pdCBzbWFfcHJvYmUodm9pZCk7CisvKiBtb2R1bGUgc2V0dXAgKi8KK3N0
YXRpYyBpbnQgX19pbml0IHNuZF9jYXJkX21hY2VfYXVkaW9faW5pdCh2b2lkKTsKK3N0YXRpYyB2
b2lkIF9fZXhpdCBzbmRfY2FyZF9tYWNlX2F1ZGlvX2V4aXQodm9pZCk7CisKKworLyoqKioqKioq
KioqKioqKioqKioqKioqKiogZGVmaW5lIHBzdWRvLWZ1bmNzICoqKioqKioqKioqKioqKioqKioq
KioqKioqKi8KKyNkZWZpbmUgc21hX3Byb2NfZW50cnlfYXNzZXJ0KGVudHJ5LG5hbWUpIFwKKwlp
ZiAoTlVMTCA9PSBlbnRyeSkgZW50cnkgPSBzbWFfcHJvY19lbnRyeV9hcHBlbmQobmFtZSk7CisK
Ky8qIHBjbTAgc3Vic3RyZWFtMCA9IGNoYW5uZWwgMQorICogcGNtMCBzdWJzdHJlYW0xID0gY2hh
bm5lbCAwCisgKiBwY20xIHN1YnN0cmVhbTAgPSBjaGFubmVsIDIKKyAqLworI2RlZmluZSBzdWJz
dHJlYW1fdG9fY2hhbm5lbF9pbmRleChzdWJzdHJlYW0pIFwKKyAoKCgoc25kX21hY2VfYXVkaW9f
dCopKHN1YnN0cmVhbS0+cHJpdmF0ZV9kYXRhKSktPnBjbVswXT09c3Vic3RyZWFtLT5wY20pXAor
ID8hKHN1YnN0cmVhbS0+bnVtYmVyKToyKQorCisvKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKiogZ2xvYmFscyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisKK0xJU1Rf
SEVBRChzbWFfcHJvY19kZWJ1Z19saXN0KTsKKworc3RhdGljIGludCAgIGFsc2FfaW5kZXggPSAt
MTsKK3N0YXRpYyBjaGFyICphbHNhX2lkICAgID0gTlVMTDsKK3N0YXRpYyBpbnQgICBhbHNhX2Vu
YWJsZT0gMTsKK3N0YXRpYyBpbnQgICBzbWFfaW5kaXJlY3QgPSAxOworCisvKiBHbG9iYWwgbmVl
ZGVkIGZvciBtb2R1bGUgZXhpdCAqLworc25kX21hY2VfYXVkaW9fdCAqc25kX21hY2VfYXVkaW9f
Y2hpcCA9IE5VTEw7CisKKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBQcm9jIGZp
bGVzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCitzdGF0aWMgdm9pZCBzbWFf
cHJvY19hZDE4NDNfcmVhZAorCShzbmRfaW5mb19lbnRyeV90ICpwcm9jX2VudHJ5LCBzbmRfaW5m
b19idWZmZXJfdCAqYnVmZmVyKQoreworCWludCBpOworCWNoYXIgKnN0cjsKKwlzbmRfbWFjZV9h
dWRpb190ICpjaGlwID0gcHJvY19lbnRyeS0+cHJpdmF0ZV9kYXRhOworCisJc25kX2lwcmludGYo
YnVmZmVyLAorCQkifCAgMTUvNyAgIHwgIDE0LzYgICB8ICAxMy81ICAgfCAgMTIvNCAgICIKKwkJ
InwgIDExLzMgICB8ICAxMC8yICAgfCAgIDkvMSAgIHwgICA4LzAgICB8XG4iKTsKKworCWZvciAo
aT0wOyBpPDMyOyBpKyspeworCisJCXN0ciA9IGFkMTg0M19kdW1wX3JlZyhjaGlwLT5hZDE4NDMs
IGkpOworCQlpZiAoTlVMTCA9PSBzdHIpIGNvbnRpbnVlOworCisJCXNuZF9pcHJpbnRmKGJ1ZmZl
ciwgc3RyKTsKKworCQl2ZnJlZShzdHIpOworCX0KKworfQorCitzdGF0aWMgdm9pZCBzbWFfcHJv
Y19tYWNlX3JlYWQKKwkoc25kX2luZm9fZW50cnlfdCAqcHJvY19lbnRyeSwgc25kX2luZm9fYnVm
ZmVyX3QgKmJ1ZmZlcikKK3sKKwlzbmRfbWFjZV9hdWRpb190ICpjaGlwID0gcHJvY19lbnRyeS0+
cHJpdmF0ZV9kYXRhOworCXVuc2lnbmVkIGxvbmcgcix3LGMsZDsKKwlpbnQgY2hpOworCisJbWIo
KTsKKwlyID0gcmVhZHEoJm1hY2UtPnBlcmlmLmN0cmwucmluZ2Jhc2UpOworCXNuZF9pcHJpbnRm
KGJ1ZmZlciwgIk1BQ0UgUGVyaWZlcmFscyBSaW5nYmFzZTogMHglbFggKCVsdSlcbiIKKwkJIlx0
KENQVSBBZGRyZXNzOiAweCVsWCAoJWx1KSwgU2V0IEJ1cyBBZGRyZXNzOiAweCVsWCAoJWx1KSlc
biIsCisJCSh1bnNpZ25lZCBsb25nKXIsICh1bnNpZ25lZCBsb25nKXIsCisJCSh1bnNpZ25lZCBs
b25nKWNoaXAtPnJpbmdfYmFzZSwgKHVuc2lnbmVkIGxvbmcpY2hpcC0+cmluZ19iYXNlLAorCQlj
aGlwLT5yaW5nX2Jhc2VfaGFuZGxlLCBjaGlwLT5yaW5nX2Jhc2VfaGFuZGxlKTsKKworCWMgPSBy
ZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29udHJvbCk7CisJc25kX2lwcmludGYoYnVmZmVyLCAi
TUFDRSBBdWRpbyBDb250cm9sOiAweCVsWCAoJWx1KVxuIiwgYywgYyk7CisKKwljID0gcmVhZHEo
Jm1hY2UtPnBlcmlmLmF1ZGlvLmNvZGVjX2NvbnRyb2wpOworCXNuZF9pcHJpbnRmKGJ1ZmZlciwg
Ik1BQ0UgQXVkaW8gQ29kZWMgU3RhdHVzIENvbnRyb2w6IDB4JWxYICglbHUpXG4iLCBjLCBjKTsK
KworCWQgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfbWFzayk7CisJc25kX2lwcmlu
dGYoYnVmZmVyLCAiTUFDRSBBdWRpbyBDb2RlYyBTdGF0dXMgSVJRIE1hc2s6IDB4JWxYICglbHUp
XG4iLCBkLCBkKTsKKworCXIgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfcmVhZCk7
CisJc25kX2lwcmludGYoYnVmZmVyLCAiTUFDRSBBdWRpbyBDb2RlYyBTdGF0dXMgVmFsdWU6IDB4
JWxYICglbHUpXG4iLCByLCByKTsKKworCWZvciAoY2hpPTA7IGNoaTwzOyBjaGkrKykgeworCisJ
CW1iKCk7CisJCWMgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLmNvbnRyb2wp
OworCQlyID0gcmVhZHEoJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5yZWFkX3B0cik7CisJ
CXcgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisJCWQg
PSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLmRlcHRoKTsKKworCQlzbmRfaXBy
aW50ZihidWZmZXIsICJNQUNFIEF1ZGlvIENoYW5uZWwgJXU6LVxuIgorCQkJIlx0Q29udHJvbDog
MHglbFggKCVsdSlcbiIKKwkJCSJcdFJlYWQgUG9pbnRlcjogMHglbFggKCVsdSlcbiIKKwkJCSJc
dFdyaXRlIFBvaW50ZXI6IDB4JWxYICglbHUpXG4iCisJCQkiXHREZXB0aDogMHglbFggKCVsdSlc
biIsCisJCQljaGksIGMsIGMsIHIsIHIsIHcsIHcsIGQsIGQpOworCisJCWlmIChjaGlwLT5jaGFu
bmVsW2NoaV0uc3Vic3RyZWFtICYmCisJCSAgICBjaGlwLT5jaGFubmVsW2NoaV0uc3Vic3RyZWFt
LT5ydW50aW1lICkgeworCQkJdW5zaWduZWQgbG9uZyBhcCA9IGZyYW1lc190b19ieXRlcygKKwkJ
CQljaGlwLT5jaGFubmVsW2NoaV0uc3Vic3RyZWFtLT5ydW50aW1lLAorCQkJCWNoaXAtPmNoYW5u
ZWxbY2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWUtPmNvbnRyb2wKKwkJCQkJLT5hcHBsX3B0cik7CisK
KworCQkJc25kX2lwcmludGYoYnVmZmVyLCAiXHRBTFNBIFJ1bnRpbWUgRE1BIGFyZWE6IDB4JWxY
ICglbHUpXG4iLAorCQkJCWNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWUtPmRt
YV9hcmVhLAorCQkJCWNoaXAtPmNoYW5uZWxbY2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9h
cmVhKTsKKworCQkJc25kX2lwcmludGYoYnVmZmVyLCAiXHRBTFNBIEFwcCBQb2ludGVyOiAweCVs
WCAoJWx1KSBbMHglbFggKCVsdSldXG4iLAorCQkJCWFwLGFwLAorCQkJCWNoaXAtPmNoYW5uZWxb
Y2hpXS5zdWJzdHJlYW0tPnJ1bnRpbWUtPmNvbnRyb2wKKwkJCQkJLT5hcHBsX3B0ciwKKwkJCQlj
aGlwLT5jaGFubmVsW2NoaV0uc3Vic3RyZWFtLT5ydW50aW1lLT5jb250cm9sCisJCQkJCS0+YXBw
bF9wdHIpOworCisJCX0KKwl9Cit9CisKK3N0YXRpYyB2b2lkIHNtYV9wcm9jX2RlYnVnX3JlYWQK
Kwkoc25kX2luZm9fZW50cnlfdCAqcHJvY19lbnRyeSwgc25kX2luZm9fYnVmZmVyX3QgKmJ1ZmZl
cikKK3sKKwlzbWFfcHJvY19kZWJ1Z190ICplbnRyeTsKKworCXNuZF9pcHJpbnRmKGJ1ZmZlciwg
Ik1BQ0UgQXVkaW8gZGVidWcgaW5mby5cbiIpOworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRy
eSwgJnNtYV9wcm9jX2RlYnVnX2xpc3QsIGxpbmspIHsKKworCQlpZiAoTlVMTCA9PSBlbnRyeS0+
dmFsX3N0cikKKwkJCXNuZF9pcHJpbnRmKGJ1ZmZlciwgIiVzOiBcdCVsZFxuIiwKKwkJCQllbnRy
eS0+bmFtZSwgZW50cnktPnZhbF9pbnQpOworCQllbHNlCisJCQlzbmRfaXByaW50ZihidWZmZXIs
ICIlczogXHQlc1xuIiwKKwkJCQllbnRyeS0+bmFtZSwgZW50cnktPnZhbF9zdHIpOworCX0KKwor
fQorCisvKiB0aGlzIGlzIGNhbGxlZCBpbnNpZGUgdGhlIHZvbHVtZSBpbnRlcnJ1cHQsIGJ1dCBp
cyBpdCBhcHByb3ByaWF0ZQorICogdG8gYmUgYWxsb2NhdGluZyBtZW1vcnkgZHVyaW5nIGFuIGlu
dGVycnVwdD8gKi8KK3N0YXRpYyBzbWFfcHJvY19kZWJ1Z190KiBzbWFfcHJvY19kZWJ1Z19hcHBl
bmQKKwkoY2hhciAqbmFtZSkKK3sKKwlzbWFfcHJvY19kZWJ1Z190ICplbnRyeSA9CisJCWt6YWxs
b2Moc2l6ZW9mKHNtYV9wcm9jX2RlYnVnX3QpLCBHRlBfQVRPTUlDKTsKKworCWVudHJ5LT5uYW1l
ID0gbmFtZTsKKworCWxpc3RfYWRkX3RhaWwoJmVudHJ5LT5saW5rLCAmc21hX3Byb2NfZGVidWdf
bGlzdCk7CisKKwlyZXR1cm4gZW50cnk7CisKK30KKworc3RhdGljIGludCBzbWFfcHJvY19jcmVh
dGUoc25kX21hY2VfYXVkaW9fdCAqY2hpcCkKK3sKKwlpbnQgZXJyOworCisJZXJyID0gc25kX2Nh
cmRfcHJvY19uZXcoY2hpcC0+Y2FyZCwgImRlYnVnIiwgJmNoaXAtPnByb2NfZGVidWcpOworCWlm
ICgwID4gZXJyKSByZXR1cm4gZXJyOworCisJc25kX2luZm9fc2V0X3RleHRfb3BzKGNoaXAtPnBy
b2NfZGVidWcsIGNoaXAsCisJCXNtYV9wcm9jX2RlYnVnX3JlYWQpOworCisJZXJyID0gc25kX2Nh
cmRfcHJvY19uZXcoY2hpcC0+Y2FyZCwgImFkMTg0MyIsICZjaGlwLT5wcm9jX2FkMTg0Myk7CisJ
aWYgKDAgPiBlcnIpIHJldHVybiBlcnI7CisKKwlzbmRfaW5mb19zZXRfdGV4dF9vcHMoY2hpcC0+
cHJvY19hZDE4NDMsIGNoaXAsCisJCXNtYV9wcm9jX2FkMTg0M19yZWFkKTsKKworCWVyciA9IHNu
ZF9jYXJkX3Byb2NfbmV3KGNoaXAtPmNhcmQsICJtYWNlIiwgJmNoaXAtPnByb2NfbWFjZSk7CisJ
aWYgKDAgPiBlcnIpIHJldHVybiBlcnI7CisKKwlzbmRfaW5mb19zZXRfdGV4dF9vcHMoY2hpcC0+
cHJvY19tYWNlLCBjaGlwLAorCQlzbWFfcHJvY19tYWNlX3JlYWQpOworCisJcmV0dXJuIDA7Cit9
CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEFMU0Egc2V0dXAgKioqKioqKioq
KioqKioqKioqKioqKioqKiovCisKKy8qIGNoaXAgc3BlY2lmaWMgZGVzdHJ1Y3RvciAqLworc3Rh
dGljIGludCBzbWFfZnJlZShzbmRfbWFjZV9hdWRpb190ICpjaGlwKQoreworCWludCBpcnE7CisK
K3ByaW50aygic21hX2ZyZWUgY2FsbGVkXG4iKTsKKworCS8qIGZyZWUgY29kZWMgc3RydWN0Ki8K
KwlrZnJlZShjaGlwLT5hZDE4NDMpOworCXNuZF9tYWNlX2F1ZGlvX2NoaXAgPSBOVUxMOworCisJ
cmV0dXJuIDA7Cit9CisKKy8qIGNoaXAgc3BlY2lmaWMgY29uc3RydWN0b3IsIGJ1dCB3ZSBkb24n
dCBpbml0IGFueXRoaW5nICovCitzdGF0aWMgaW50IF9fZGV2aW5pdCBzbWFfY3JlYXRlCisJKHNu
ZF9jYXJkX3QgKmNhcmQsIHNuZF9tYWNlX2F1ZGlvX3QgKipyY2hpcCkKK3sKKwlzbmRfbWFjZV9h
dWRpb190ICpjaGlwOworCWludCBlcnIsIGlycTsKKwl1bnNpZ25lZCBsb25nIG1hY2VfcmVnLCBt
cmluZ2Jhc2U7CisKKwkqcmNoaXAgPSBOVUxMOworCWNoaXAgPSBjYXJkLT5wcml2YXRlX2RhdGE7
CisJY2hpcC0+Y2FyZCA9IGNhcmQ7CisKKwkvKiBjaGVjayBpZiB0aGUgY29kZWMgaXMgcHJlc2Vu
dCAqLworCW1hY2VfcmVnID0gcmVhZHEoJm1hY2UtPnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCWVy
ciA9IChtYWNlX3JlZyAmIFNNQV9DVFJMX0NPREVDX1BSRVNFTlQpPjA/IDAgOiAtRU5PRU5UOwor
CWlmICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkvKiBzcGluIGxvY2tzICovCisJc3Bp
bl9sb2NrX2luaXQoJmNoaXAtPmFkMTg0M19sb2NrKTsKKworCS8qIGFkMTg0MyBzZXR1cCAqLwor
CWNoaXAtPmFkMTg0MyA9IGttYWxsb2Moc2l6ZW9mKGFkMTg0M190KSwgR0ZQX0tFUk5FTCk7CisJ
ZXJyID0gKE5VTEwgPT0gY2hpcC0+YWQxODQzKT8tRU5PTUVNOjA7CisJaWYgKDAgPiBlcnIpIGdv
dG8gRVJST1JfRVhJVDsKKworCWNoaXAtPmFkMTg0My0+Y2hpcCA9ICBjaGlwOworCWNoaXAtPmFk
MTg0My0+cmVhZCA9CisJCShpbnQoKikodm9pZCosIGludCkpJm1hY2VfYXVkaW9fcmVnX3JlYWQ7
CisJY2hpcC0+YWQxODQzLT53cml0ZSA9CisJCShpbnQoKikodm9pZCosIGludCwgaW50KSkmbWFj
ZV9hdWRpb19yZWdfd3JpdGU7CisKKwkqcmNoaXAgPSBjaGlwOworCXNuZF9tYWNlX2F1ZGlvX2No
aXAgPSBjaGlwOworCisJcmV0dXJuIDA7CisKK0VSUk9SX0VYSVQ6CisJc25kX3ByaW50ayhLRVJO
X0VSUiAiQXR0ZW1wIHRvIGluaXRpYWxpc2UgTUFDRSBBdWRpbyBmYWlsZWRcbiIpOworCXNtYV9m
cmVlKGNoaXApOworCXJldHVybiBlcnI7Cit9CisKKy8qIGNvbnN0cnVjdGVyICovCitzdGF0aWMg
aW50IF9fZGV2aW5pdCBzbWFfcHJvYmUodm9pZCkKK3sKKwlzbmRfY2FyZF90ICAgICAgKmNhcmQ7
CisJc25kX21hY2VfYXVkaW9fdCAqY2hpcDsKKwlpbnQgZXJyOworCisJLyogY3JlYXRlIGFsc2Eg
c3R1ZmYqLworCWNhcmQgPSBzbmRfY2FyZF9uZXcoYWxzYV9pbmRleCwgYWxzYV9pZCwKKwkJVEhJ
U19NT0RVTEUsIHNpemVvZihzbmRfbWFjZV9hdWRpb190KSk7CisJaWYgKE5VTEwgPT0gY2FyZCkg
cmV0dXJuIC1FTk9NRU07CisKKwkvKiBzdXR1cCBvdXIgc3R1ZmYqLworCWVyciA9IHNtYV9jcmVh
dGUoY2FyZCwgJmNoaXApOworCWlmICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkvKiB0
ZWxsIHRoZSB3b3JsZCB3aG8gd2UgYXJlICovCisJc3RyY3B5KGNhcmQtPmRyaXZlciwgIlNHSSBP
MiBNQUNFIEF1ZGlvIFNweSIpOworCXN0cmNweShjYXJkLT5zaG9ydG5hbWUsICJNQUNFIEF1ZGlv
IFNweSIpOworCXNwcmludGYoY2FyZC0+bG9uZ25hbWUsICIlcyIsCisJCWNhcmQtPnNob3J0bmFt
ZSApOworCisJZXJyID0gc21hX3Byb2NfY3JlYXRlKGNoaXApOworCWlmICgwID4gZXJyKSBnb3Rv
IEVSUk9SX0VYSVQ7CisKKwkvKiBhbmQgd2UncmUgZG9uZSAqLworCWVyciA9IHNuZF9jYXJkX3Jl
Z2lzdGVyKGNhcmQpOworCWlmICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwlyZXR1cm4g
MDsKK0VSUk9SX0VYSVQ6CisJc25kX3ByaW50ayhLRVJOX0VSUiAiUHJvYmUgZm9yIE1BQ0UgQXVk
aW8gZmFpbGVkXG4iKTsKKwlzbmRfY2FyZF9mcmVlKGNhcmQpOworCisJcmV0dXJuIGVycjsKK30K
KworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqIE1BQ0UgYWNjZXNzICoqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KK3N0YXRpYyBpbnQgbWFjZV9hdWRpb19yZWdfcmVhZChzbmRfbWFj
ZV9hdWRpb190ICpjaGlwLCBpbnQgcmVnKQoreworCWludCB2YWw7CisJdW5zaWduZWQgbG9uZyBm
bGFnczsKKwl1bnNpZ25lZCBpbnQgY2hlY2s7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+
YWQxODQzX2xvY2ssIGZsYWdzKTsKKwl3cml0ZXEoU01BX0NPREVDX1JFQUQocmVnKSwKKwkJJm1h
Y2UtPnBlcmlmLmF1ZGlvLmNvZGVjX2NvbnRyb2wpOworCW1iKCk7CisJdWRlbGF5KDIwMCk7CisK
KwljaGVjayA9IHJlYWRxKCZtYWNlLT5wZXJpZi5hdWRpby5jb2RlY19jb250cm9sKTsgLyogZmx1
c2ggYnVzICovCisJaWYgKHVubGlrZWx5KChTTUFfQ09ERUNfUkVBRChyZWcpKSAhPSBjaGVjaykp
CisJCXByaW50aygiTUFDRSBBdWRpbyByZWcgcmVhZCBoaWMtdXAgc2VudCAlbFgsIGdvdCAlWFxu
IiwKKwkJCShTTUFfQ09ERUNfUkVBRChyZWcpKSwgY2hlY2spOworCisJdmFsID0gKGludClyZWFk
cSgmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfcmVhZCk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZjaGlwLT5hZDE4NDNfbG9jaywgZmxhZ3MpOworCisJcmV0dXJuIHZhbDsKK30KKworc3Rh
dGljIGludCBtYWNlX2F1ZGlvX3JlZ193cml0ZShzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQg
cmVnLCBpbnQgd29yZCkKK3sKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXVuc2lnbmVkIGludCBj
aGVjazsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZjaGlwLT5hZDE4NDNfbG9jaywgZmxhZ3MpOwor
CisJd3JpdGVxKFNNQV9DT0RFQ19XUklURShyZWcsIHdvcmQpLAorCQkmbWFjZS0+cGVyaWYuYXVk
aW8uY29kZWNfY29udHJvbCk7CisJbWIoKTsKKworCXVkZWxheSgyMDApOworCisJY2hlY2sgPSBy
ZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfY29udHJvbCk7IC8qIGZsdXNoIGJ1cyAqLwor
CWlmICh1bmxpa2VseSgoU01BX0NPREVDX1dSSVRFKHJlZywgd29yZCkpICE9IGNoZWNrKSkKKwkJ
cHJpbnRrKCJNQUNFIEF1ZGlvIHJlZyB3cml0ZSBoaWMtdXAgc2VudCAlbFgsIGdvdCAlWFxuIiwK
KwkJCShTTUFfQ09ERUNfV1JJVEUocmVnLCB3b3JkKSksIGNoZWNrKTsKKworCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJmNoaXAtPmFkMTg0M19sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gMDsKK30K
KworLyoqKioqKioqKioqKioqKioqKioqKioqIG1vZHVsZSBzZXR1cCAqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLworCisKK3N0YXRpYyBpbnQgX19pbml0IHNuZF9jYXJkX21hY2VfYXVkaW9f
aW5pdCh2b2lkKQoreworCWludCBlcnI7CisKKwllcnIgPSBzbWFfcHJvYmUoKTsKKwlpZiAoMCA+
IGVycikgZ290byBFUlJPUl9FWElUOworCisJcmV0dXJuIDA7CitFUlJPUl9FWElUOgorI2lmZGVm
IE1PRFVMRQorCXByaW50ayhLRVJOX0VSUiAiTWFjZSBBdWRpbyBub3QgZm91bmQgb3IgZGV2aWNl
IGJ1c3lcbiIpOworI2VuZGlmCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHZvaWQgX19leGl0
IHNuZF9jYXJkX21hY2VfYXVkaW9fZXhpdCh2b2lkKQoreworCWlmIChOVUxMICE9IHNuZF9tYWNl
X2F1ZGlvX2NoaXApIHsKKwkJc25kX2NhcmRfdCAqY2FyZCA9IHNuZF9tYWNlX2F1ZGlvX2NoaXAt
PmNhcmQ7CisJCXNtYV9mcmVlKHNuZF9tYWNlX2F1ZGlvX2NoaXApOworCQlzbmRfY2FyZF9mcmVl
KGNhcmQpOworCX0KK30KKworTU9EVUxFX0FVVEhPUigiVGhvcmJlbiBKw6RuZGxpbmcgPHRqLnRy
ZXZlbHlhbkBnbWFpbC5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIlNHSSBPMiBNQUNFIEF1
ZGlvIFNweSIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOworTU9EVUxFX1NVUFBPUlRFRF9ERVZJ
Q0UoInt7U2lsaWNvbiBHcmFwaGljcywgTzIgTUFDRSBBdWRpb319Iik7CisKK21vZHVsZV9wYXJh
bShhbHNhX2luZGV4LCBpbnQsIDA0NDQpOworTU9EVUxFX1BBUk1fREVTQyhhbHNhX2luZGV4LCAi
SW5kZXggdmFsdWUgZm9yIE1BQ0UgQXVkaW8iKTsKK21vZHVsZV9wYXJhbShhbHNhX2lkLCBjaGFy
cCwgMDQ0NCk7CitNT0RVTEVfUEFSTV9ERVNDKGFsc2FfaWQsICJJRCBzdHJpbmcgZm9yIE1BQ0Ug
QXVkaW8iKTsKK21vZHVsZV9wYXJhbShhbHNhX2VuYWJsZSwgYm9vbCwgMDQ0NCk7CitNT0RVTEVf
UEFSTV9ERVNDKGFsc2FfZW5hYmxlLCAiRW5hYmxlIE1BQ0UgQXVkaW8iKTsKKworbW9kdWxlX2lu
aXQoc25kX2NhcmRfbWFjZV9hdWRpb19pbml0KQorbW9kdWxlX2V4aXQoc25kX2NhcmRfbWFjZV9h
dWRpb19leGl0KQorCgotLS0gbGludXgtMi42LjE5Ljctb3JpZ2luYWwvc291bmQvbWlwcy9LY29u
ZmlnCTIwMDctMDMtMTAgMTI6MTE6MjMuMDAwMDAwMDAwICswMDAwCisrKyBsaW51eC0yLjYuMTku
Ny9zb3VuZC9taXBzL0tjb25maWcJMjAwNy0wNi0yOCAxMTozNTozOC4wMDAwMDAwMDAgKzAxMDAK
QEAgLTExLDUgKzExLDE4IEBACiAJaGVscAogCSAgQUxTQSBTb3VuZCBkcml2ZXIgZm9yIHRoZSBB
dTF4MDAncyBBQzk3IHBvcnQuCiAKK2NvbmZpZyBTTkRfTUFDRV9BVURJTworCXRyaXN0YXRlICJT
R0kgTzIgTUFDRSBBdWRpbyIKKwlkZXBlbmRzIG9uICBTTkQgJiYgU0dJX0lQMzIKKwloZWxwCisJ
U291bmQgc3VwcG9ydCBmb3IgdGhlIFNHSSBPMiBXb3Jrc3RhdGlvbi4KKworY29uZmlnIFNORF9N
QUNFX0FVRElPX1NQWQorCXRyaXN0YXRlICJTR0kgTzIgTUFDRSBBdWRpbyBTcHkiCisJZGVwZW5k
cyBvbiAgU05EICYmIFNHSV9JUDMyCisJaGVscAorCVNweSBvbiBNQUNFIEF1ZGlvIEhhcmR3YXJl
IHN0YXRlLiBEbyBub3QgdXNlIGlmIHlvdSBkb24ndCBrbm93CisJd2hhdCB0aGlzIG1vZHVsZSBp
cyBmb3Igb3Igd2h5IHlvdSB3YW50IHRvIHVzZSBpdC4KKwogZW5kbWVudQogCgotLS0gbGludXgt
Mi42LjE5Ljctb3JpZ2luYWwvc291bmQvbWlwcy9NYWtlZmlsZQkyMDA3LTAzLTEwIDEyOjExOjIz
LjAwMDAwMDAwMCArMDAwMAorKysgbGludXgtMi42LjE5Ljcvc291bmQvbWlwcy9NYWtlZmlsZQky
MDA3LTA2LTI4IDExOjM1OjM2LjAwMDAwMDAwMCArMDEwMApAQCAtMyw2ICszLDExIEBACiAjCiAK
IHNuZC1hdTF4MDAtb2JqcyA6PSBhdTF4MDAubworc25kLW1hY2UtYXVkaW8tb2JqcyA6PSBtYWNl
X2F1ZGlvLm8gYWQxODQzLm8KK3NuZC1tYWNlLWF1ZGlvLXNweS1vYmpzIDo9IG1hY2VfYXVkaW9f
c3B5Lm8gYWQxODQzLm8KIAogIyBUb3BsZXZlbCBNb2R1bGUgRGVwZW5kZW5jeQogb2JqLSQoQ09O
RklHX1NORF9BVTFYMDApICs9IHNuZC1hdTF4MDAubworb2JqLSQoQ09ORklHX1NORF9NQUNFX0FV
RElPKSArPSBzbmQtbWFjZS1hdWRpby5vCitvYmotJChDT05GSUdfU05EX01BQ0VfQVVESU9fU1BZ
KSArPSBzbmQtbWFjZS1hdWRpby1zcHkubworCg==
------=_Part_132389_32726951.1183537520214--
