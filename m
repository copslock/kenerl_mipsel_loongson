Received: with ECARTIS (v1.0.0; list linux-mips); Mon, 12 Mar 2007 15:27:16 +0000 (GMT)
Received: from ug-out-1314.google.com ([66.249.92.170]:49816 "EHLO
	ug-out-1314.google.com") by ftp.linux-mips.org with ESMTP
	id S20021384AbXCLP1L (ORCPT <rfc822;linux-mips@linux-mips.org>);
	Mon, 12 Mar 2007 15:27:11 +0000
Received: by ug-out-1314.google.com with SMTP id 40so2565473uga
        for <linux-mips@linux-mips.org>; Mon, 12 Mar 2007 08:26:07 -0700 (PDT)
DKIM-Signature:	a=rsa-sha1; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        b=jkqZK+nPmm/tWfLMzXR+kmM3DQtM8/gW2q6WfgBdkRUzHlmrN4t/aCEPvVufn798qgUlltxLAUBKilV5dN/ucpsY3rTmrMKMVyXtvm0NrYnc9MqXwW+LFbm5UpEVEIN2lzUYz2+ySML8jYJHmgRtcIBNB5VN15RjNV52CCdXuAo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=SYpcVHh9tmeFXae8lktjTDqrfDXZcBbhHeNFHvC2pjphzO0m8mbkLBJ2nTYPO2ChRjEbob8NZaEkS42HX7aMypEXcP3MsKJ8dEjNNNyF7qOEC22bYliGheiRc5fEs+344BZoeBJfIUqCExg3znwyb9R/xbvdMy24BQ7QD/RJiWM=
Received: by 10.114.26.1 with SMTP id 1mr1681887waz.1173713165564;
        Mon, 12 Mar 2007 08:26:05 -0700 (PDT)
Received: by 10.114.106.6 with HTTP; Mon, 12 Mar 2007 08:26:05 -0700 (PDT)
Message-ID: <6849c8890703120826m27993b75tb7f77910a5f3891b@mail.gmail.com>
Date:	Mon, 12 Mar 2007 15:26:05 +0000
From:	TJ <tj.trevelyan@gmail.com>
To:	linux-mips@linux-mips.org
Subject: [PATCH?] MACE Audio ALSA driver
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_3506_7761875.1173713165503"
Return-Path: <tj.trevelyan@gmail.com>
X-Envelope-To: <"|/home/ecartis/ecartis -s linux-mips"> (uid 0)
X-Orcpt: rfc822;linux-mips@linux-mips.org
Original-Recipient: rfc822;linux-mips@linux-mips.org
X-archive-position: 14434
X-ecartis-version: Ecartis v1.0.0
Sender: linux-mips-bounce@linux-mips.org
Errors-to: linux-mips-bounce@linux-mips.org
X-original-sender: tj.trevelyan@gmail.com
Precedence: bulk
X-list: linux-mips

------=_Part_3506_7761875.1173713165503
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I have been working on an audio driver for the SGI O2.
It is more complete then the sgio2audio driver that is about, but PCM still
doesn't work for other reasons.

Namely the DMA feed doesn't seem to run correctly, see output below.

"
#comments start with # and generally come after the line they refer to

allocated ring base. CPU addr=0x9000000004620000, Bus addr=0x44620000
#Note the bus/phys address that dma_alloc_coherent gave us.

sizeof void*=8, unsigned long=8, int=4, u32=4, u32*=8, u64=8, u64*=8
in playback open
In hw param for channel 1
In pcm prepare for channel 1
in playback for channel 1, rate 44100, sub-channels 2
In pcm trigger
In DMA start for channel 1
#about to start DMA, but before we do start, lets do a push first

In DMA push for 1
ring base 0x9000000004620000, dst_base 0x9000000004621000, dst_pos 0x0, dst
0x9000000004621000

4096 remain, 0 used
reduced remain to 3968
starting push loop. ringbase=0x44620010,
        0[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
        1[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
        2[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
#this is a printout that I have dotted around to the code to watch the
# pointers in mace, these numbers are freshly read in.
#Note the change in the ringbase address! It always seems to get incremented
# by 0x10, why?

#looping here

after push loop, 0 remain, 3968 used, dst pos 3968
Finished push loop. ringbase=0x44620010,
        0[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
        1[ writep=0xF80 (3968), readp=0x0 (0), depth=0xF80 (3968) ]
        2[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
#bar ringbase, this is what we would expect

DMA started. ringbase=0x44620010,
        0[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
        1[ writep=0xF80 (3968), readp=0x40 (64), depth=0xF40 (3904) ]
        2[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
#DMA enabled, and the read pointer has moved on

In pcm pointer. ringbase=0x44620010,
        0[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]
        1[ writep=0xF80 (3968), readp=0x40 (64), depth=0xF40 (3904) ]
        2[ writep=0x0 (0), readp=0x0 (0), depth=0x0 (0) ]

#This is inside one of the ALSA callbacks some time later.
#Note the read pointer has not moved any further, its always sticks at
#0x40?! Even if push code didn't put the correct data in the correct place
#as far as mace is concerned there is still a depth of 0xF40, so why has it
#stopped?
"

Currently I think it has something to do with the ad1843. I have tried to
butter interpret the specs file to improve ad1843_init() and
ad1843_setup_dac(). (Note sgio2audio will need a few changes to work 'as
was', with my ad1843.c, main change is I made channel/dac/adc index/id
consistent, ie 0=adc,1=dac1,2=dac2 see ad1843_setup_dac())

I do most of this from a remote location to the O2 at the moment (the driver
has been stable enough to allow be to remotely reboot after a test) so I
have not worked on the kinks in the mixer code (and vol buttons) other then
they run ok with out errors. (and of course if I ever get dma going I would
not be able to hear it, although my girlfriend my get a nasty/noisy shock)

It is my plan to get ALSA to write/dma directly into the 4k channel buffer
(I know what needs to be done to get alsa to do this, assuming that the way
alsa stores s24_be in 32bits is agreeable to mace) thus removing the dma
push func. But for now (while testing) I'll keep the psudo dma setup.

Any thoughts, help, major coding mistakes by my self?

Regards

Thorben

PS
I would like to thanks all those that have already helped me with this in
the IRC channel.

------=_Part_3506_7761875.1173713165503
Content-Type: text/plain; name=mace_audio.diff; charset=ANSI_X3.4-1968
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ez72b9pj
Content-Disposition: attachment; filename="mace_audio.diff"

ZGlmZiAtTnUgbGludXgtMi42LjE5LjcuYi9zb3VuZC9taXBzL2FkMTg0My5jIGxpbnV4LTIuNi4x
OS43L3NvdW5kL21pcHMvYWQxODQzLmMKLS0tIGxpbnV4LTIuNi4xOS43LmIvc291bmQvbWlwcy9h
ZDE4NDMuYwkxOTcwLTAxLTAxIDAxOjAwOjAwLjAwMDAwMDAwMCArMDEwMAorKysgbGludXgtMi42
LjE5Ljcvc291bmQvbWlwcy9hZDE4NDMuYwkyMDA3LTAzLTEyIDEzOjM0OjE2LjAwMDAwMDAwMCAr
MDAwMApAQCAtMCwwICsxLDY0OSBAQAorLyoKKyAqICAgQUQxODQzIGxvdyBsZXZlbCBkcml2ZXIK
KyAqCisgKiAgIENvcHlyaWdodCAyMDAzIFZpdmllbiBDaGFwcGVsaWVyIDx2aXZpZW4uY2hhcHBl
bGllckBsaW51eC1taXBzLm9yZz4KKyAqCisgKiAgIGluc3BpcmVkIGZyb20gdndzbmQuYyAoU0dJ
IFZXIGF1ZGlvIGRyaXZlcikKKyAqICAgICBDb3B5cmlnaHQgMTk5OSBTaWxpY29uIEdyYXBoaWNz
LCBJbmMuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqICAgVGhpcyBwcm9ncmFtIGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICAg
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBw
dWJsaXNoZWQgYnkKKyAqICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZl
cnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKyAqCisgKiAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogICBidXQgV0lUSE9VVCBBTlkgV0FSUkFO
VFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogICBNRVJDSEFOVEFC
SUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAg
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogICBZ
b3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZQorICogICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0
aGUgRnJlZSBTb2Z0d2FyZQorICogICBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2Us
IFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNyBVU0EKKyAqCisgKi8KKworCisjaW5j
bHVkZSA8bGludXgvc2xhYi5oPgorCisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1ZGUg
PGxpbnV4L2ppZmZpZXMuaD4KKyNpbmNsdWRlIDxsaW51eC9zY2hlZC5oPgorI2luY2x1ZGUgPGxp
bnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGludXgvZXJybm8uaD4KKyNpbmNsdWRlIDxzb3VuZC9k
cml2ZXIuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb3JlLmg+CisjaW5jbHVkZSA8c291bmQvcGNtLmg+
CisjaW5jbHVkZSA8c291bmQvaW5pdHZhbC5oPgorI2luY2x1ZGUgPHNvdW5kL2FkMTg0My5oPgor
CisvLyBmaW5kIGFuZCByZW1vdmUgYW55IE9TUyBzdHVmZgorI2luY2x1ZGUgPGxpbnV4L3NvdW5k
Y2FyZC5oPgorCisvKgorICogQUQxODQzIGJpdGZpZWxkIGRlZmluaXRpb25zLiAgQWxsIGFyZSBu
YW1lZCBhcyBpbiB0aGUgQUQxODQzIGRhdGEKKyAqIHNoZWV0LCB3aXRoIGFkMTg0M18gcHJlcGVu
ZGVkIGFuZCBpbmRpdmlkdWFsIGJpdCBudW1iZXJzIHJlbW92ZWQuCisgKgorICogRS5nLiwgYml0
cyBMU1MwIHRocm91Z2ggTFNTMiBiZWNvbWUgYWQxODQzX0xTUy4KKyAqCisgKiBPbmx5IHRoZSBi
aXRmaWVsZHMgd2UgbmVlZCBhcmUgZGVmaW5lZC4KKyAqLworCit0eXBlZGVmIHN0cnVjdCBhZDE4
NDNfYml0ZmllbGQgeworICAgICAgIGNoYXIgcmVnOworICAgICAgIGNoYXIgbG9fYml0OworICAg
ICAgIGNoYXIgbmJpdHM7Cit9IGFkMTg0M19iaXRmaWVsZF90OworCitzdGF0aWMgY29uc3QgYWQx
ODQzX2JpdGZpZWxkX3QKKyAgICAgICBhZDE4NDNfUEROTyAgID0geyAgMCwgMTQsICAxIH0sIC8q
IENvbnZlcnRlciBQb3dlci1Eb3duIEZsYWcgKi8KKyAgICAgICBhZDE4NDNfSU5JVCAgID0geyAg
MCwgMTUsICAxIH0sIC8qIENsb2NrIEluaXRpYWxpemF0aW9uIEZsYWcgKi8KKyAgICAgICBhZDE4
NDNfUklHICAgID0geyAgMiwgIDAsICA0IH0sIC8qIFJpZ2h0IEFEQyBJbnB1dCBHYWluICovCisg
ICAgICAgYWQxODQzX1JNR0UgICA9IHsgIDIsICA0LCAgMSB9LCAvKiBSaWdodCBBREMgTWljIEdh
aW4gRW5hYmxlICovCisgICAgICAgYWQxODQzX1JTUyAgICA9IHsgIDIsICA1LCAgMyB9LCAvKiBS
aWdodCBBREMgU291cmNlIFNlbGVjdCAqLworICAgICAgIGFkMTg0M19MSUcgICAgPSB7ICAyLCAg
OCwgIDQgfSwgLyogTGVmdCBBREMgSW5wdXQgR2FpbiAqLworICAgICAgIGFkMTg0M19MTUdFICAg
PSB7ICAyLCAxMiwgIDEgfSwgLyogTGVmdCBBREMgTWljIEdhaW4gRW5hYmxlICovCisgICAgICAg
YWQxODQzX0xTUyAgICA9IHsgIDIsIDEzLCAgMyB9LCAvKiBMZWZ0IEFEQyBTb3VyY2UgU2VsZWN0
ICovCisgICAgICAgYWQxODQzX1JYMU0gICA9IHsgIDQsICAwLCAgNSB9LCAvKiBSaWdodCBBdXgg
MSBNaXggR2Fpbi9BdHRlbiAqLworICAgICAgIGFkMTg0M19SWDFNTSAgPSB7ICA0LCAgNywgIDEg
fSwgLyogUmlnaHQgQXV4IDEgTWl4IE11dGUgKi8KKyAgICAgICBhZDE4NDNfTFgxTSAgID0geyAg
NCwgIDgsICA1IH0sIC8qIExlZnQgQXV4IDEgTWl4IEdhaW4vQXR0ZW4gKi8KKyAgICAgICBhZDE4
NDNfTFgxTU0gID0geyAgNCwgMTUsICAxIH0sIC8qIExlZnQgQXV4IDEgTWl4IE11dGUgKi8KKyAg
ICAgICBhZDE4NDNfUlgyTSAgID0geyAgNSwgIDAsICA1IH0sIC8qIFJpZ2h0IEF1eCAyIE1peCBH
YWluL0F0dGVuICovCisgICAgICAgYWQxODQzX1JYMk1NICA9IHsgIDUsICA3LCAgMSB9LCAvKiBS
aWdodCBBdXggMiBNaXggTXV0ZSAqLworICAgICAgIGFkMTg0M19MWDJNICAgPSB7ICA1LCAgOCwg
IDUgfSwgLyogTGVmdCBBdXggMiBNaXggR2Fpbi9BdHRlbiAqLworICAgICAgIGFkMTg0M19MWDJN
TSAgPSB7ICA1LCAxNSwgIDEgfSwgLyogTGVmdCBBdXggMiBNaXggTXV0ZSAqLworICAgICAgIGFk
MTg0M19STUNNICAgPSB7ICA3LCAgMCwgIDUgfSwgLyogUmlnaHQgTWljIE1peCBHYWluL0F0dGVu
ICovCisgICAgICAgYWQxODQzX1JNQ01NICA9IHsgIDcsICA3LCAgMSB9LCAvKiBSaWdodCBNaWMg
TWl4IE11dGUgKi8KKyAgICAgICBhZDE4NDNfTE1DTSAgID0geyAgNywgIDgsICA1IH0sIC8qIExl
ZnQgTWljIE1peCBHYWluL0F0dGVuICovCisgICAgICAgYWQxODQzX0xNQ01NICA9IHsgIDcsIDE1
LCAgMSB9LCAvKiBMZWZ0IE1pYyBNaXggTXV0ZSAqLworICAgICAgIGFkMTg0M19IUE9TICAgPSB7
ICA4LCAgNCwgIDEgfSwgLyogSGVhZHBob25lIE91dHB1dCBWb2x0YWdlIFN3aW5nICovCisgICAg
ICAgYWQxODQzX0hQT00gICA9IHsgIDgsICA1LCAgMSB9LCAvKiBIZWFkcGhvbmUgT3V0cHV0IE11
dGUgKi8KKyAgICAgICBhZDE4NDNfTVBPTSAgID0geyAgOCwgIDYsICAxIH0sIC8qIE1vbm8gT3V0
cHV0IE11dGUgKi8KKyAgICAgICBhZDE4NDNfUkRBMUcgID0geyAgOSwgIDAsICA2IH0sIC8qIFJp
Z2h0IERBQzEgQW5hbG9nL0RpZ2l0YWwgR2FpbiAqLworICAgICAgIGFkMTg0M19SREExR00gPSB7
ICA5LCAgNywgIDEgfSwgLyogUmlnaHQgREFDMSBBbmFsb2cgTXV0ZSAqLworICAgICAgIGFkMTg0
M19MREExRyAgPSB7ICA5LCAgOCwgIDYgfSwgLyogTGVmdCBEQUMxIEFuYWxvZy9EaWdpdGFsIEdh
aW4gKi8KKyAgICAgICBhZDE4NDNfTERBMUdNID0geyAgOSwgMTUsICAxIH0sIC8qIExlZnQgREFD
MSBBbmFsb2cgTXV0ZSAqLworICAgICAgIGFkMTg0M19SREEyRyAgPSB7IDEwLCAgMCwgIDYgfSwg
LyogUmlnaHQgREFDMiBBbmFsb2cvRGlnaXRhbCBHYWluICovCisgICAgICAgYWQxODQzX1JEQTJH
TSA9IHsgMTAsICA3LCAgMSB9LCAvKiBSaWdodCBEQUMyIEFuYWxvZyBNdXRlICovCisgICAgICAg
YWQxODQzX0xEQTJHICA9IHsgMTAsICA4LCAgNiB9LCAvKiBMZWZ0IERBQzIgQW5hbG9nL0RpZ2l0
YWwgR2FpbiAqLworICAgICAgIGFkMTg0M19MREEyR00gPSB7IDEwLCAxNSwgIDEgfSwgLyogTGVm
dCBEQUMyIEFuYWxvZyBNdXRlICovCisgICAgICAgYWQxODQzX1JEQTFBTSA9IHsgMTEsICA3LCAg
MSB9LCAvKiBSaWdodCBEQUMxIERpZ2l0YWwgTXV0ZSAqLworICAgICAgIGFkMTg0M19MREExQU0g
PSB7IDExLCAxNSwgIDEgfSwgLyogTGVmdCBEQUMxIERpZ2l0YWwgTXV0ZSAqLworICAgICAgIGFk
MTg0M19SREEyQU0gPSB7IDExLCAgNywgIDEgfSwgLyogUmlnaHQgREFDMSBEaWdpdGFsIE11dGUg
Ki8KKyAgICAgICBhZDE4NDNfTERBMkFNID0geyAxMSwgMTUsICAxIH0sIC8qIExlZnQgREFDMSBE
aWdpdGFsIE11dGUgKi8KKyAgICAgICBhZDE4NDNfQURMQyAgID0geyAxNSwgIDAsICAyIH0sIC8q
IEFEQyBMZWZ0IFNhbXBsZSBSYXRlIFNvdXJjZSAqLworICAgICAgIGFkMTg0M19BRFJDICAgPSB7
IDE1LCAgMiwgIDIgfSwgLyogQURDIFJpZ2h0IFNhbXBsZSBSYXRlIFNvdXJjZSAqLworICAgICAg
IGFkMTg0M19EQTFDICAgPSB7IDE1LCAgOCwgIDIgfSwgLyogREFDMSBTYW1wbGUgUmF0ZSBTb3Vy
Y2UgKi8KKyAgICAgICBhZDE4NDNfREEyQyAgID0geyAxNSwgMTAsICAyIH0sIC8qIERBQzIgU2Ft
cGxlIFJhdGUgU291cmNlICovCisgICAgICAgYWQxODQzX0MxQyAgICA9IHsgMTcsICAwLCAxNiB9
LCAvKiBDbG9jayAxIFNhbXBsZSBSYXRlIFNlbGVjdCAqLworICAgICAgIGFkMTg0M19DMkMgICAg
PSB7IDIwLCAgMCwgMTYgfSwgLyogQ2xvY2sgMiBTYW1wbGUgUmF0ZSBTZWxlY3QgKi8KKyAgICAg
ICBhZDE4NDNfQzNDICAgID0geyAyMywgIDAsIDE2IH0sIC8qIENsb2NrIDMgU2FtcGxlIFJhdGUg
U2VsZWN0ICovCisgICAgICAgYWQxODQzX0RBQURMICA9IHsgMjUsICA0LCAgMiB9LCAvKiBEaWdp
dGFsIEFEQyBMZWZ0IFNvdXJjZSBTZWxlY3QgKi8KKyAgICAgICBhZDE4NDNfREFBRFIgID0geyAy
NSwgIDYsICAyIH0sIC8qIERpZ2l0YWwgQURDIFJpZ2h0IFNvdXJjZSBTZWxlY3QgKi8KKyAgICAg
ICBhZDE4NDNfRFJTRkxUID0geyAyNSwgMTUsICAxIH0sIC8qIERpZ2l0YWwgUmVhbXBsZXIgRmls
dGVyIE1vZGUgKi8KKyAgICAgICBhZDE4NDNfQURMRiAgID0geyAyNiwgIDAsICAyIH0sIC8qIEFE
QyBMZWZ0IENoYW5uZWwgRGF0YSBGb3JtYXQgKi8KKyAgICAgICBhZDE4NDNfQURSRiAgID0geyAy
NiwgIDIsICAyIH0sIC8qIEFEQyBSaWdodCBDaGFubmVsIERhdGEgRm9ybWF0ICovCisgICAgICAg
YWQxODQzX0FEVExLICA9IHsgMjYsICA0LCAgMSB9LCAvKiBBREMgVHJhbnNtaXQgTG9jayBNb2Rl
IFNlbGVjdCAqLworICAgICAgIGFkMTg0M19TQ0YgICAgPSB7IDI2LCAgNywgIDEgfSwgLyogU0NM
SyBGcmVxdWVuY3kgU2VsZWN0ICovCisgICAgICAgYWQxODQzX0RBMUYgICA9IHsgMjYsICA4LCAg
MiB9LCAvKiBEQUMxIERhdGEgRm9ybWF0IFNlbGVjdCAqLworICAgICAgIGFkMTg0M19EQTJGICAg
PSB7IDI2LCAxMCwgIDIgfSwgLyogREFDMiBEYXRhIEZvcm1hdCBTZWxlY3QgKi8KKyAgICAgICBh
ZDE4NDNfREExU00gID0geyAyNiwgMTQsICAxIH0sIC8qIERBQzEgU3RlcmVvL01vbm8gTW9kZSBT
ZWxlY3QgKi8KKyAgICAgICBhZDE4NDNfREEyU00gID0geyAyNiwgMTUsICAxIH0sIC8qIERBQzIg
U3RlcmVvL01vbm8gTW9kZSBTZWxlY3QgKi8KKyAgICAgICBhZDE4NDNfQURMRU4gID0geyAyNywg
IDAsICAxIH0sIC8qIEFEQyBMZWZ0IENoYW5uZWwgRW5hYmxlICovCisgICAgICAgYWQxODQzX0FE
UkVOICA9IHsgMjcsICAxLCAgMSB9LCAvKiBBREMgUmlnaHQgQ2hhbm5lbCBFbmFibGUgKi8KKyAg
ICAgICBhZDE4NDNfQUFNRU4gID0geyAyNywgIDQsICAxIH0sIC8qIEFuYWxvZyB0byBBbmFsb2cg
TWl4IEVuYWJsZSAqLworICAgICAgIGFkMTg0M19BTkFFTiAgPSB7IDI3LCAgNywgIDEgfSwgLyog
QW5hbG9nIENoYW5uZWwgRW5hYmxlICovCisgICAgICAgYWQxODQzX0RBMUVOICA9IHsgMjcsICA4
LCAgMSB9LCAvKiBEQUMxIEVuYWJsZSAqLworICAgICAgIGFkMTg0M19EQTJFTiAgPSB7IDI3LCAg
OSwgIDEgfSwgLyogREFDMiBFbmFibGUgKi8KKwlhZDE4NDNfRU5CVDEgID0geyAyOCwgIDIsICAx
IH0sIC8qIEJJVDEgUGluIEVuYWJsZSAqLworCWFkMTg0M19FTkNWMSAgPSB7IDI4LCAgMywgIDEg
fSwgLyogQ09OVjEgUGluIEVuYWJsZSAqLworCWFkMTg0M19FTkJUMiAgPSB7IDI4LCAgNCwgIDEg
fSwgLyogQklUMiBQaW4gRW5hYmxlICovCisJYWQxODQzX0VOQ1YyICA9IHsgMjgsICA1LCAgMSB9
LCAvKiBDT05WMiBQaW4gRW5hYmxlICovCisJYWQxODQzX0VOQlQzICA9IHsgMjgsICA2LCAgMSB9
LCAvKiBCSVQzIFBpbiBFbmFibGUgKi8KKwlhZDE4NDNfRU5DVjMgID0geyAyOCwgIDcsICAxIH0s
IC8qIENPTlYzIFBpbiBFbmFibGUgKi8KKwlhZDE4NDNfRU5DTEtPID0geyAyOCwgMTAsICAxIH0s
IC8qIENsb2NrT3V0IFBpbiBFbmFibGUgKi8KKwlhZDE4NDNfQzFFTiAgID0geyAyOCwgMTEsICAx
IH0sIC8qIENsb2NrIEdlbmVyYXRvciAxIEVuYWJsZSAqLworCWFkMTg0M19DMkVOICAgPSB7IDI4
LCAxMiwgIDEgfSwgLyogQ2xvY2sgR2VuZXJhdG9yIDIgRW5hYmxlICovCisJYWQxODQzX0MzRU4g
ICA9IHsgMjgsIDEzLCAgMSB9LCAvKiBDbG9jayBHZW5lcmF0b3IgMyBFbmFibGUgKi8KKwlhZDE4
NDNfQUNFTiAgID0geyAyOCwgMTQsICAxIH0sIC8qIEF1dG9jYWxpYnJhdGlvbiBlbmFibGUgKi8K
KwlhZDE4NDNfUEROSSAgID0geyAyOCwgMTUsICAxIH07IC8qIENvbnZlcnRlciBQb3dlciBEb3du
ICovCisKKworLyoKKyAqIFRoZSB2YXJpb3VzIHJlZ2lzdGVycyBvZiB0aGUgQUQxODQzIHVzZSB0
aHJlZSBkaWZmZXJlbnQgZm9ybWF0cyBmb3IKKyAqIHNwZWNpZnlpbmcgZ2Fpbi4gIFRoZSBhZDE4
NDNfZ2FpbiBzdHJ1Y3R1cmUgcGFyYW1ldGVyaXplcyB0aGUKKyAqIGZvcm1hdHMuCisgKi8KKwor
dHlwZWRlZiBzdHJ1Y3QgYWQxODQzX2dhaW4geworICAgICAgIGludCAgICAgbmVnYXRpdmU7ICAg
ICAgICAgICAgICAgLyogbm9uemVybyBpZiBnYWluIGlzIG5lZ2F0aXZlLiAqLworICAgICAgIGNv
bnN0IGFkMTg0M19iaXRmaWVsZF90ICpsZmllbGQ7CisgICAgICAgY29uc3QgYWQxODQzX2JpdGZp
ZWxkX3QgKnJmaWVsZDsKK30gYWQxODQzX2dhaW5fdDsKKworY29uc3QgYWQxODQzX2dhaW5fdCBh
ZDE4NDNfZ2Fpbl9SRUNMRVYKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgMCwg
JmFkMTg0M19MSUcsICAgJmFkMTg0M19SSUcgfTsKK2NvbnN0IGFkMTg0M19nYWluX3QgYWQxODQz
X2dhaW5fTElORQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0geyAxLCAmYWQxODQz
X0xYMU0sICAmYWQxODQzX1JYMU0gfTsKK2NvbnN0IGFkMTg0M19nYWluX3QgYWQxODQzX2dhaW5f
Q0QKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgMSwgJmFkMTg0M19MWDJNLCAg
JmFkMTg0M19SWDJNIH07Citjb25zdCBhZDE4NDNfZ2Fpbl90IGFkMTg0M19nYWluX01JQworICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgID0geyAxLCAmYWQxODQzX0xNQ00sICAmYWQxODQz
X1JNQ00gfTsKK2NvbnN0IGFkMTg0M19nYWluX3QgYWQxODQzX2dhaW5fUENNXzAKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICA9IHsgMSwgJmFkMTg0M19MREExRywgJmFkMTg0M19SREEx
RyB9OworY29uc3QgYWQxODQzX2dhaW5fdCBhZDE4NDNfZ2Fpbl9QQ01fMQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgID0geyAxLCAmYWQxODQzX0xEQTJHLCAmYWQxODQzX1JEQTJHIH07
CisKK2NvbnN0IGFkMTg0M19nYWluX3QgKmFkMTg0M19nYWluW0FEMTg0M19HQUlOX1NJWkVdID0g
eworICAmYWQxODQzX2dhaW5fUkVDTEVWLAorICAmYWQxODQzX2dhaW5fTElORSwKKyAgJmFkMTg0
M19nYWluX0NELAorICAmYWQxODQzX2dhaW5fTUlDLAorICAmYWQxODQzX2dhaW5fUENNXzAsCisg
ICZhZDE4NDNfZ2Fpbl9QQ01fMSwKK307CisKKy8qIHJlYWQgdGhlIGN1cnJlbnQgdmFsdWUgb2Yg
YW4gQUQxODQzIGJpdGZpZWxkLiAqLworCitzdGF0aWMgaW50IGFkMTg0M19yZWFkX2JpdHMoYWQx
ODQzX3QgKmFkMTg0MywgY29uc3QgYWQxODQzX2JpdGZpZWxkX3QgKmZpZWxkKQoreworICAgICAg
IGludCB3ID0gYWQxODQzLT5yZWFkKGFkMTg0My0+Y2hpcCwgZmllbGQtPnJlZyk7CisgICAgICAg
aW50IHZhbCA9IHcgPj4gZmllbGQtPmxvX2JpdCAmICgoMSA8PCBmaWVsZC0+bmJpdHMpIC0gMSk7
CisKKyAgICAgICByZXR1cm4gdmFsOworfQorCisvKgorICogd3JpdGUgYSBuZXcgdmFsdWUgdG8g
YW4gQUQxODQzIGJpdGZpZWxkIGFuZCByZXR1cm4gdGhlIG9sZCB2YWx1ZS4KKyAqLworCitzdGF0
aWMgaW50IGFkMTg0M193cml0ZV9iaXRzKGFkMTg0M190ICphZDE4NDMsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgYWQxODQzX2JpdGZpZWxkX3QgKmZpZWxkLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCBuZXd2YWwpCit7CisgICAgICAgaW50IHcgPSBhZDE4NDMt
PnJlYWQoYWQxODQzLT5jaGlwLCBmaWVsZC0+cmVnKTsKKyAgICAgICBpbnQgbWFzayA9ICgoMSA8
PCBmaWVsZC0+bmJpdHMpIC0gMSkgPDwgZmllbGQtPmxvX2JpdDsKKyAgICAgICBpbnQgb2xkdmFs
ID0gKHcgJiBtYXNrKSA+PiBmaWVsZC0+bG9fYml0OworICAgICAgIGludCBuZXdiaXRzID0gKG5l
d3ZhbCA8PCBmaWVsZC0+bG9fYml0KSAmIG1hc2s7CisgICAgICAgdyA9ICh3ICYgfm1hc2spIHwg
bmV3Yml0czsKKyAgICAgICAodm9pZCkgYWQxODQzLT53cml0ZShhZDE4NDMtPmNoaXAsIGZpZWxk
LT5yZWcsIHcpOworCisgICAgICAgcmV0dXJuIG9sZHZhbDsKK30KKworLyoKKyAqIGFkMTg0M19y
ZWFkX211bHRpIHJlYWRzIG11bHRpcGxlIGJpdGZpZWxkcyBmcm9tIHRoZSBzYW1lIEFEMTg0Mwor
ICogcmVnaXN0ZXIuICBJdCB1c2VzIGEgc2luZ2xlIHJlYWQgY3ljbGUgdG8gZG8gaXQuICAoUmVh
ZGluZyB0aGUKKyAqIGFkMTg0MyByZXF1aXJlcyAyNTYgYml0IHRpbWVzIGF0IDEyLjI4OCBNSHos
IG9yIG5lYXJseSAyMAorICogbWljcm9zZWNvbmRzLikKKyAqCisgKiBDYWxsZWQgbGlrZSB0aGlz
LgorICoKKyAqICBhZDE4NDNfcmVhZF9tdWx0aShhZDE4NDMsIG5maWVsZHMsCisgKiAgICAgICAg
ICAgICAgICAgICAmYWQxODQzX0ZJRUxEMSwgJnZhbDEsCisgKiAgICAgICAgICAgICAgICAgICAm
YWQxODQzX0ZJRUxEMiwgJnZhbDIsIC4uLik7CisgKi8KKworc3RhdGljIHZvaWQgYWQxODQzX3Jl
YWRfbXVsdGkoYWQxODQzX3QgKmFkMTg0MywgaW50IGFyZ2NvdW50LCAuLi4pCit7CisgICAgICAg
dmFfbGlzdCBhcDsKKyAgICAgICBjb25zdCBhZDE4NDNfYml0ZmllbGRfdCAqZnA7CisgICAgICAg
aW50IHcgPSAwLCBtYXNrLCAqdmFsdWUsIHJlZyA9IC0xOworCisgICAgICAgdmFfc3RhcnQoYXAs
IGFyZ2NvdW50KTsKKyAgICAgICB3aGlsZSAoLS1hcmdjb3VudCA+PSAwKSB7CisgICAgICAgICAg
ICAgICBmcCA9IHZhX2FyZyhhcCwgY29uc3QgYWQxODQzX2JpdGZpZWxkX3QgKik7CisgICAgICAg
ICAgICAgICB2YWx1ZSA9IHZhX2FyZyhhcCwgaW50ICopOworCisgICAgICAgICAgICAgICBpZiAo
cmVnID09IC0xKSB7CisgICAgICAgICAgICAgICAgICAgICAgIHJlZyA9IGZwLT5yZWc7CisgICAg
ICAgICAgICAgICAgICAgICAgIHcgPSBhZDE4NDMtPnJlYWQoYWQxODQzLT5jaGlwLCByZWcpOwor
ICAgICAgICAgICAgICAgfQorCisgICAgICAgICAgICAgICBtYXNrID0gKDEgPDwgZnAtPm5iaXRz
KSAtIDE7CisgICAgICAgICAgICAgICAqdmFsdWUgPSB3ID4+IGZwLT5sb19iaXQgJiBtYXNrOwor
ICAgICAgIH0KKyAgICAgICB2YV9lbmQoYXApOworCit9CisKKy8qCisgKiBhZDE4NDNfd3JpdGVf
bXVsdGkgc3RvcmVzIG11bHRpcGxlIGJpdGZpZWxkcyBpbnRvIHRoZSBzYW1lIEFEMTg0MworICog
cmVnaXN0ZXIuICBJdCB1c2VzIG9uZSByZWFkIGFuZCBvbmUgd3JpdGUgY3ljbGUgdG8gZG8gaXQu
CisgKgorICogQ2FsbGVkIGxpa2UgdGhpcy4KKyAqCisgKiAgYWQxODQzX3dyaXRlX211bHRpKGFk
MTg0MywgbmZpZWxkcywKKyAqICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0ZJRUxEMSwgdmFs
MSwKKyAqICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0ZJRUxGMiwgdmFsMiwgLi4uKTsKKyAq
LworCitzdGF0aWMgdm9pZCBhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzX3QgKmFkMTg0MywgaW50
IGFyZ2NvdW50LCAuLi4pCit7CisgICAgICAgdmFfbGlzdCBhcDsKKyAgICAgICBpbnQgcmVnOwor
ICAgICAgIGNvbnN0IGFkMTg0M19iaXRmaWVsZF90ICpmcDsKKyAgICAgICBpbnQgdmFsdWU7Cisg
ICAgICAgaW50IHcsIG0sIG1hc2ssIGJpdHM7CisKKyAgICAgICBtYXNrID0gMDsKKyAgICAgICBi
aXRzID0gMDsKKyAgICAgICByZWcgPSAtMTsKKworICAgICAgIHZhX3N0YXJ0KGFwLCBhcmdjb3Vu
dCk7CisgICAgICAgd2hpbGUgKC0tYXJnY291bnQgPj0gMCkgeworICAgICAgICAgICAgICAgZnAg
PSB2YV9hcmcoYXAsIGNvbnN0IGFkMTg0M19iaXRmaWVsZF90ICopOworICAgICAgICAgICAgICAg
dmFsdWUgPSB2YV9hcmcoYXAsIGludCk7CisgICAgICAgICAgICAgICBpZiAocmVnID09IC0xKQor
ICAgICAgICAgICAgICAgICAgICAgICByZWcgPSBmcC0+cmVnOworCisgICAgICAgICAgICAgICBt
ID0gKCgxIDw8IGZwLT5uYml0cykgLSAxKSA8PCBmcC0+bG9fYml0OworICAgICAgICAgICAgICAg
bWFzayB8PSBtOworICAgICAgICAgICAgICAgYml0cyB8PSAodmFsdWUgPDwgZnAtPmxvX2JpdCkg
JiBtOworICAgICAgIH0KKyAgICAgICB2YV9lbmQoYXApOworCisgICAgICAgaWYgKH5tYXNrICYg
MHhGRkZGKQorICAgICAgICAgICAgICAgdyA9IGFkMTg0My0+cmVhZChhZDE4NDMtPmNoaXAsIHJl
Zyk7CisgICAgICAgZWxzZQorICAgICAgICAgICAgICAgdyA9IDA7CisgICAgICAgdyA9ICh3ICYg
fm1hc2spIHwgYml0czsKKyAgICAgICAodm9pZCkgYWQxODQzLT53cml0ZShhZDE4NDMtPmNoaXAs
IHJlZywgdyk7Cit9CisKKy8qCisgKiBhZDE4NDNfZ2V0X2dhaW4gcmVhZHMgdGhlIHNwZWNpZmll
ZCByZWdpc3RlciBhbmQgZXh0cmFjdHMgdGhlIGdhaW4gdmFsdWUKKyAqIHVzaW5nIHRoZSBzdXBw
bGllZCBnYWluIHR5cGUuICBJdCByZXR1cm5zIHRoZSBnYWluIGluIE9TUyBmb3JtYXQuCisgKi8K
KworaW50IGFkMTg0M19nZXRfZ2FpbihhZDE4NDNfdCAqYWQxODQzLCBpbnQgaWQpCit7CisgICAg
ICAgaW50IGxnLCByZzsKKyAgICAgICAgY29uc3QgYWQxODQzX2dhaW5fdCAqZ3AgPSBhZDE4NDNf
Z2FpbltpZF07CisgICAgICAgdW5zaWduZWQgc2hvcnQgbWFzayA9ICgxIDw8IGdwLT5sZmllbGQt
Pm5iaXRzKSAtIDE7CisKKyAgICAgICBhZDE4NDNfcmVhZF9tdWx0aShhZDE4NDMsIDIsIGdwLT5s
ZmllbGQsICZsZywgZ3AtPnJmaWVsZCwgJnJnKTsKKyAgICAgICBpZiAoZ3AtPm5lZ2F0aXZlKSB7
CisgICAgICAgICAgICAgICBsZyA9IG1hc2sgLSBsZzsKKyAgICAgICAgICAgICAgIHJnID0gbWFz
ayAtIHJnOworICAgICAgIH0KKyAgICAgICBsZyA9IChsZyAqIDEwMCArIChtYXNrID4+IDEpKSAv
IG1hc2s7CisgICAgICAgcmcgPSAocmcgKiAxMDAgKyAobWFzayA+PiAxKSkgLyBtYXNrOworICAg
ICAgIHJldHVybiBsZyA8PCAwIHwgcmcgPDwgODsKK30KKworLyoKKyAqIFNldCBhbiBhdWRpbyBj
aGFubmVsJ3MgZ2Fpbi4gQ29udmVydHMgZnJvbSBPU1MgZm9ybWF0IHRvIEFEMTg0MydzCisgKiBm
b3JtYXQuCisgKgorICogUmV0dXJucyB0aGUgbmV3IGdhaW4sIHdoaWNoIG1heSBiZSBsb3dlciB0
aGFuIHRoZSBvbGQgZ2Fpbi4KKyAqLworCitpbnQgYWQxODQzX3NldF9nYWluKGFkMTg0M190ICph
ZDE4NDMsCisgICAgICAgICAgICAgICAgICAgIGludCBpZCwKKyAgICAgICAgICAgICAgICAgICAg
aW50IG5ld3ZhbCkKK3sKKyAgICAgICAgY29uc3QgYWQxODQzX2dhaW5fdCAqZ3AgPSBhZDE4NDNf
Z2FpbltpZF07CisgICAgICAgdW5zaWduZWQgc2hvcnQgbWFzayA9ICgxIDw8IGdwLT5sZmllbGQt
Pm5iaXRzKSAtIDE7CisKKyAgICAgICBpbnQgbGcgPSBuZXd2YWwgPj4gMCAmIDB4RkY7CisgICAg
ICAgaW50IHJnID0gbmV3dmFsID4+IDg7CisgICAgICAgaWYgKGxnIDwgMCB8fCBsZyA+IDEwMCB8
fCByZyA8IDAgfHwgcmcgPiAxMDApCisgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAg
ICAgICBsZyA9IChsZyAqIG1hc2sgKyAobWFzayA+PiAxKSkgLyAxMDA7CisgICAgICAgcmcgPSAo
cmcgKiBtYXNrICsgKG1hc2sgPj4gMSkpIC8gMTAwOworICAgICAgIGlmIChncC0+bmVnYXRpdmUp
IHsKKyAgICAgICAgICAgICAgIGxnID0gbWFzayAtIGxnOworICAgICAgICAgICAgICAgcmcgPSBt
YXNrIC0gcmc7CisgICAgICAgfQorICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIs
IGdwLT5sZmllbGQsIGxnLCBncC0+cmZpZWxkLCByZyk7CisgICAgICAgcmV0dXJuIGFkMTg0M19n
ZXRfZ2FpbihhZDE4NDMsIGlkKTsKK30KKworLyogUmV0dXJucyB0aGUgY3VycmVudCByZWNvcmRp
bmcgc291cmNlLCBpbiBPU1MgZm9ybWF0LiAqLworCitpbnQgYWQxODQzX2dldF9yZWNzcmMoYWQx
ODQzX3QgKmFkMTg0MykKK3sKKyAgICAgICBpbnQgbHMgPSBhZDE4NDNfcmVhZF9iaXRzKGFkMTg0
MywgJmFkMTg0M19MU1MpOworCisgICAgICAgc3dpdGNoIChscykgeworICAgICAgIGNhc2UgMToK
KyAgICAgICAgICAgICAgIHJldHVybiBTT1VORF9NQVNLX01JQzsKKyAgICAgICBjYXNlIDI6Cisg
ICAgICAgICAgICAgICByZXR1cm4gU09VTkRfTUFTS19MSU5FOworICAgICAgIGNhc2UgMzoKKyAg
ICAgICAgICAgICAgIHJldHVybiBTT1VORF9NQVNLX0NEOworICAgICAgIGNhc2UgNjoKKyAgICAg
ICAgICAgICAgIHJldHVybiBTT1VORF9NQVNLX1BDTTsKKyAgICAgICBkZWZhdWx0OgorICAgICAg
ICAgICAgICAgcmV0dXJuIC0xOworICAgICAgIH0KK30KKworLyoKKyAqIEVuYWJsZS9kaXNhYmxl
IGRpZ2l0YWwgcmVzYW1wbGUgbW9kZSBpbiB0aGUgQUQxODQzLgorICoKKyAqIFRoZSBBRDE4NDMg
cmVxdWlyZXMgdGhhdCBBREwsIEFEUiwgREExIGFuZCBEQTIgYmUgcG93ZXJlZCBkb3duCisgKiB3
aGlsZSBzd2l0Y2hpbmcgbW9kZXMuICBTbyB3ZSBzYXZlIERBJ3Mgc3RhdGUsIHBvd2VyIHRoZW0g
ZG93biwKKyAqIHN3aXRjaCBpbnRvL291dCBvZiByZXNhbXBsZSBtb2RlLCBwb3dlciB0aGVtIHVw
LCBhbmQgcmVzdG9yZSBzdGF0ZS4KKyAqCisgKiBUaGlzIHdpbGwgY2F1c2UgYXVkaWJsZSBnbGl0
Y2hlcyBpZiBEL0Egb3IgQS9EIGlzIGdvaW5nIG9uLCBzbyB0aGUKKyAqIGRyaXZlciBkaXNhbGxv
d3MgdGhhdCAoaW4gbWl4ZXJfd3JpdGVfaW9jdGwoKSkuCisgKgorICogVGhlIG9wZW4gcXVlc3Rp
b24gaXMsIGlzIHRoaXMgd29ydGggZG9pbmc/ICBJJ20gbGVhdmluZyBpdCBpbiwKKyAqIGJlY2F1
c2UgaXQncyB3cml0dGVuLCBidXQuLi4KKyAqLworCit2b2lkIGFkMTg0M19zZXRfcmVzYW1wbGVf
bW9kZShhZDE4NDNfdCAqYWQxODQzLCBpbnQgb25vZmYpCit7CisgICAgICAgLyogU2F2ZSBEQSdz
IG11dGUgYW5kIGdhaW4gKGFkZHIgOS8xMCBpcyBhbmFsb2cgZ2Fpbi9hdHRlbnVhdGlvbikgKi8K
KyAgICAgICBpbnQgc2F2ZV9kYTEgPSBhZDE4NDMtPnJlYWQoYWQxODQzLT5jaGlwLCA5KTsKKyAg
ICAgICBpbnQgc2F2ZV9kYTIgPSBhZDE4NDMtPnJlYWQoYWQxODQzLT5jaGlwLCAxMCk7CisKKyAg
ICAgICAvKiBQb3dlciBkb3duIEEvRCBhbmQgRC9BLiAqLworICAgICAgIGFkMTg0M193cml0ZV9t
dWx0aShhZDE4NDMsIDQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICZhZDE4NDNfREExRU4s
IDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICZhZDE4NDNfREEyRU4sIDAsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICZhZDE4NDNfQURMRU4sIDAsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICZhZDE4NDNfQURSRU4sIDApOworCisgICAgICAgLyogU3dpdGNoIG1vZGUgKi8KKyAg
ICAgICBhZDE4NDNfd3JpdGVfYml0cyhhZDE4NDMsICZhZDE4NDNfRFJTRkxULCBvbm9mZik7CisK
KyAgICAgICAvKiBQb3dlciB1cCBBL0QgYW5kIEQvQS4gKi8KKyAgICAgICBhZDE4NDNfd3JpdGVf
bXVsdGkoYWQxODQzLCAzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0RBMUVO
LCAxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0RBMkVOLCAxLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0FETEVOLCAxLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAmYWQxODQzX0FEUkVOLCAxKTsKKworICAgICAgIC8qIFJlc3RvcmUgREEncyBtdXRl
IGFuZCBnYWluLiAqLworICAgICAgIGFkMTg0My0+d3JpdGUoYWQxODQzLT5jaGlwLCA5LCBzYXZl
X2RhMSk7CisgICAgICAgYWQxODQzLT53cml0ZShhZDE4NDMtPmNoaXAsIDEwLCBzYXZlX2RhMik7
Cit9CisKKy8qCisgKiBTZXQgcmVjb3JkaW5nIHNvdXJjZS4gIEFyZyBuZXdzcmMgc3BlY2lmaWVz
IGFuIE9TUyBjaGFubmVsIG1hc2suCisgKgorICogVGhlIGNvbXBsaWNhdGlvbiBpcyB0aGF0IHdo
ZW4gd2Ugc3dpdGNoIGludG8vb3V0IG9mIGxvb3BiYWNrIG1vZGUKKyAqIChpLmUuLCBzcmMgPSBT
T1VORF9NQVNLX1BDTSksIHdlIGNoYW5nZSB0aGUgQUQxODQzIGludG8vb3V0IG9mCisgKiBkaWdp
dGFsIHJlc2FtcGxpbmcgbW9kZS4KKyAqCisgKiBSZXR1cm5zIG5ld3NyYyBvbiBzdWNjZXNzLCAt
ZXJybm8gb24gZmFpbHVyZS4KKyAqLworCitpbnQgYWQxODQzX3NldF9yZWNzcmMoYWQxODQzX3Qg
KmFkMTg0MywgaW50IG5ld3NyYykKK3sKKyAgICAgICBpbnQgYml0czsKKyAgICAgICBpbnQgb2xk
Yml0czsKKworICAgICAgIHN3aXRjaCAobmV3c3JjKSB7CisgICAgICAgY2FzZSBTT1VORF9NQVNL
X1BDTToKKyAgICAgICAgICAgICAgIGJpdHMgPSA2OworICAgICAgICAgICAgICAgYnJlYWs7CisK
KyAgICAgICBjYXNlIFNPVU5EX01BU0tfTUlDOgorICAgICAgICAgICAgICAgYml0cyA9IDE7Cisg
ICAgICAgICAgICAgICBicmVhazsKKworICAgICAgIGNhc2UgU09VTkRfTUFTS19MSU5FOgorICAg
ICAgICAgICAgICAgYml0cyA9IDI7CisgICAgICAgICAgICAgICBicmVhazsKKworICAgICAgIGNh
c2UgU09VTkRfTUFTS19DRDoKKyAgICAgICAgICAgICAgIGJpdHMgPSAzOworICAgICAgICAgICAg
ICAgYnJlYWs7CisKKyAgICAgICBkZWZhdWx0OgorICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7CisgICAgICAgfQorICAgICAgIG9sZGJpdHMgPSBhZDE4NDNfcmVhZF9iaXRzKGFkMTg0Mywg
JmFkMTg0M19MU1MpOworICAgICAgIGlmIChuZXdzcmMgPT0gU09VTkRfTUFTS19QQ00gJiYgb2xk
Yml0cyAhPSA2KSB7CisKKyAgICAgICAgICAgICAgIGFkMTg0M19zZXRfcmVzYW1wbGVfbW9kZShh
ZDE4NDMsIDEpOworICAgICAgICAgICAgICAgYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgMiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX0RBQURMLCAyLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZhZDE4NDNfREFBRFIsIDIpOworICAgICAg
IH0gZWxzZSBpZiAobmV3c3JjICE9IFNPVU5EX01BU0tfUENNICYmIG9sZGJpdHMgPT0gNikgewor
CisgICAgICAgICAgICAgICBhZDE4NDNfc2V0X3Jlc2FtcGxlX21vZGUoYWQxODQzLCAwKTsKKyAg
ICAgICAgICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19EQUFETCwgMCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAmYWQxODQzX0RBQURSLCAwKTsKKyAgICAgICB9CisgICAgICAgYWQx
ODQzX3dyaXRlX211bHRpKGFkMTg0MywgMiwgJmFkMTg0M19MU1MsIGJpdHMsICZhZDE4NDNfUlNT
LCBiaXRzKTsKKyAgICAgICByZXR1cm4gbmV3c3JjOworfQorCisvKgorICogUmV0dXJuIGN1cnJl
bnQgb3V0cHV0IHNvdXJjZXMsIGluIE9TUyBmb3JtYXQuCisgKi8KKworaW50IGFkMTg0M19nZXRf
b3V0c3JjKGFkMTg0M190ICphZDE4NDMpCit7CisgICAgICAgaW50IHBjbSwgbGluZSwgbWljLCBj
ZDsKKworICAgICAgIHBjbSAgPSBhZDE4NDNfcmVhZF9iaXRzKGFkMTg0MywgJmFkMTg0M19MREEx
R00pID8gMCA6IFNPVU5EX01BU0tfUENNOworICAgICAgIGxpbmUgPSBhZDE4NDNfcmVhZF9iaXRz
KGFkMTg0MywgJmFkMTg0M19MWDFNTSkgID8gMCA6IFNPVU5EX01BU0tfTElORTsKKyAgICAgICBj
ZCAgID0gYWQxODQzX3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfTFgyTU0pICA/IDAgOiBTT1VO
RF9NQVNLX0NEOworICAgICAgIG1pYyAgPSBhZDE4NDNfcmVhZF9iaXRzKGFkMTg0MywgJmFkMTg0
M19MTUNNTSkgID8gMCA6IFNPVU5EX01BU0tfTUlDOworCisgICAgICAgcmV0dXJuIHBjbSB8IGxp
bmUgfCBjZCB8IG1pYzsKK30KKworLyoKKyAqIFNldCBvdXRwdXQgc291cmNlcy4gIEFyZyBpcyBh
IG1hc2sgb2YgYWN0aXZlIHNvdXJjZXMgaW4gT1NTIGZvcm1hdC4KKyAqCisgKiBSZXR1cm5zIHNv
dXJjZSBtYXNrIG9uIHN1Y2Nlc3MsIC1lcnJubyBvbiBmYWlsdXJlLgorICovCisKK2ludCBhZDE4
NDNfc2V0X291dHNyYyhhZDE4NDNfdCAqYWQxODQzLCBpbnQgbWFzaykKK3sKKyAgICAgICBpbnQg
cGNtLCBsaW5lLCBtaWMsIGNkOworCisgICAgICAgaWYgKG1hc2sgJiB+KFNPVU5EX01BU0tfUENN
IHwgU09VTkRfTUFTS19MSU5FIHwKKyAgICAgICAgICAgICAgICAgICAgU09VTkRfTUFTS19DRCB8
IFNPVU5EX01BU0tfTUlDKSkKKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOworICAgICAg
IHBjbSAgPSAobWFzayAmIFNPVU5EX01BU0tfUENNKSAgPyAwIDogMTsKKyAgICAgICBsaW5lID0g
KG1hc2sgJiBTT1VORF9NQVNLX0xJTkUpID8gMCA6IDE7CisgICAgICAgbWljICA9IChtYXNrICYg
U09VTkRfTUFTS19NSUMpICA/IDAgOiAxOworICAgICAgIGNkICAgPSAobWFzayAmIFNPVU5EX01B
U0tfQ0QpICAgPyAwIDogMTsKKworICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIs
ICZhZDE4NDNfTERBMUdNLCBwY20sICZhZDE4NDNfUkRBMUdNLCBwY20pOworICAgICAgIGFkMTg0
M193cml0ZV9tdWx0aShhZDE4NDMsIDIsICZhZDE4NDNfTFgxTU0sIGxpbmUsICZhZDE4NDNfUlgx
TU0sIGxpbmUpOworICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIsICZhZDE4NDNf
TFgyTU0sIGNkLCAgICZhZDE4NDNfUlgyTU0sIGNkKTsKKyAgICAgICBhZDE4NDNfd3JpdGVfbXVs
dGkoYWQxODQzLCAyLCAmYWQxODQzX0xNQ01NLCBtaWMsICAmYWQxODQzX1JNQ01NLCBtaWMpOwor
CisgICAgICAgcmV0dXJuIG1hc2s7Cit9CisKKy8qIFNldHVwIGFkMTg0MyBmb3IgRC9BIGNvbnZl
cnNpb24uICovCisKK3ZvaWQgYWQxODQzX3NldHVwX2RhYyhhZDE4NDNfdCAqYWQxODQzLAorICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpZCwKKyAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgZnJhbWVyYXRlLAorICAgICAgICAgICAgICAgICAgICAgIHNuZF9wY21f
Zm9ybWF0X3QgZm10LAorICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBjaGFubmVs
cykKK3sKKyAgICAgICBpbnQgYWRfZm10ID0gMCwgYWRfbW9kZSA9IDA7CisKKyAgICAgICBzd2l0
Y2ggKGZtdCkgeworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9TODogICAgICAgYWRfZm10
ID0gMDsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01fRk9STUFUX1U4OiAgICAgICBhZF9m
bXQgPSAwOyBicmVhazsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JNQVRfUzE2X0JFOiAgIGFk
X2ZtdCA9IDE7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9TMjRfQkU6ICAg
YWRfZm10ID0gMTsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01fRk9STUFUX01VX0xBVzog
ICBhZF9mbXQgPSAyOyBicmVhazsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JNQVRfQV9MQVc6
ICAgIGFkX2ZtdCA9IDM7IGJyZWFrOworICAgICAgIGRlZmF1bHQ6IHByaW50aygiZXJyayFcbiIp
OyBicmVhazsKKyAgICAgICB9CisKKyAgICAgICBzd2l0Y2ggKGNoYW5uZWxzKSB7CisgICAgICAg
Y2FzZSAyOiAgICAgICAgICAgICAgICAgYWRfbW9kZSA9IDA7IGJyZWFrOworICAgICAgIGNhc2Ug
MTogICAgICAgICAgICAgICAgIGFkX21vZGUgPSAxOyBicmVhazsKKyAgICAgICBkZWZhdWx0OiBw
cmludGsoImVycmshXG4iKTsgYnJlYWs7CisgICAgICAgfQorCisgICAgICAgIGlmKDEgPT0gaWQp
IHsKKwkJYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0MxQywgZnJhbWVyYXRlKTsK
KwkJYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgMiwKKwkJCSZhZDE4NDNfREExU00sIGFkX21v
ZGUsCisJCQkmYWQxODQzX0RBMUYsIGFkX2ZtdCk7CisJCWFkMTg0M193cml0ZV9iaXRzKGFkMTg0
MywgJmFkMTg0M19EQTFFTiwgMSk7CisKKyAgICAgICAgfSBlbHNlIHsKKwkJYWQxODQzX3dyaXRl
X2JpdHMoYWQxODQzLCAmYWQxODQzX0MyQywgZnJhbWVyYXRlKTsKKwkJYWQxODQzX3dyaXRlX211
bHRpKGFkMTg0MywgMiwKKwkJCSZhZDE4NDNfREEyU00sIGFkX21vZGUsCisJCQkmYWQxODQzX0RB
MkYsIGFkX2ZtdCk7CisJCWFkMTg0M193cml0ZV9iaXRzKGFkMTg0MywgJmFkMTg0M19EQTJFTiwg
MSk7CisgICAgICAgfQorfQorCit2b2lkIGFkMTg0M19zaHV0ZG93bl9kYWMoYWQxODQzX3QgKmFk
MTg0MywgdW5zaWduZWQgaW50IGlkKQoreworICAgICAgIGlmKGlkKQorICAgICAgICAgICAgICAg
YWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0RBMkYsIDEpOworICAgICAgICBlbHNl
CisgICAgICAgICAgICAgICBhZDE4NDNfd3JpdGVfYml0cyhhZDE4NDMsICZhZDE4NDNfREExRiwg
MSk7Cit9CisKK3ZvaWQgYWQxODQzX3NldHVwX2FkYyhhZDE4NDNfdCAqYWQxODQzLAorICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmcmFtZXJhdGUsCisgICAgICAgICAgICAgICAg
ICAgICAgc25kX3BjbV9mb3JtYXRfdCBmbXQsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IGNoYW5uZWxzKQoreworICAgICAgIGludCBkYV9mbXQgPSAwOworCisgICAgICAgc3dp
dGNoIChmbXQpIHsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JNQVRfUzg6ICAgICAgIGRhX2Zt
dCA9IDA7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9VODogICAgICAgZGFf
Zm10ID0gMDsgYnJlYWs7CisgICAgICAgY2FzZSBTTkRSVl9QQ01fRk9STUFUX1MxNl9CRTogICBk
YV9mbXQgPSAxOyBicmVhazsKKyAgICAgICBjYXNlIFNORFJWX1BDTV9GT1JNQVRfTVVfTEFXOiAg
IGRhX2ZtdCA9IDI7IGJyZWFrOworICAgICAgIGNhc2UgU05EUlZfUENNX0ZPUk1BVF9BX0xBVzog
ICAgZGFfZm10ID0gMzsgYnJlYWs7CisgICAgICAgZGVmYXVsdDogcHJpbnRrKCJlcnJrIVxuIik7
IGJyZWFrOworICAgICAgIH0KKworICAgICAgIGFkMTg0M193cml0ZV9iaXRzKGFkMTg0MywgJmFk
MTg0M19DM0MsIGZyYW1lcmF0ZSk7CisgICAgICAgYWQxODQzX3dyaXRlX211bHRpKGFkMTg0Mywg
MiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19BRExGLCBkYV9mbXQsICZhZDE4
NDNfQURSRiwgZGFfZm10KTsKK30KKwordm9pZCBhZDE4NDNfc2h1dGRvd25fYWRjKGFkMTg0M190
ICphZDE4NDMpCit7CisgICAgICAgLyogbm90aGluZyB0byBkbyAqLworfQorCisvKgorICogRnVs
bHkgaW5pdGlhbGl6ZSB0aGUgYWQxODQzLiAgQXMgZGVzY3JpYmVkIGluIHRoZSBBRDE4NDMgZGF0
YQorICogc2hlZXQsIHNlY3Rpb24gIlNUQVJULVVQIFNFUVVFTkNFIi4gIFRoZSBudW1iZXJlZCBj
b21tZW50cyBhcmUKKyAqIHN1YnNlY3Rpb24gaGVhZGluZ3MgZnJvbSB0aGUgZGF0YSBzaGVldC4g
IFNlZSB0aGUgZGF0YSBzaGVldCwgcGFnZXMKKyAqIDUyLTU0LCBmb3IgbW9yZSBpbmZvLgorICoK
KyAqIHJldHVybiAwIG9uIHN1Y2Nlc3MsIC1lcnJubyBvbiBmYWlsdXJlLiAgKi8KKworaW50IGFk
MTg0M19pbml0KGFkMTg0M190ICphZDE4NDMpCit7CisgICAgICAgdW5zaWduZWQgbG9uZyBsYXRl
cjsKKworCS8qIDEuIFBvd2VyIHVwIGluIGhhcmR3YXJlICovCisKKwkvKiAyLiBBc3NlcnQgXlJF
U0VUXiB0byAwLCB3YWl0IDEwMG5zCisJICogMy4gRGVhc3NlcnQgXlJFU0VUXiBfNDAwIHRvIDgw
MHVzLCBwb2xsIElOSVQgdG8gc2VlIHdoZW4gcmVhZHkKKwkgKiBEb25lIGluIGNhbGxpbmcgZHJp
dmVyICovCisKKwkvKnNldCBzZXJpYWwgYnVzIHNwZWVkICovCisJYWQxODQzX3dyaXRlX2JpdHMo
YWQxODQzLCAmYWQxODQzX1NDRiwgMSk7CisKKwkvKiBQb3dlciBkb3duIGNvbnYgcmVzb3VyY2Vz
ICovCisJYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX1BETkksIDEpOworCXVkZWxh
eSg4MDApOworCisJLyogMy4gQ2hlY2sgdGhhdCB0aGUgY2xvY2tzIGFyZSBzdGFibGUgKi8KKwlp
ZiAoYWQxODQzX3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfSU5JVCkgIT0gMCkgeworCQlwcmlu
dGsoS0VSTl9FUlIgImFkMTg0MzogQUQxODQzIENsb2NrcyBub3QgeWV0IHN0YWJsZVxuIik7CisJ
CXJldHVybiAtRUlPOworCX0KKworCS8qIDQuIFB1dCB0aGUgY29udmVyc2lvbiByZXNvdXJjZXMg
aW50byBzdGFuZGJ5IFBETkkgdG8gMAorCSAqIEZvcmNlIEVuYWJsZSBhdXRvIGNhbGlicmF0ZSBB
Q0VOIHRvIDEgKi8KKwlhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzLCAyLAorCQkmYWQxODQzX1BE
TkksIDAsICZhZDE4NDNfQUNFTiwgMSk7CisJbGF0ZXIgPSBqaWZmaWVzICsgSFogLyAyOyAgLyog
cm91Z2hseSBoYWxmIGEgc2Vjb25kICovCisKKwkvKiA1LiBXaGlsZSBpbiBzdGFuZGJ5CisJICog
UG93ZXIgdXAgdGhlIGNsb2NrIGdlbmVyYXRvcnMgYW5kIGVuYWJsZSBjbG9jayBvdXRwdXQgcGlu
cy4gKi8KKwlhZDE4NDNfd3JpdGVfbXVsdGkoYWQxODQzLCAxMCwgJmFkMTg0M19FTkNMS08sIDEs
CisJCSZhZDE4NDNfQzFFTiwgMSwgJmFkMTg0M19FTkNWMSwgMSwgJmFkMTg0M19FTkJUMSwgMSwK
KwkJJmFkMTg0M19DMkVOLCAxLCAmYWQxODQzX0VOQ1YyLCAxLCAmYWQxODQzX0VOQlQyLCAxLAor
CQkmYWQxODQzX0MzRU4sIDEsICZhZDE4NDNfRU5DVjMsIDEsICZhZDE4NDNfRU5CVDMsIDEpOwor
CisJLyogNi4gQ29uZmlndXJlIGNvbnZlcnNpb24gcmVzb3VyY2VzIHdoaWxlIHRoZXkgYXJlIGlu
IHN0YW5kYnkuICovCisKKwkvKiBEQUMxLzIgdXNlIGNsb2NrIDEvMiBhcyBzb3VyY2UsIEFEQyB1
c2VzIGNsb2NrIDMuICBBbHdheXMuICovCisJYWQxODQzX3dyaXRlX211bHRpKGFkMTg0MywgNCwK
KwkJJmFkMTg0M19EQTFDLCAxLCAmYWQxODQzX0RBMkMsIDIsCisJCSZhZDE4NDNfQURMQywgMywg
JmFkMTg0M19BRFJDLCAzKTsKKworCS8qIERpZCB3ZSBjb21lIG91dCBvZiBzdGFuZGJ5ID8gKi8K
Kwl3aGlsZSAoYWQxODQzX3JlYWRfYml0cyhhZDE4NDMsICZhZDE4NDNfUEROTykpIHsKKwkJaWYg
KHRpbWVfYWZ0ZXIoamlmZmllcywgbGF0ZXIpKSB7CisJCQlwcmludGsoS0VSTl9FUlIgImFkMTg0
MzogQUQxODQzIHdvbid0IHBvd2VyIHVwXG4iKTsKKyAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIC1FSU87CisJCX0KKwkJc2NoZWR1bGUoKTsKKwl9CisKKwkvKiA3LiBFbmFibGUgY29udmVy
c2lvbiByZXNvdXJjZXMuICovCisJYWQxODQzX3dyaXRlX2JpdHMoYWQxODQzLCAmYWQxODQzX0FE
VExLLCAxKTsKKwkvKmFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDYsCisJCSZhZDE4NDNfQU5B
RU4sIDEsICZhZDE4NDNfQUFNRU4sIDEsCisJCSZhZDE4NDNfREExRU4sIDEsICZhZDE4NDNfREEy
RU4sIDEsCisJCSZhZDE4NDNfQURMRU4sIDEsICZhZDE4NDNfQURSRU4sIDEpOyovCisKKyAgICAg
ICAvKiA4LiBDb25maWd1cmUgY29udmVyc2lvbiByZXNvdXJjZXMgd2hpbGUgdGhleSBhcmUgZW5h
YmxlZC4gKi8KKworCisgICAgICAgLyogVW5tdXRlIGFsbCBjaGFubmVscy4gKi8KKworICAgICAg
IGFkMTg0M19zZXRfb3V0c3JjKGFkMTg0MywKKyAgICAgICAgICAgICAgICAgICAgICAgICAoU09V
TkRfTUFTS19QQ00gfCBTT1VORF9NQVNLX0xJTkUgfAorICAgICAgICAgICAgICAgICAgICAgICAg
ICBTT1VORF9NQVNLX01JQyB8IFNPVU5EX01BU0tfQ0QpKTsKKyAgICAgICBhZDE4NDNfd3JpdGVf
bXVsdGkoYWQxODQzLCA0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19MREEx
QU0sIDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWQxODQzX1JEQTFBTSwgMCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZhZDE4NDNfTERBMkFNLCAwLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmFkMTg0M19SREEyQU0sIDApOworCisgICAgICAgLyogU2V0IGRlZmF1
bHQgcmVjb3JkaW5nIHNvdXJjZSB0byBMaW5lIEluIGFuZCBzZXQKKyAgICAgICAgKiBtaWMgZ2Fp
biB0byArMjAgZEIuCisgICAgICAgICovCisgICAgICAgYWQxODQzX3NldF9yZWNzcmMoYWQxODQz
LCBTT1VORF9NQVNLX0xJTkUpOworICAgICAgIGFkMTg0M193cml0ZV9tdWx0aShhZDE4NDMsIDIs
ICZhZDE4NDNfTE1HRSwgMSwgJmFkMTg0M19STUdFLCAxKTsKKworICAgICAgIC8qIFNldCBTcGVh
a2VyIE91dCBsZXZlbCB0byArLy0gNFYgYW5kIHVubXV0ZSBpdC4gKi8KKyAgICAgICBhZDE4NDNf
d3JpdGVfbXVsdGkoYWQxODQzLCAzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0
M19IUE9TLCAxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19IUE9NLCAwLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkMTg0M19NUE9NLCAwKTsKKworICAgICAgIHJl
dHVybiAwOworfQoKZGlmZiAtTnUgbGludXgtMi42LjE5LjcuYi9zb3VuZC9taXBzL0tjb25maWcg
bGludXgtMi42LjE5Ljcvc291bmQvbWlwcy9LY29uZmlnCi0tLSBsaW51eC0yLjYuMTkuNy5iL3Nv
dW5kL21pcHMvS2NvbmZpZwkyMDA3LTAzLTEwIDEyOjExOjIzLjAwMDAwMDAwMCArMDAwMAorKysg
bGludXgtMi42LjE5Ljcvc291bmQvbWlwcy9LY29uZmlnCTIwMDctMDMtMTIgMTM6MzI6MjMuMDAw
MDAwMDAwICswMDAwCkBAIC0xMSw1ICsxMSwxMSBAQAogCWhlbHAKIAkgIEFMU0EgU291bmQgZHJp
dmVyIGZvciB0aGUgQXUxeDAwJ3MgQUM5NyBwb3J0LgogCitjb25maWcgU05EX01BQ0VfQVVESU8K
Kwl0cmlzdGF0ZSAiU0dJIE8yIE1BQ0UgQXVkaW8iCisJZGVwZW5kcyBvbiAgU05EICYmIFNHSV9J
UDMyCisJaGVscAorCVNvdW5kIHN1cHBvcnQgZm9yIHRoZSBTR0kgTzIgV29ya3N0YXRpb24uCisK
IGVuZG1lbnUKIApkaWZmIC1OdSBsaW51eC0yLjYuMTkuNy5iL3NvdW5kL21pcHMvbWFjZV9hdWRp
by5jIGxpbnV4LTIuNi4xOS43L3NvdW5kL21pcHMvbWFjZV9hdWRpby5jCi0tLSBsaW51eC0yLjYu
MTkuNy5iL3NvdW5kL21pcHMvbWFjZV9hdWRpby5jCTE5NzAtMDEtMDEgMDE6MDA6MDAuMDAwMDAw
MDAwICswMTAwCisrKyBsaW51eC0yLjYuMTkuNy9zb3VuZC9taXBzL21hY2VfYXVkaW8uYwkyMDA3
LTAzLTEyIDEzOjM0OjI2LjAwMDAwMDAwMCArMDAwMApAQCAtMCwwICsxLDExNzUgQEAKKy8qCisg
KiAgIFNvdW5kIGRyaXZlciBmb3IgU2lsaWNvbiBHcmFwaGljcyBPMiBXb3Jrc3RhdGlvbnMgTUFD
RSBhdWRpbyBib2FyZC4KKyAqCisgKiAgIENvcHlyaWdodCAyMDA3IFRob3JiZW4gSsOkbmRsaW5n
IDx0ai50cmV2ZWx5YW5AZ21haWwuY29tPgorICogICBCYXNlZC9Db3BpZWQgaGVhdmlseSBvbi9m
cm9tIHNnaW8yYXVkaW8uYzoKKyAqICAgQ29weXJpZ2h0IDIwMDMgVml2aWVuIENoYXBwZWxpZXIg
PHZpdmllbi5jaGFwcGVsaWVyQGxpbnV4LW1pcHMub3JnPgorICoKKyAqICAgVGhpcyBwcm9ncmFt
IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkK
KyAqICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0
aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAgKGF0IHlvdXIgb3B0aW9uKSBh
bnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogICBidXQgV0lUSE9VVCBBTlkg
V0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogICBNRVJD
SEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhl
CisgKiAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgor
ICogICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZQorICogICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0
ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQorICogICBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUg
UGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNyBVU0EKKyAqCisgKi8KKwor
LyoKKyAqIE5vdGVzCisgKgorICogTWFjZSB0YWtlIDI0Yml0IGF1ZGlvIHN0b3JlZC90cmFuc2Zl
cmVkIGluIDMyIGJpdHMgYW5kIGNvbnZlcnRzCisgKiBpdCBpbiBoYXJkd2FyZSBiYWNrIHRvIDE2
LzhiaXQKKyAqCisgKiBBRDE4NDMgc3BlYyBzYXlzOgorICogIkRhdGEgaW4gYWxsIGZvdXIgZm9y
bWF0cyBpcyBhbHdheXMgdHJhbnNmZXJlZCBNU0IgZmlyc3QiCisgKiBUbyBtZSB0aGF0IHNheXMg
YmlnLWVuZGlhbgorICogU28gdGVsbCBBTFNBIHdlIG9ubHkgZG8gU05EUlZfUENNX0ZNVEJJVF9T
MjRfQkUKKyAqCisgKiBBcHBhcmVudGx5IFJBRDEgc2ltaWxhciBzZWUgSVAzMCBwYXRjaCBzZXQK
KyAqCisgKiBXaHkgcmV3cml0ZT8gTW9zdGx5IHNvIHRoYXQgSSBjYW4gdW5kZXJzdGFuZCB0aGUg
Y29kZSwgd3JpdGluZyBpcworICogYmV0dGVyIHRoZW4gcmVhZGluZyBmb3IgdGhhdCBwdXJwb3Nl
IEkgZmluZC4KKyAqLworLyogY2hhbm5lbCAwL0FEQywgMS9EQUMxIC0+IHBjbTAKKyAqIGNoYW5u
ZWwgMi9EQUMyIC0+IHBjbTEKKyAqLworCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqIGlu
Y2x1ZGUgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisjaW5jbHVkZSA8c291bmQv
ZHJpdmVyLmg+CisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1ZGUgPGxpbnV4L3dhaXQu
aD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+
CisjaW5jbHVkZSA8bGludXgvZ2ZwLmg+CisjaW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPgorI2lu
Y2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4L3BjaS5oPgorI2luY2x1
ZGUgPGxpbnV4L2xpc3QuaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGluZy5oPgorCisjaW5j
bHVkZSA8YXNtL2lwMzIvaXAzMl9pbnRzLmg+CisjaW5jbHVkZSA8YXNtL2lwMzIvbWFjZS5oPgor
CisjaW5jbHVkZSA8c291bmQvY29yZS5oPgorI2luY2x1ZGUgPHNvdW5kL2luaXR2YWwuaD4KKyNp
bmNsdWRlIDxzb3VuZC9jb250cm9sLmg+CisjaW5jbHVkZSA8c291bmQvcGNtLmg+CisjaW5jbHVk
ZSA8c291bmQvaW5pdHZhbC5oPgorI2luY2x1ZGUgPHNvdW5kL2luZm8uaD4KKworI2luY2x1ZGUg
PHNvdW5kL2FkMTg0My5oPgorCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBkZWZpbmVz
ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisKKy8qIDE6IHJlc2V0IGF1ZGlvIGlu
dGVyZmFjZSAqLworI2RlZmluZSBNQUNFX0FVRElPX0NUUkxfUkVTRVQgICAgICAgICAgMHgwMDAw
MDAwMQorLyogMTogY29kZWMgZGV0ZWN0ZWQgKi8KKyNkZWZpbmUgTUFDRV9BVURJT19DVFJMX0NP
REVDX1BSRVNFTlQgIDB4MDAwMDAwMDIKKy8qICAyLTggIDogY2hhbm5lbCAxIHdyaXRlIHB0ciBh
bGlhcyAqLworLyogIDktMTUgOiBjaGFubmVsIDIgcmVhZCBwdHIgYWxpYXMgKi8KKy8qIDE2LTIy
IDogY2hhbm5lbCAzIHJlYWQgcHRyIGFsaWFzICovCisvKiBsYXRjaGVkIHZvbHVtZSBidXR0b24g
Ki8KKyNkZWZpbmUgTUFDRV9BVURJT19DVFJMX1ZPTF9CVVRUT05fVVAgICBCSVQoMjQpCisvKiBs
YXRjaGVkIHZvbHVtZSBidXR0b24gKi8KKyNkZWZpbmUgTUFDRV9BVURJT19DVFJMX1ZPTF9CVVRU
T05fRE9XTiBCSVQoMjMpCisKKyNkZWZpbmUgTUFDRV9BVURJT19DT0RFQ19SRUFEKHJlZykgIChy
ZWcgPDwxNikgfCAweDAwMDEwMDAwCisjZGVmaW5lIE1BQ0VfQVVESU9fQ09ERUNfV1JJVEUocmVn
LCB2YWwpICgocmVnIDw8MTYpfHZhbCkgJiAweDAwRkVGRkZGCisKKyNkZWZpbmUgTUFDRV9BVURJ
T19SSU5HX1NISUZUIDEyCisjZGVmaW5lIE1BQ0VfQVVESU9fUklOR19TSVpFICgxIDw8IE1BQ0Vf
QVVESU9fUklOR19TSElGVCkKKyNkZWZpbmUgTUFDRV9BVURJT19SSU5HX01BU0sgKE1BQ0VfQVVE
SU9fUklOR19TSVpFIC0gMSkKKworLyogaW50IG9uIGJ1ZmZlciA+NTAlIGZ1bGwgKi8KKyNkZWZp
bmUgTUFDRV9BVURJT19JTlRfVEhSRVNIT0xEXzUwICgyIDw8IDUpCisvKiAxOiBlbmFibGUgRE1B
IHRyYW5zZmVyICovCisjZGVmaW5lIE1BQ0VfQVVESU9fRE1BX0VOQUJMRSAgIEJJVCg5KQorCisv
Km9sZCwgZGVmaW5lIHN0aWxsIGluaGVydGVkIGZyb20gc2dpbzJhdWRpbyovCisKKyNkZWZpbmUg
TUFDRV9BVURJT19QVFJfU0hJRlQgICAgIDUKKyNkZWZpbmUgTUFDRV9BVURJT19QVFJfTUFTSyAg
ICAgICgoMSA8PCA2KSAtIDEpCisjZGVmaW5lIE1BQ0VfQVVESU9fQ1RSTF9DSEFOX1JFU0VUIEJJ
VCgxMCkgLyogMTogcmVzZXQgY2hhbm5lbCAqLworCisjZGVmaW5lIE1BQ0VfQVVESU9fSU5UX1RI
UkVTSE9MRF9ESVNBQkxFRCAgKDAgPDwgNSkgLyogaW50ZXJydXB0IGRpc2FibGVkICovCisjZGVm
aW5lIE1BQ0VfQVVESU9fSU5UX1RIUkVTSE9MRF8yNSAoMSA8PCA1KSAvKiBpbnQgb24gYnVmZmVy
ID4yNSUgZnVsbCAqLworI2RlZmluZSBNQUNFX0FVRElPX0lOVF9USFJFU0hPTERfNzUgKDMgPDwg
NSkgLyogaW50IG9uIGJ1ZmZlciA+NzUlIGZ1bGwgKi8KKyNkZWZpbmUgTUFDRV9BVURJT19JTlRf
VEhSRVNIT0xEX0VNUFRZICAgICAoNCA8PCA1KSAvKiBpbnQgb24gYnVmZmVyIGVtcHR5ICovCisj
ZGVmaW5lIE1BQ0VfQVVESU9fSU5UX1RIUkVTSE9MRF9OT1RfRU1QVFkgKDUgPDwgNSkgLyogaW50
IG9uIGJ1ZmZlciAhZW1wdHkgKi8KKyNkZWZpbmUgTUFDRV9BVURJT19JTlRfVEhSRVNIT0xEX0ZV
TEwgICAgICAoNiA8PCA1KSAvKiBpbnQgb24gYnVmZmVyIGVtcHR5ICovCisjZGVmaW5lIE1BQ0Vf
QVVESU9fSU5UX1RIUkVTSE9MRF9OT1RfRlVMTCAgKDcgPDwgNSkgLyogaW50IG9uIGJ1ZmZlciAh
ZW1wdHkgKi8KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBzdHJ1Y3RzL3R5cGVz
ICoqKioqKioqKioqKioqKioqKioqKioqLworCisvKiBjaGlwIHNwZWNpZmljIHJlY29yZCAqLwor
dHlwZWRlZiBzdHJ1Y3Qgc25kX21hY2VfYXVkaW8geworCXNuZF9jYXJkX3QgKmNhcmQ7CisJc25k
X3BjbV90ICAqcGNtWzJdOworCisJc3RydWN0IHsKKwkJc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vi
c3RyZWFtOworCQlzbmRfcGNtX3VmcmFtZXNfdCAgICAgICAgZnJhbWVzOworCisJCXZvaWQgICAg
ICAgICAgICAgICAgKmJ1ZmZlcjsKKwkJdW5zaWduZWQgaW50ICAgICAgICAgcG9zOworCQlzcGlu
bG9ja190ICAgICAgICAgICBsb2NrOworCX0gY2hhbm5lbFszXTsKKworCS8qIHdoaWNoIGdhaW4g
c2hvdWxkIHRoZSBPMiB2b2wgYnV0b25zIGNvbnRyb2w/Ki8KKwl1bnNpZ25lZCBpbnQgZXh0X3Zv
bF9mb3I7CisKKwlzbmRfaW5mb19lbnRyeV90ICAqcHJvYzsKKworCWFkMTg0M190ICAgKmFkMTg0
MzsKKwlzcGlubG9ja190IGFkMTg0M19sb2NrOworCisJdm9pZCAgICAgICAgKnJpbmdfYmFzZTsK
KwlkbWFfYWRkcl90ICAgcmluZ19iYXNlX2hhbmRsZTsKKworCXZvaWQgICAgICAgKmFsc2FfZG1h
X2Jhc2U7CisKK30gc25kX21hY2VfYXVkaW9fdDsKKwordHlwZWRlZiBzdHJ1Y3Qgc25kX21hY2Vf
YXVkaW9fcHJvY19lbnRyeSB7CisJc3RydWN0IGxpc3RfaGVhZCBsaW5rOworCisvKiBuYW1lIHRv
IGRpc3BsYXkgZm9yIHRoZSBlbnRyeSAqLworCWNoYXIgICpuYW1lOworCisvKiBhIHN0cmluZyB2
YWx1ZSAqLworCWNoYXIgICp2YWxfc3RyOworCisvKiBhbiBpbnQgdmFsIHVzZWQgaWYgdmFsX3N0
ciBpcyBudWxsICovCisJbG9uZyB2YWxfaW50OworfSBzbmRfbWFjZV9hdWRpb19wcm9jX2VudHJ5
X3Q7CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKiBmdW5jIGRlY2xhcmF0aW9uICoqKioq
KioqKioqKioqKioqKioqKioqKioqKiovCisvKiBtYWNlIGFjY2VzcyAqLworc3RhdGljIGludCBt
YWNlX2F1ZGlvX3JlZ19yZWFkKHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIGludCByZWcpOworc3Rh
dGljIGludCBtYWNlX2F1ZGlvX3JlZ193cml0ZShzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQg
cmVnLCBpbnQgd29yZCk7CisvKiBwY20gKi8KK3N0YXRpYyBpbnQgc25kX21hY2VfYXVkaW9fcGxh
eWJhY2tfb3BlbihzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pOworc3RhdGljIGludCBz
bmRfbWFjZV9hdWRpb19wbGF5YmFja19jbG9zZShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJl
YW0pOworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19jYXB0dXJlX29wZW4oc25kX3BjbV9zdWJz
dHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0YXRpYyBpbnQgc25kX21hY2VfYXVkaW9fY2FwdHVyZV9j
bG9zZShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pOworc3RhdGljIGludCBzbmRfbWFj
ZV9hdWRpb19od19wYXJhbQorCShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0sIHNuZF9w
Y21faHdfcGFyYW1zX3QgKmh3X3BhcmFtcyk7CitzdGF0aWMgaW50IHNuZF9tYWNlX2F1ZGlvX2h3
X2ZyZWUoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0YXRpYyBpbnQgc25kX21h
Y2VfYXVkaW9fcGNtX3ByZXBhcmUoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0
YXRpYyBpbnQgc25kX21hY2VfYXVkaW9fcGNtX3RyaWdnZXIoc25kX3BjbV9zdWJzdHJlYW1fdCAq
c3Vic3RyZWFtLCBpbnQgY21kKTsKK3N0YXRpYyBzbmRfcGNtX3VmcmFtZXNfdCBzbmRfbWFjZV9h
dWRpb19wY21fcG9pbnRlcgorCShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pOworc3Rh
dGljIHN0cnVjdCBwYWdlICpzbmRfbWFjZV9hdWRpb19wYWdlCisJKHNuZF9wY21fc3Vic3RyZWFt
X3QgKnN1YnN0cmVhbSwgdW5zaWduZWQgbG9uZyBvZmZzZXQpOworc3RhdGljIGludCBfX2Rldmlu
aXQgc25kX21hY2VfYXVkaW9fcGNtX25ldyhzbmRfbWFjZV9hdWRpb190ICpjaGlwKTsKKy8qIGlu
dGVycnVwdCBhbmQgRE1BIGVuZ2luZSAqLworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19kbWFf
c3RhcnQoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0YXRpYyBpbnQgc25kX21h
Y2VfYXVkaW9fZG1hX3N0b3Aoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKTsKK3N0YXRp
YyBpbnQgc25kX21hY2VfYXVkaW9fZG1hX3B1c2goc25kX21hY2VfYXVkaW9fdCAqY2hpcCwgaW50
IGNoaSk7CitzdGF0aWMgaXJxcmV0dXJuX3Qgc25kX21hY2VfYXVkaW9faW50ZXJydXB0CisJKGlu
dCBpcnEsIHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKK3N0
YXRpYyB2b2lkIHNuZF9tYWNlX2F1ZGlvX2FkanVzdF92b2woc25kX21hY2VfYXVkaW9fdCAqY2hp
cCk7CisvKiBwcm9jLCBtaXhlciBhbmQgY29udHJvbHMgKi8KK3N0YXRpYyBpbnQgc25kX21hY2Vf
YXVkaW9fZ2Fpbl9pbmZvCisJKHNuZF9rY29udHJvbF90ICprY29udHJvbCwgc25kX2N0bF9lbGVt
X2luZm9fdCAqdWluZm8pOworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19nYWluX2dldAorCShz
bmRfa2NvbnRyb2xfdCAqa2NvbnRyb2wsIHNuZF9jdGxfZWxlbV92YWx1ZV90ICp1Y29udHJvbCk7
CitzdGF0aWMgaW50IHNuZF9tYWNlX2F1ZGlvX2dhaW5fcHV0CisJKHNuZF9rY29udHJvbF90ICpr
Y29udHJvbCwgc25kX2N0bF9lbGVtX3ZhbHVlX3QgKnVjb250cm9sKTsKK3N0YXRpYyBpbnQgX19k
ZXZpbml0IHNuZF9tYWNlX2F1ZGlvX2NvbnRyb2xfbmV3KHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAp
Oworc3RhdGljIHZvaWQgc25kX21hY2VfYXVkaW9fcHJvY19yZWFkCisJKHNuZF9pbmZvX2VudHJ5
X3QgKiwgc25kX2luZm9fYnVmZmVyX3QgKik7CitzdGF0aWMgc25kX21hY2VfYXVkaW9fcHJvY19l
bnRyeV90KiBzbmRfbWFjZV9hdWRpb19wcm9jX2VudHJ5X2FwcGVuZChjaGFyICpuYW1lKTsKKy8q
IEFMU0EgU2V0dXAgKi8KK3N0YXRpYyBpbnQgc25kX21hY2VfYXVkaW9fZnJlZShzbmRfbWFjZV9h
dWRpb190ICpjaGlwKTsKK3N0YXRpYyBpbnQgX19kZXZpbml0IHNuZF9tYWNlX2F1ZGlvX2NyZWF0
ZQorCShzbmRfY2FyZF90ICpjYXJkLCBzbmRfbWFjZV9hdWRpb190ICoqcmNoaXApOworc3RhdGlj
IGludCBfX2RldmluaXQgc25kX21hY2VfYXVkaW9fcHJvYmUodm9pZCk7CisvKiBtb2R1bGUgc2V0
dXAgKi8KK3N0YXRpYyBpbnQgX19pbml0IHNuZF9jYXJkX21hY2VfYXVkaW9faW5pdCh2b2lkKTsK
K3N0YXRpYyB2b2lkIF9fZXhpdCBzbmRfY2FyZF9tYWNlX2F1ZGlvX2V4aXQodm9pZCk7CisKKwor
LyoqKioqKioqKioqKioqKioqKioqKioqKiogZGVmaW5lIHBzdWRvLWZ1bmNzICoqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KKyNkZWZpbmUgc25kX21hY2VfYXVkaW9fcHJvY19lbnRyeV9hc3Nl
cnQoZW50cnksbmFtZSkgXAorCWlmIChOVUxMID09IGVudHJ5KSBlbnRyeSA9IHNuZF9tYWNlX2F1
ZGlvX3Byb2NfZW50cnlfYXBwZW5kKG5hbWUpOworCisvKiBwY20wIHN1YnN0cmVhbTAgPSBjaGFu
bmVsIDEKKyAqIHBjbTAgc3Vic3RyZWFtMSA9IGNoYW5uZWwgMAorICogcGNtMSBzdWJzdHJlYW0w
ID0gY2hhbm5lbCAyCisgKi8KKyNkZWZpbmUgc3Vic3RyZWFtX3RvX2NoYW5uZWxfaW5kZXgoc3Vi
c3RyZWFtKSBcCisgKCgoKHNuZF9tYWNlX2F1ZGlvX3QqKShzdWJzdHJlYW0tPnByaXZhdGVfZGF0
YSkpLT5wY21bMF09PXN1YnN0cmVhbS0+cGNtKVwKKyA/IShzdWJzdHJlYW0tPm51bWJlcik6MikK
KworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIGdsb2JhbHMgKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKi8KKworLyogdXNpbmcgc2FtZSBmb3IgYWxsICovCitzdGF0aWMg
c3RydWN0IHNuZF9wY21faGFyZHdhcmUgc25kX21hY2VfYXVkaW9faHcgPSB7CisJLmluZm8gPSAo
U05EUlZfUENNX0lORk9fTU1BUCB8CisJICAgICAgICAgU05EUlZfUENNX0lORk9fSU5URVJMRUFW
RUQgfAorCSAgICAgICAgIFNORFJWX1BDTV9JTkZPX0JMT0NLX1RSQU5TRkVSIHwKKwkgICAgICAg
ICBTTkRSVl9QQ01fSU5GT19NTUFQX1ZBTElEKSwKKwkuZm9ybWF0cyA9ICAgICAgICAgICBTTkRS
Vl9QQ01fRk1UQklUX1MyNF9CRSwKKwkucmF0ZXMgPSAgICAgICAgICAgICBTTkRSVl9QQ01fUkFU
RV84MDAwXzQ4MDAwLAorCS5yYXRlX21pbiA9ICAgICAgICAgIDgwMDAsCisJLnJhdGVfbWF4ID0g
ICAgICAgICAgNDgwMDAsCisJLmNoYW5uZWxzX21pbiA9ICAgICAgMiwKKwkuY2hhbm5lbHNfbWF4
ID0gICAgICAyLAorICAgICAgICAuYnVmZmVyX2J5dGVzX21heCA9ICAzMjc2OCwKKwkucGVyaW9k
X2J5dGVzX21pbiA9ICA0MDk2LAorCS5wZXJpb2RfYnl0ZXNfbWF4ID0gIDMyNzY4LAorCS5wZXJp
b2RzX21pbiA9ICAgICAgIDEsCisJLnBlcmlvZHNfbWF4ID0gICAgICAgMTAyNCwKK307CisKKy8q
IHBsYXliYWNrIG9wZXJhdG9ycyAqLworc3RhdGljIHNuZF9wY21fb3BzX3Qgc25kX21hY2VfYXVk
aW9fcGxheWJhY2tfb3BzID0geworCS5vcGVuID0gICAgICAgc25kX21hY2VfYXVkaW9fcGxheWJh
Y2tfb3BlbiwKKwkuY2xvc2UgPSAgICAgIHNuZF9tYWNlX2F1ZGlvX3BsYXliYWNrX2Nsb3NlLAor
CS5pb2N0bCA9ICAgICAgc25kX3BjbV9saWJfaW9jdGwsCisJLmh3X3BhcmFtcyA9ICBzbmRfbWFj
ZV9hdWRpb19od19wYXJhbSwKKwkuaHdfZnJlZSA9ICAgIHNuZF9tYWNlX2F1ZGlvX2h3X2ZyZWUs
CisJLnByZXBhcmUgPSAgICBzbmRfbWFjZV9hdWRpb19wY21fcHJlcGFyZSwKKwkudHJpZ2dlciA9
ICAgIHNuZF9tYWNlX2F1ZGlvX3BjbV90cmlnZ2VyLAorCS5wb2ludGVyID0gICAgc25kX21hY2Vf
YXVkaW9fcGNtX3BvaW50ZXIsCisJLnBhZ2UgICAgPSAgICBzbmRfbWFjZV9hdWRpb19wYWdlLAor
fTsKKworLyogY2FwdHVyZSBvcGVyYXRvcnMgKi8KK3N0YXRpYyBzbmRfcGNtX29wc190IHNuZF9t
YWNlX2F1ZGlvX2NhcHR1cmVfb3BzID0geworCS5vcGVuID0gICAgICAgc25kX21hY2VfYXVkaW9f
Y2FwdHVyZV9vcGVuLAorCS5jbG9zZSA9ICAgICAgc25kX21hY2VfYXVkaW9fY2FwdHVyZV9jbG9z
ZSwKKwkuaW9jdGwgPSAgICAgIHNuZF9wY21fbGliX2lvY3RsLAorCS5od19wYXJhbXMgPSAgc25k
X21hY2VfYXVkaW9faHdfcGFyYW0sCisJLmh3X2ZyZWUgPSAgICBzbmRfbWFjZV9hdWRpb19od19m
cmVlLAorCS5wcmVwYXJlID0gICAgc25kX21hY2VfYXVkaW9fcGNtX3ByZXBhcmUsCisJLnRyaWdn
ZXIgPSAgICBzbmRfbWFjZV9hdWRpb19wY21fdHJpZ2dlciwKKwkucG9pbnRlciA9ICAgIHNuZF9t
YWNlX2F1ZGlvX3BjbV9wb2ludGVyLAorCS5wYWdlICAgID0gICAgc25kX21hY2VfYXVkaW9fcGFn
ZSwKK307CisKKy8qIHJlY29yZCBsZXZlbCBtaXhlciBjb250cm9sICovCitzdGF0aWMgc25kX2tj
b250cm9sX25ld190IHNuZF9tYWNlX2F1ZGlvX2N0cmxfcmVjbGV2ZWwgX19kZXZpbml0ZGF0YSA9
IHsKKwkuaWZhY2UgICAgICAgICAgPSBTTkRSVl9DVExfRUxFTV9JRkFDRV9NSVhFUiwKKwkubmFt
ZSAgICAgICAgICAgPSAiQ2FwdHVyZSBWb2x1bWUiLAorCS5hY2Nlc3MgICAgICAgICA9IFNORFJW
X0NUTF9FTEVNX0FDQ0VTU19SRUFEV1JJVEUsCisJLnByaXZhdGVfdmFsdWUgID0gQUQxODQzX0dB
SU5fUkVDTEVWLAorCS5pbmZvICAgICAgICAgICA9IHNuZF9tYWNlX2F1ZGlvX2dhaW5faW5mbywK
KwkuZ2V0ICAgICAgICAgICAgPSBzbmRfbWFjZV9hdWRpb19nYWluX2dldCwKKwkucHV0ICAgICAg
ICAgICAgPSBzbmRfbWFjZV9hdWRpb19nYWluX3B1dCwKK307CisKKy8qIGxpbmUgbWl4ZXIgY29u
dHJvbCAqLworc3RhdGljIHNuZF9rY29udHJvbF9uZXdfdCBzbmRfbWFjZV9hdWRpb19jdHJsX2xp
bmUgX19kZXZpbml0ZGF0YSA9IHsKKwkuaWZhY2UgICAgICAgICAgPSBTTkRSVl9DVExfRUxFTV9J
RkFDRV9NSVhFUiwKKwkubmFtZSAgICAgICAgICAgPSAiTGluZSBWb2x1bWUiLAorCS5hY2Nlc3Mg
ICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0FDQ0VTU19SRUFEV1JJVEUsCisJLnByaXZhdGVfdmFs
dWUgID0gQUQxODQzX0dBSU5fTElORSwKKwkuaW5mbyAgICAgICAgICAgPSBzbmRfbWFjZV9hdWRp
b19nYWluX2luZm8sCisJLmdldCAgICAgICAgICAgID0gc25kX21hY2VfYXVkaW9fZ2Fpbl9nZXQs
CisJLnB1dCAgICAgICAgICAgID0gc25kX21hY2VfYXVkaW9fZ2Fpbl9wdXQsCit9OworCisvKiBj
ZCBtaXhlciBjb250cm9sICovCitzdGF0aWMgc25kX2tjb250cm9sX25ld190IHNuZF9tYWNlX2F1
ZGlvX2N0cmxfY2QgX19kZXZpbml0ZGF0YSA9IHsKKwkuaWZhY2UgICAgICAgICAgPSBTTkRSVl9D
VExfRUxFTV9JRkFDRV9NSVhFUiwKKwkubmFtZSAgICAgICAgICAgPSAiQ0QgVm9sdW1lIiwKKwku
YWNjZXNzICAgICAgICAgPSBTTkRSVl9DVExfRUxFTV9BQ0NFU1NfUkVBRFdSSVRFLAorCS5wcml2
YXRlX3ZhbHVlICA9IEFEMTg0M19HQUlOX0NELAorCS5pbmZvICAgICAgICAgICA9IHNuZF9tYWNl
X2F1ZGlvX2dhaW5faW5mbywKKwkuZ2V0ICAgICAgICAgICAgPSBzbmRfbWFjZV9hdWRpb19nYWlu
X2dldCwKKwkucHV0ICAgICAgICAgICAgPSBzbmRfbWFjZV9hdWRpb19nYWluX3B1dCwKK307CisK
Ky8qIG1pYyBtaXhlciBjb250cm9sICovCitzdGF0aWMgc25kX2tjb250cm9sX25ld190IHNuZF9t
YWNlX2F1ZGlvX2N0cmxfbWljIF9fZGV2aW5pdGRhdGEgPSB7CisJLmlmYWNlICAgICAgICAgID0g
U05EUlZfQ1RMX0VMRU1fSUZBQ0VfTUlYRVIsCisJLm5hbWUgICAgICAgICAgID0gIk1pYyBWb2x1
bWUiLAorCS5hY2Nlc3MgICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0FDQ0VTU19SRUFEV1JJVEUs
CisJLnByaXZhdGVfdmFsdWUgID0gQUQxODQzX0dBSU5fTUlDLAorCS5pbmZvICAgICAgICAgICA9
IHNuZF9tYWNlX2F1ZGlvX2dhaW5faW5mbywKKwkuZ2V0ICAgICAgICAgICAgPSBzbmRfbWFjZV9h
dWRpb19nYWluX2dldCwKKwkucHV0ICAgICAgICAgICAgPSBzbmRfbWFjZV9hdWRpb19nYWluX3B1
dCwKK307CisKKy8qIGRhYzEvcGNtMCBtaXhlciBjb250cm9sICovCitzdGF0aWMgc25kX2tjb250
cm9sX25ld190IHNuZF9tYWNlX2F1ZGlvX2N0cmxfcGNtMCBfX2RldmluaXRkYXRhID0geworCS5p
ZmFjZSAgICAgICAgICA9IFNORFJWX0NUTF9FTEVNX0lGQUNFX01JWEVSLAorCS5uYW1lICAgICAg
ICAgICA9ICJQbGF5YmFjayBWb2x1bWUiLAorCS5hY2Nlc3MgICAgICAgICA9IFNORFJWX0NUTF9F
TEVNX0FDQ0VTU19SRUFEV1JJVEUsCisJLnByaXZhdGVfdmFsdWUgID0gQUQxODQzX0dBSU5fUENN
XzAsCisJLmluZm8gICAgICAgICAgID0gc25kX21hY2VfYXVkaW9fZ2Fpbl9pbmZvLAorCS5nZXQg
ICAgICAgICAgICA9IHNuZF9tYWNlX2F1ZGlvX2dhaW5fZ2V0LAorCS5wdXQgICAgICAgICAgICA9
IHNuZF9tYWNlX2F1ZGlvX2dhaW5fcHV0LAorfTsKKworLyogZGFjMi9wY20xIG1peGVyIGNvbnRy
b2wgKi8KK3N0YXRpYyBzbmRfa2NvbnRyb2xfbmV3X3Qgc25kX21hY2VfYXVkaW9fY3RybF9wY20x
IF9fZGV2aW5pdGRhdGEgPSB7CisJLmlmYWNlICAgICAgICAgID0gU05EUlZfQ1RMX0VMRU1fSUZB
Q0VfTUlYRVIsCisJLm5hbWUgICAgICAgICAgID0gIlBsYXliYWNrIE91dC0yIFZvbHVtZSIsCisJ
LmFjY2VzcyAgICAgICAgID0gU05EUlZfQ1RMX0VMRU1fQUNDRVNTX1JFQURXUklURSwKKwkucHJp
dmF0ZV92YWx1ZSAgPSBBRDE4NDNfR0FJTl9QQ01fMSwKKwkuaW5mbyAgICAgICAgICAgPSBzbmRf
bWFjZV9hdWRpb19nYWluX2luZm8sCisJLmdldCAgICAgICAgICAgID0gc25kX21hY2VfYXVkaW9f
Z2Fpbl9nZXQsCisJLnB1dCAgICAgICAgICAgID0gc25kX21hY2VfYXVkaW9fZ2Fpbl9wdXQsCit9
OworCisKK0xJU1RfSEVBRChzbmRfbWFjZV9hdWRpb19wcm9jX2xpc3QpOworCitzdGF0aWMgaW50
ICAgYWxzYV9pbmRleCA9IC0xOworc3RhdGljIGNoYXIgKmFsc2FfaWQgICAgPSBOVUxMOworc3Rh
dGljIGludCAgIGFsc2FfZW5hYmxlPSAxOworCisvKiBHbG9iYWwgbmVlZGVkIGZvciBtb2R1bGUg
ZXhpdCAqLworc25kX21hY2VfYXVkaW9fdCAqc25kX21hY2VfYXVkaW9fY2hpcCA9IE5VTEw7CisK
Ky8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBDTSAqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqLworCisvKiB0ZW1wIGRlYnVnIGZ1bmMgKi8KK3N0YXRpYyB2
b2lkIHByaW50X3BvaW50ZXJzKGNvbnN0IGNoYXIgKnN0cikKK3sKKwl1bnNpZ25lZCBsb25nIHJi
LCB3cCwgcnAsIGRlcHRoOworCWludCBjaGk7CisKKwlyYiA9IHJlYWRxKCZtYWNlLT5wZXJpZi5j
dHJsLnJpbmdiYXNlKTsKKwlwcmludGsgKCIlcy4gcmluZ2Jhc2U9MHglbFgsXG4iLCBzdHIsIHJi
KTsKKworCWZvciAoY2hpPTA7IGNoaTwzOyBjaGkrKykgeworCisJCXdwID0gcmVhZHEoJm1hY2Ut
PnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS53cml0ZV9wdHIpOworCQlycCA9IHJlYWRxKCZtYWNlLT5w
ZXJpZi5hdWRpby5jaGFuW2NoaV0ucmVhZF9wdHIpOworCQlkZXB0aCA9IHJlYWRxKCZtYWNlLT5w
ZXJpZi5hdWRpby5jaGFuW2NoaV0uZGVwdGgpOworCisJCXByaW50aygiXHQlZFsgd3JpdGVwPTB4
JWxYICglbGQpLCByZWFkcD0weCVsWCAoJWxkKSwgIgorCQkJImRlcHRoPTB4JWxYICglbGQpIF1c
biIsCisJCQljaGksIHdwLCB3cCwgcnAsIHJwLCBkZXB0aCwgZGVwdGgpOworCX0KKworfQorCisv
KiBwbGF5IG9wZW4gY2FsbGJhY2sgKi8KK3N0YXRpYyBpbnQgc25kX21hY2VfYXVkaW9fcGxheWJh
Y2tfb3BlbihzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pCit7CisJLy9zbmRfbWFjZV9h
dWRpb190ICpjaGlwID0gc25kX3BjbV9zdWJzdHJlYW1fY2hpcChzdWJzdHJlYW0pOworCXNuZF9w
Y21fcnVudGltZV90ICpydW50aW1lID0gc3Vic3RyZWFtLT5ydW50aW1lOworcHJpbnRrKCJpbiBw
bGF5YmFjayBvcGVuXG4iKTsKKworCXJ1bnRpbWUtPmh3ID0gc25kX21hY2VfYXVkaW9faHc7CisK
KwlyZXR1cm4gMDsKK30KKworLyogcGxheSBjbG9zZSBjYWxsYmFjayAqLworc3RhdGljIGludCBz
bmRfbWFjZV9hdWRpb19wbGF5YmFja19jbG9zZShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJl
YW0pCit7CisJLy9zbmRfbWFjZV9hdWRpb190ICpjaGlwID0gc25kX3BjbV9zdWJzdHJlYW1fY2hp
cChzdWJzdHJlYW0pOworCS8vRklYTUUgY29kZQorcHJpbnRrKCJpbiBwbGF5YmFjayBjbG9zZVxu
Iik7CisKKwlyZXR1cm4gMDsKK30KKworLyogY2FwdHVyZSBvcGVuIGNhbGxiYWNrICovCitzdGF0
aWMgaW50IHNuZF9tYWNlX2F1ZGlvX2NhcHR1cmVfb3BlbihzbmRfcGNtX3N1YnN0cmVhbV90ICpz
dWJzdHJlYW0pCit7CisJLy9zbmRfbWFjZV9hdWRpb190ICpjaGlwID0gc25kX3BjbV9zdWJzdHJl
YW1fY2hpcChzdWJzdHJlYW0pOworCXNuZF9wY21fcnVudGltZV90ICpydW50aW1lID0gc3Vic3Ry
ZWFtLT5ydW50aW1lOworcHJpbnRrKCJpbiBjYXB0dXJlIG9wZW5cbiIpOworCisJcnVudGltZS0+
aHcgPSBzbmRfbWFjZV9hdWRpb19odzsKKworCXJldHVybiAwOworfQorCisvKiBjbG9zZSBjYWxs
YmFjayAqLworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19jYXB0dXJlX2Nsb3NlKHNuZF9wY21f
c3Vic3RyZWFtX3QgKnN1YnN0cmVhbSkKK3sKKwkvL3NuZF9tYWNlX2F1ZGlvX3QgKmNoaXAgPSBz
bmRfcGNtX3N1YnN0cmVhbV9jaGlwKHN1YnN0cmVhbSk7CisJLy9GSVhNRSBjb2RlCitwcmludGso
ImluIGNhcHR1cmUgY2xvc2VcbiIpOworCisJcmV0dXJuIDA7Cit9CisKKy8qIHNldHVwIGh3IGZv
ciBwY20gKi8KKy8qIG1heWJlIGNhbGxlZCBtb3JlIHRoZW4gb25jZSAqLworc3RhdGljIGludCBz
bmRfbWFjZV9hdWRpb19od19wYXJhbQorCShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0s
IHNuZF9wY21faHdfcGFyYW1zX3QgKmh3X3BhcmFtcykKK3sKKwkvL3NuZF9tYWNlX2F1ZGlvX3Qg
KmNoaXAgPSBzbmRfcGNtX3N1YnN0cmVhbV9jaGlwKHN1YnN0cmVhbSk7CisJaW50IGNoaSA9IHN1
YnN0cmVhbV90b19jaGFubmVsX2luZGV4KHN1YnN0cmVhbSk7CitwcmludGsoIkluIGh3IHBhcmFt
IGZvciBjaGFubmVsICVkXG4iLCBjaGkpOworCisJaWYgKE5VTEwgIT0gc3Vic3RyZWFtLT5ydW50
aW1lLT5kbWFfYXJlYSkKKwkJdmZyZWUoc3Vic3RyZWFtLT5ydW50aW1lLT5kbWFfYXJlYSk7CisK
KwlzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9ieXRlcyA9IHBhcmFtc19idWZmZXJfYnl0ZXMoaHdf
cGFyYW1zKTsKKwlzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hcmVhID0KKwkJdm1hbGxvY191c2Vy
KHN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2J5dGVzKTsKKworLyoKKwlzdWJzdHJlYW0tPnJ1bnRp
bWUtPmRtYV9ieXRlcyA9IE1BQ0VfQVVESU9fUklOR19TSVpFOworCXN1YnN0cmVhbS0+cnVudGlt
ZS0+ZG1hX2FyZWEgPQorCQkoY2hpcC0+YWxzYV9kbWFfYmFzZSArIChjaGkgPDwgTUFDRV9BVURJ
T19SSU5HX1NISUZUKSk7CisqLworCQorCWlmIChOVUxMID09IHN1YnN0cmVhbS0+cnVudGltZS0+
ZG1hX2FyZWEpIHJldHVybiAtRU5PTUVNOworCisJcmV0dXJuIDA7Cit9CisKKy8qIGZyZWUgaHcg
Zm9yIHBjbSAqLworLyogbWF5YmUgY2FsbGVkIG1vcmUgdGhlbiBvbmNlICovCitzdGF0aWMgaW50
IHNuZF9tYWNlX2F1ZGlvX2h3X2ZyZWUoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKQor
eworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAgPSBzbmRfcGNtX3N1YnN0cmVhbV9jaGlwKHN1YnN0
cmVhbSk7CisJaW50IGNoaSA9IHN1YnN0cmVhbV90b19jaGFubmVsX2luZGV4KHN1YnN0cmVhbSk7
CitwcmludGsoIkluIGh3IGZyZWUgZm9yIGNoYW5uZWwgJWRcbiIsIGNoaSk7CisKKwlpZiAoTlVM
TCAhPSBzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hcmVhKQorCQl2ZnJlZShzdWJzdHJlYW0tPnJ1
bnRpbWUtPmRtYV9hcmVhKTsKKworCXN1YnN0cmVhbS0+cnVudGltZS0+ZG1hX2J5dGVzID0gMDsK
KwlzdWJzdHJlYW0tPnJ1bnRpbWUtPmRtYV9hcmVhID0gTlVMTDsKKwljaGlwLT5jaGFubmVsW2No
aV0uYnVmZmVyID0gTlVMTDsKKwljaGlwLT5jaGFubmVsW2NoaV0ucG9zID0gMDsKKwljaGlwLT5j
aGFubmVsW2NoaV0uZnJhbWVzID0gMDsKKworCXJldHVybiAwOworfQorCisvKiBwcmVwYXJlIGNh
bGxiYWNrICovCitzdGF0aWMgaW50IHNuZF9tYWNlX2F1ZGlvX3BjbV9wcmVwYXJlKHNuZF9wY21f
c3Vic3RyZWFtX3QgKnN1YnN0cmVhbSkKK3sKKwlzbmRfbWFjZV9hdWRpb190ICpjaGlwID0gc25k
X3BjbV9zdWJzdHJlYW1fY2hpcChzdWJzdHJlYW0pOworCXNuZF9wY21fcnVudGltZV90ICpydW50
aW1lID0gc3Vic3RyZWFtLT5ydW50aW1lOworCWludCBjaGkgPSBzdWJzdHJlYW1fdG9fY2hhbm5l
bF9pbmRleChzdWJzdHJlYW0pOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CitwcmludGsoIkluIHBj
bSBwcmVwYXJlIGZvciBjaGFubmVsICVkXG4iLCBjaGkpOworCisJc3Bpbl9sb2NrX2lycXNhdmUo
JmNoaXAtPmNoYW5uZWxbY2hpXS5sb2NrLCBmbGFncyk7CisKKwljaGlwLT5jaGFubmVsW2NoaV0u
cG9zID0gMDsKKwljaGlwLT5jaGFubmVsW2NoaV0uZnJhbWVzID0gMDsKKwljaGlwLT5jaGFubmVs
W2NoaV0uc3Vic3RyZWFtID0gc3Vic3RyZWFtOworCisJaWYgKDAgPT0gY2hpKSB7IC8qIGNhcHR1
cmUqLworcHJpbnRrKCJpbiBjYXB0dXJlXG4iKTsKKwkJYWQxODQzX3NldHVwX2FkYyhjaGlwLT5h
ZDE4NDMsCisJCQlydW50aW1lLT5yYXRlLAorCQkJU05EUlZfUENNX0ZPUk1BVF9TMjRfQkUsIC8q
MjRiaXQ/Ki8KKwkJCXJ1bnRpbWUtPmNoYW5uZWxzKTsKKwl9IGVsc2UgeyAvKiBwbGF5YmFjayAq
LworcHJpbnRrKCJpbiBwbGF5YmFjayBmb3IgY2hhbm5lbCAlZCwgcmF0ZSAlZCwgc3ViLWNoYW5u
ZWxzICVkXG4iLAorCWNoaSwgcnVudGltZS0+cmF0ZSwgcnVudGltZS0+Y2hhbm5lbHMpOworCisJ
CWFkMTg0M19zZXR1cF9kYWMoY2hpcC0+YWQxODQzLAorCQkJY2hpLAorCQkJcnVudGltZS0+cmF0
ZSwKKwkJCVNORFJWX1BDTV9GT1JNQVRfUzI0X0JFLCAvKjI0Yml0PyovCisJCQlydW50aW1lLT5j
aGFubmVscyk7CisJfQorCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+Y2hhbm5lbFtj
aGldLmxvY2ssIGZsYWdzKTsKKworCXJldHVybiAwOworfQorCisvKiB0cmlnZ2VyIGNhbGxiYWNr
ICovCitzdGF0aWMgaW50IHNuZF9tYWNlX2F1ZGlvX3BjbV90cmlnZ2VyKHNuZF9wY21fc3Vic3Ry
ZWFtX3QgKnN1YnN0cmVhbSwgaW50IGNtZCkKK3sKK3ByaW50aygiSW4gcGNtIHRyaWdnZXJcbiIp
OworCXN3aXRjaCAoY21kKSB7CisJY2FzZSBTTkRSVl9QQ01fVFJJR0dFUl9TVEFSVDogLyogc3Rh
cnQgUENNIGVuZ2luZSAqLworCQlzbmRfbWFjZV9hdWRpb19kbWFfc3RhcnQoc3Vic3RyZWFtKTsK
KwkJYnJlYWs7CisJY2FzZSBTTkRSVl9QQ01fVFJJR0dFUl9TVE9QOiAvKiBzdG9wIFBDTSBlbmdp
bmUgKi8KKwkJc25kX21hY2VfYXVkaW9fZG1hX3N0b3Aoc3Vic3RyZWFtKTsKKwkJYnJlYWs7CisJ
ZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0dXJuIDA7Cit9CisKKy8qIHBv
aW50ZXIgY2FsbGJhY2sgKi8KK3N0YXRpYyBzbmRfcGNtX3VmcmFtZXNfdCBzbmRfbWFjZV9hdWRp
b19wY21fcG9pbnRlcgorCShzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pCit7CisJc25k
X21hY2VfYXVkaW9fdCAqY2hpcCA9IHNuZF9wY21fc3Vic3RyZWFtX2NoaXAoc3Vic3RyZWFtKTsK
KwlpbnQgY2hpID0gc3Vic3RyZWFtX3RvX2NoYW5uZWxfaW5kZXgoc3Vic3RyZWFtKTsKKwlzbmRf
cGNtX3VmcmFtZXNfdCBjdXJyZW50X3B0cjsKKworcHJpbnRfcG9pbnRlcnMoIkluIHBjbSBwb2lu
dGVyIik7CisKKwljdXJyZW50X3B0ciA9IGJ5dGVzX3RvX2ZyYW1lcyhzdWJzdHJlYW0tPnJ1bnRp
bWUsCisJCWNoaXAtPmNoYW5uZWxbY2hpXS5wb3MpOworCisJcmV0dXJuIGN1cnJlbnRfcHRyOwor
fQorCisvKiBnZXQgcGFnZSBjYWxsYmFjayAqLworc3RhdGljIHN0cnVjdCBwYWdlICpzbmRfbWFj
ZV9hdWRpb19wYWdlCisJKHNuZF9wY21fc3Vic3RyZWFtX3QgKnN1YnN0cmVhbSwgdW5zaWduZWQg
bG9uZyBvZmZzZXQpCit7CisJcmV0dXJuIHZtYWxsb2NfdG9fcGFnZShzdWJzdHJlYW0tPnJ1bnRp
bWUtPmRtYV9hcmVhICsgb2Zmc2V0KTsKK30KKworLyogY3JlYXRlIHBjbSBkZXZpY2UgKi8KK3N0
YXRpYyBpbnQgX19kZXZpbml0IHNuZF9tYWNlX2F1ZGlvX3BjbV9uZXcoc25kX21hY2VfYXVkaW9f
dCAqY2hpcCkKK3sKKwlzbmRfcGNtX3QgKnBjbTsKKwlpbnQgZXJyLCBjaGk7CisKKwkvKiByZXNl
dCBjaGFubmVscyBhbmQgbGVhdmUgdGhlbSBvZmYgKi8KKwlmb3IgKGNoaT0wOyBjaGk8MzsgY2hp
KyspIHsKKwkJLyp3cml0ZXEoTUFDRV9BVURJT19DVFJMX0NIQU5fUkVTRVQsCisJCQkmbWFjZS0+
cGVyaWYuYXVkaW8uY2hhbltjaGldLmNvbnRyb2wpOyovCisKKwkJc3Bpbl9sb2NrX2luaXQoJmNo
aXAtPmNoYW5uZWxbY2hpXS5sb2NrKTsKKwl9CisKKwlwY20gPSBOVUxMOworCWVyciA9IHNuZF9w
Y21fbmV3KGNoaXAtPmNhcmQsICJNYWNlIEF1ZGlvIDEiLCAwLCAxLCAxLCAmcGNtKTsKKwlpZiAo
MCA+IGVycikgcmV0dXJuIGVycjsKKworCXBjbS0+cHJpdmF0ZV9kYXRhID0gY2hpcDsKKwlzdHJj
cHkocGNtLT5uYW1lLCAiTWFjZSBBdWRpbyAxIik7CisKKwkvKiBzZXQgb3BlcmF0b3JzICovCisJ
c25kX3BjbV9zZXRfb3BzKHBjbSwgU05EUlZfUENNX1NUUkVBTV9QTEFZQkFDSywKKwkJJnNuZF9t
YWNlX2F1ZGlvX3BsYXliYWNrX29wcyk7CisJc25kX3BjbV9zZXRfb3BzKHBjbSwgU05EUlZfUENN
X1NUUkVBTV9DQVBUVVJFLAorCQkmc25kX21hY2VfYXVkaW9fY2FwdHVyZV9vcHMpOworCisJY2hp
cC0+cGNtWzBdID0gcGNtOworCisKKwlwY20gPSBOVUxMOworCWVyciA9IHNuZF9wY21fbmV3KGNo
aXAtPmNhcmQsICJNYWNlIEF1ZGlvIDIiLCAxLCAxLCAwLCAmcGNtKTsKKwlpZiAoMCA+IGVycikg
cmV0dXJuIGVycjsgLypmcmVlIHBjbTAgPyAqLworCisJcGNtLT5wcml2YXRlX2RhdGEgPSBjaGlw
OworCXN0cmNweShwY20tPm5hbWUsICJNYWNlIEF1ZGlvIE91dC0yIik7CisKKwkvKiBzZXQgb3Bl
cmF0b3JzICovCisJc25kX3BjbV9zZXRfb3BzKHBjbSwgU05EUlZfUENNX1NUUkVBTV9QTEFZQkFD
SywKKwkJJnNuZF9tYWNlX2F1ZGlvX3BsYXliYWNrX29wcyk7CisKKwljaGlwLT5wY21bMV0gPSBw
Y207CisKKwlyZXR1cm4gMDsKK30KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKiBJbnRl
cnJ1cHRzIGFuZCBETUEgZW5naW5lICoqKioqKioqKioqKioqKiovCitzdGF0aWMgaW50IHNuZF9t
YWNlX2F1ZGlvX2RtYV9zdGFydChzbmRfcGNtX3N1YnN0cmVhbV90ICpzdWJzdHJlYW0pCit7CisJ
c25kX21hY2VfYXVkaW9fdCAqY2hpcCA9ICBzbmRfcGNtX3N1YnN0cmVhbV9jaGlwKHN1YnN0cmVh
bSk7CisJaW50IGNoaSA9IHN1YnN0cmVhbV90b19jaGFubmVsX2luZGV4KHN1YnN0cmVhbSk7CisK
K3ByaW50aygiSW4gRE1BIHN0YXJ0IGZvciBjaGFubmVsICVkXG4iLCBjaGkpOworCisJd3JpdGVx
KE1BQ0VfQVVESU9fQ1RSTF9DSEFOX1JFU0VULAorCQkmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltj
aGldLmNvbnRyb2wpOworCXVkZWxheSgxMCk7CisJd3JpdGVxKDBMLCAmbWFjZS0+cGVyaWYuYXVk
aW8uY2hhbltjaGldLmNvbnRyb2wpOworCW1iKCk7CisKKwkvKiBwdXNoIGEgZnVsbCBidWZmZXIg
Ki8KKwlzbmRfbWFjZV9hdWRpb19kbWFfcHVzaChjaGlwLCBjaGkpOworCisJLyogc2V0IERNQSB0
byB3YWtlIG9uIDUwJSBlbXB0eSBhbmQgZW5hYmxlIGludGVycnVwdCAqLworCXdyaXRlcShNQUNF
X0FVRElPX0RNQV9FTkFCTEUgfAorCQlNQUNFX0FVRElPX0lOVF9USFJFU0hPTERfNTAsCisJCSZt
YWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0uY29udHJvbCk7CisJbWIoKTsKK3ByaW50X3BvaW50
ZXJzKCJETUEgc3RhcnRlZCIpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgc25kX21h
Y2VfYXVkaW9fZG1hX3N0b3Aoc25kX3BjbV9zdWJzdHJlYW1fdCAqc3Vic3RyZWFtKQoreworCWlu
dCBjaGkgPSBzdWJzdHJlYW1fdG9fY2hhbm5lbF9pbmRleChzdWJzdHJlYW0pOworcHJpbnRrKCJJ
biBETUEgc3RvcCBmb3IgY2hhbm5lbCAlZFxuIiwgY2hpKTsKKworCXdyaXRlcShNQUNFX0FVRElP
X0NUUkxfQ0hBTl9SRVNFVCwKKwkJJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5jb250cm9s
KTsKKwl1ZGVsYXkoMjApOworCXdyaXRlcSgwTCwgJm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hp
XS5jb250cm9sKTsKKworcHJpbnRfcG9pbnRlcnMoIkRNQSBzdG9wcGVkIik7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19kbWFfcHVzaChzbmRfbWFjZV9hdWRp
b190ICpjaGlwLCBpbnQgY2hpKQoreworCXZvaWQgKmRzdF9iYXNlLCAqc3JjX2Jhc2U7CisJdW5z
aWduZWQgbG9uZyBkc3RfcG9zLCBzcmNfcG9zOworCXU2NCAqZHN0OworCXMzMiAqc3JjOworCXVu
c2lnbmVkIGxvbmcgZmxhZ3MsIHJlbWFpbiwgdXNlZCwgdG1wOworCXVuc2lnbmVkIGludCBwZXJp
b2RzOworCXNuZF9wY21fcnVudGltZV90ICpydW50aW1lID0gY2hpcC0+Y2hhbm5lbFtjaGldLnN1
YnN0cmVhbS0+cnVudGltZTsKKworcHJpbnRrKCJJbiBETUEgcHVzaCBmb3IgJWRcbiIsIGNoaSk7
CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+Y2hhbm5lbFtjaGldLmxvY2ssIGZsYWdzKTsK
KworCS8qIHdlIHdhbnQgdG8gbW92ZSBhcm91bmQgaW5zaWRlIG91ciA0aywgc28gbWFrZSBkc3Rf
cG9zPTAKKwkgKiB0aGUgYm90dG9tIG9mIGl0ICovCisJZHN0X2Jhc2UgPSAodW5zaWduZWQgbG9u
ZyljaGlwLT5yaW5nX2Jhc2UgKyAoY2hpIDw8IE1BQ0VfQVVESU9fUklOR19TSElGVCk7CisJZHN0
X3BvcyAgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY2hhbltjaGldLndyaXRlX3B0cik7CisK
KwlzcmNfYmFzZSA9IHJ1bnRpbWUtPmRtYV9hcmVhOworCXNyY19wb3MgID0gY2hpcC0+Y2hhbm5l
bFtjaGldLnBvczsKKwkvKiBwb3MgcmVsYXRpdmUgdG8gYmFzZT8gKi8KKworCWRzdCA9IChkc3Rf
YmFzZSArIGRzdF9wb3MpOworCXNyYyA9IChzcmNfYmFzZSArIHNyY19wb3MpOworCitwcmludGso
InJpbmcgYmFzZSAweCVsWCwgZHN0X2Jhc2UgMHglbFgsIGRzdF9wb3MgMHglbFgsIGRzdCAweCVs
WFxuIiwKKwkodW5zaWduZWQgbG9uZyljaGlwLT5yaW5nX2Jhc2UsIGRzdF9iYXNlLCBkc3RfcG9z
LCBkc3QpOworCisJdXNlZCA9IHJlYWRxKCZtYWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0uZGVw
dGgpOworCXJlbWFpbiA9IE1BQ0VfQVVESU9fUklOR19TSVpFIC0gdXNlZDsKKworcHJpbnRrKCIl
bGQgcmVtYWluLCAlbGQgdXNlZFxuIiwgcmVtYWluLCB1c2VkKTsKKworCS8qIHRyeSBub3QgdG8g
Y2F0Y2ggdXAgd2l0aCByZWFkIHBvaW50ZXIqLworCXdoaWxlIChNQUNFX0FVRElPX1JJTkdfU0la
RSA8PSByZW1haW4pIHJlbWFpbiAtPSAoNCA8PCA1KTsKK3ByaW50aygicmVkdWNlZCByZW1haW4g
dG8gJWxkXG4iLCByZW1haW4pOworCitwcmludF9wb2ludGVycygic3RhcnRpbmcgcHVzaCBsb29w
Iik7CisKKwl3aGlsZSAoMCA8IHJlbWFpbikgeworLyogaWdub3JlIGFueSBzaWduIGV4dGVuZCBh
dCBtbworICogSSBhbSBob3BpbmcgdG8gc2tpcCB0aGlzIGludGVybWVkaWF0ZSBzdGVwIGFuZCBo
YXZlIGFsc2Egd3JpdGUKKyAqIGRpcmVjdCB0byB0aGUgcmluZyBidWZmZXIsIEknbSBsZWF2aW5n
IHRoaXMgaGVyZSBub3cgdG8gYmUgYWJsZQorICogdG8gd2F0Y2gvbGlzdGVuIHdoYXQgaGFwcGVu
cyBmaXJzdAorICogYnV0IGZpcnN0IEkgbmVlZCB0byBnZXQgRE1BIGZlZWQgd29ya2luZy4KKyAq
LworCQl0bXAgPSBzcmNbMF07CisJCSpkc3QgPSAoKHRtcCA8PCAzMil8c3JjWzFdKSAmIDB4MDA3
RkZGRkYwMDdGRkZGRjsKKworCQlkc3RfcG9zICs9IHNpemVvZih1NjQpOworCQlkc3RfcG9zICY9
IE1BQ0VfQVVESU9fUklOR19NQVNLOworCQlkc3QgPSAoZHN0X2Jhc2UgKyBkc3RfcG9zKTsKKwor
CQlzcmNfcG9zICs9IDIqIHNpemVvZihzMzIpOworCQkvKnNyY19wb3MgJj0gTUFDRV9BVURJT19S
SU5HX01BU0s7Ki8KKwkJc3JjX3BvcyAmPSAocnVudGltZS0+ZG1hX2J5dGVzIC0xKTsKKwkJc3Jj
ID0gKHNyY19iYXNlICsgc3JjX3Bvcyk7CisKKwkJcmVtYWluIC09IHNpemVvZih1NjQpOworCX0K
KworCW1iKCk7CisKKwkvKiBwdXQgZHN0X3BvcyBiYWNrIGZvciB3cml0ZSBiYWNrICovCisJd3Jp
dGVxKGRzdF9wb3MsICZtYWNlLT5wZXJpZi5hdWRpby5jaGFuW2NoaV0ud3JpdGVfcHRyKTsKKwlj
aGlwLT5jaGFubmVsW2NoaV0ucG9zID0gc3JjX3BvczsKKwltYigpOworCit1c2VkID0gcmVhZHEo
Jm1hY2UtPnBlcmlmLmF1ZGlvLmNoYW5bY2hpXS5kZXB0aCk7CitwcmludGsoImFmdGVyIHB1c2gg
bG9vcCwgJWxkIHJlbWFpbiwgJWxkIHVzZWQsIGRzdCBwb3MgJWxkXG4iLCByZW1haW4sIHVzZWQs
IGRzdF9wb3MpOworCisKK3ByaW50X3BvaW50ZXJzKCJGaW5pc2hlZCBwdXNoIGxvb3AiKTsKKwor
CS8qIGNoZWNrIGlmIGEgcGVyaW9kIGhhcyBlbGFwc2VkID9GSVhNRT8gKi8KKwljaGlwLT5jaGFu
bmVsW2NoaV0uZnJhbWVzICs9IGJ5dGVzX3RvX2ZyYW1lcyhydW50aW1lLCB1c2VkKTsKKwlwZXJp
b2RzID0gY2hpcC0+Y2hhbm5lbFtjaGldLmZyYW1lcyA+PSBydW50aW1lLT5wZXJpb2Rfc2l6ZTsK
KwljaGlwLT5jaGFubmVsW2NoaV0uZnJhbWVzICU9IHJ1bnRpbWUtPnBlcmlvZF9zaXplOworCisJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+Y2hhbm5lbFtjaGldLmxvY2ssIGZsYWdzKTsK
KworCXJldHVybiAoMCA8IHBlcmlvZHMpOworfQorCitzdGF0aWMgaXJxcmV0dXJuX3Qgc25kX21h
Y2VfYXVkaW9faW50ZXJydXB0CisJKGludCBpcnEsIHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIHN0
cnVjdCBwdF9yZWdzICpyZWdzKQoreworcHJpbnRrKCJJbiBpbnRlcnJ1cHQgJWRcbiIsIGlycSk7
CisKKwlzd2l0Y2ggKGlycSkgeworCWNhc2UgTUFDRUlTQV9BVURJT19TV19JUlE6CisJCXByaW50
aygiR290IE1BQ0VJU0EgQVVESU8gU1cgSVJRXG4iKTsKKwkJcmV0dXJuIElSUV9OT05FOyAvKlRP
RE8qLworCisJY2FzZSBNQUNFSVNBX0FVRElPX1NDX0lSUToKKwkJc25kX21hY2VfYXVkaW9fYWRq
dXN0X3ZvbChjaGlwKTsKKwkJYnJlYWs7CisKKwljYXNlIE1BQ0VJU0FfQVVESU8xX0RNQVRfSVJR
OgorCQlpZihzbmRfbWFjZV9hdWRpb19kbWFfcHVzaChjaGlwLCAwKSkKKwkJCXNuZF9wY21fcGVy
aW9kX2VsYXBzZWQoY2hpcC0+Y2hhbm5lbFswXS5zdWJzdHJlYW0pOworCQlicmVhazsKKworCWNh
c2UgTUFDRUlTQV9BVURJTzFfT0ZfSVJROgorCQlwcmludGsoIkdvdCBNQUNFSVNBIEFVRElPMSBP
RiBJUlFcbiIpOworCQlyZXR1cm4gSVJRX05PTkU7IC8qVE9ETyovCisKKwljYXNlIE1BQ0VJU0Ff
QVVESU8yX0RNQVRfSVJROgorCQlpZiAoc25kX21hY2VfYXVkaW9fZG1hX3B1c2goY2hpcCwgMSkp
CisJCQlzbmRfcGNtX3BlcmlvZF9lbGFwc2VkKGNoaXAtPmNoYW5uZWxbMV0uc3Vic3RyZWFtKTsK
KwkJYnJlYWs7CisKKwljYXNlIE1BQ0VJU0FfQVVESU8yX01FUlJfSVJROgorCQlwcmludGsoIkdv
dCBNQUNFSVNBIEFVRElPMiBNRVJSIElSUVxuIik7CisJCXJldHVybiBJUlFfTk9ORTsgLypUT0RP
Ki8KKworCWNhc2UgTUFDRUlTQV9BVURJTzNfRE1BVF9JUlE6CisJCWlmIChzbmRfbWFjZV9hdWRp
b19kbWFfcHVzaChjaGlwLCAyKSkKKwkJCXNuZF9wY21fcGVyaW9kX2VsYXBzZWQoY2hpcC0+Y2hh
bm5lbFsyXS5zdWJzdHJlYW0pOworCQlicmVhazsKKworCWNhc2UgTUFDRUlTQV9BVURJTzNfTUVS
Ul9JUlE6CisJCXByaW50aygiR290IE1BQ0VJU0EgQVVESU8zIE1FUlIgSVJRXG4iKTsKKwkJcmV0
dXJuIElSUV9OT05FOyAvKlRPRE8qLworCisJZGVmYXVsdDoKKwkJc25kX3ByaW50ayhLRVJOX0VS
UiAiVW5rbm93biBJUlEgcmVjZWl2ZWQhXG4iKTsKKwkJcmV0dXJuIElSUV9OT05FOworCX0KKwor
CXJldHVybiBJUlFfSEFORExFRDsKK30KKworc3RhdGljIHZvaWQgc25kX21hY2VfYXVkaW9fYWRq
dXN0X3ZvbChzbmRfbWFjZV9hdWRpb190ICpjaGlwKQoreworCXVuc2lnbmVkIGxvbmcgc3RhdHVz
LCBmbGFnczsKKwl1bnNpZ25lZCBpbnQgcnZvbCxsdm9sOworCisJc3Bpbl9sb2NrX2lycXNhdmUo
JmNoaXAtPmFkMTg0M19sb2NrLCBmbGFncyk7CisKKwlzdGF0dXMgPSByZWFkcSgmbWFjZS0+cGVy
aWYuYXVkaW8uY29udHJvbCk7CisJcnZvbCA9IGFkMTg0M19nZXRfZ2FpbihjaGlwLT5hZDE4NDMs
IGNoaXAtPmV4dF92b2xfZm9yKTsKKwlsdm9sID0gKHJ2b2w+PjgpJjB4RkY7CisJcnZvbCAmPSAw
eEZGOworCitwcmludGsoImluIHZvbHVtZSBhZGp1c3QgZm9yICVkLCBjdXJyZW50IHZvbCAlZHwl
ZCwgc3RhdHVzICVsZFxuIiwKKwljaGlwLT5leHRfdm9sX2ZvciwgbHZvbCwgcnZvbCwgc3RhdHVz
KTsKKworCWlmICgoc3RhdHVzICYgTUFDRV9BVURJT19DVFJMX1ZPTF9CVVRUT05fVVApID4wKSB7
CisJCXN0YXR1cyAmPSB+TUFDRV9BVURJT19DVFJMX1ZPTF9CVVRUT05fVVA7CisJCXdyaXRlcShz
dGF0dXMsICZtYWNlLT5wZXJpZi5hdWRpby5jb250cm9sKTsKKworCQlpZiAoMTAwID4gbHZvbCkg
bHZvbCsrOworCQlpZiAoMTAwID4gcnZvbCkgcnZvbCsrOworCX0KKworCWlmICgoc3RhdHVzICYg
TUFDRV9BVURJT19DVFJMX1ZPTF9CVVRUT05fRE9XTikgPjApIHsKKwkJc3RhdHVzICY9IH5NQUNF
X0FVRElPX0NUUkxfVk9MX0JVVFRPTl9ET1dOOworCQl3cml0ZXEoc3RhdHVzLCAmbWFjZS0+cGVy
aWYuYXVkaW8uY29udHJvbCk7CisKKwkJaWYgKDAgPCBsdm9sKSBsdm9sLS07CisJCWlmICgwIDwg
cnZvbCkgcnZvbC0tOworCX0KKworCWFkMTg0M19zZXRfZ2FpbihjaGlwLT5hZDE4NDMsIEFEMTg0
M19HQUlOX1BDTV8wLAorCQkoKGx2b2w8PDgpfHJ2b2wpKTsKKworCW1iKCk7CisKKwlzdGF0dXMg
PSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29udHJvbCk7CitwcmludGsoImxlYXZpbmcgdm9s
dW1lIGFkanVzdCwgdm9sIG5vdyAlZHwlZCwgc3RhdHVzICVsZFxuIiwKKwlsdm9sLCBydm9sLCBz
dGF0dXMpOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZs
YWdzKTsKKworfQorCisvKioqKioqKioqKioqKioqKioqKiogUHJvYyBmaWxlLCBNaXhlciBhbmQg
Y29udHJvbHMgKioqKioqKioqKioqKioqKioqKiovCisKK3N0YXRpYyBpbnQgc25kX21hY2VfYXVk
aW9fZ2Fpbl9pbmZvCisJKHNuZF9rY29udHJvbF90ICprY29udHJvbCwgc25kX2N0bF9lbGVtX2lu
Zm9fdCAqdWluZm8pCit7CisJdWluZm8tPnR5cGUgPSBTTkRSVl9DVExfRUxFTV9UWVBFX0lOVEVH
RVI7CisJdWluZm8tPmNvdW50ID0gMjsKKwl1aW5mby0+dmFsdWUuaW50ZWdlci5taW4gPSAwOwor
CXVpbmZvLT52YWx1ZS5pbnRlZ2VyLm1heCA9IDEwMDsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IHNuZF9tYWNlX2F1ZGlvX2dhaW5fZ2V0CisJKHNuZF9rY29udHJvbF90ICprY29udHJv
bCwgc25kX2N0bF9lbGVtX3ZhbHVlX3QgKnVjb250cm9sKQoreworCXNuZF9tYWNlX2F1ZGlvX3Qg
KmNoaXAgPSBzbmRfa2NvbnRyb2xfY2hpcChrY29udHJvbCk7CisJaW50IHZvbDsKKwl1bnNpZ25l
ZCBsb25nIGZsYWdzOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJmNoaXAtPmFkMTg0M19sb2NrLCBm
bGFncyk7CisKKwl2b2wgPSBhZDE4NDNfZ2V0X2dhaW4oY2hpcC0+YWQxODQzLCAoaW50KWtjb250
cm9sLT5wcml2YXRlX3ZhbHVlKTsKKworCXVjb250cm9sLT52YWx1ZS5pbnRlZ2VyLnZhbHVlWzBd
ID0gdm9sICYgMHhGRjsKKwl1Y29udHJvbC0+dmFsdWUuaW50ZWdlci52YWx1ZVsxXSA9ICh2b2wg
Pj4gOCkgJiAweEZGOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+YWQxODQzX2xv
Y2ssIGZsYWdzKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHNuZF9tYWNlX2F1ZGlv
X2dhaW5fcHV0CisJKHNuZF9rY29udHJvbF90ICprY29udHJvbCwgc25kX2N0bF9lbGVtX3ZhbHVl
X3QgKnVjb250cm9sKQoreworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAgPSBzbmRfa2NvbnRyb2xf
Y2hpcChrY29udHJvbCk7CisJaW50IG5ld3ZvbCwgb2xkdm9sOworCXVuc2lnbmVkIGxvbmcgZmxh
Z3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZsYWdzKTsKKwor
CW9sZHZvbCA9IGFkMTg0M19nZXRfZ2FpbihjaGlwLT5hZDE4NDMsIGtjb250cm9sLT5wcml2YXRl
X3ZhbHVlKTsKKwluZXd2b2wgPSAodWNvbnRyb2wtPnZhbHVlLmludGVnZXIudmFsdWVbMV0gPDwg
OCkgfAorCQl1Y29udHJvbC0+dmFsdWUuaW50ZWdlci52YWx1ZVswXTsKKworCW5ld3ZvbCA9IGFk
MTg0M19zZXRfZ2FpbihjaGlwLT5hZDE4NDMsIGtjb250cm9sLT5wcml2YXRlX3ZhbHVlLAorCQlu
ZXd2b2wpOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZs
YWdzKTsKKworCXJldHVybiAobmV3dm9sICE9IG9sZHZvbCk7Cit9CisKK3N0YXRpYyBpbnQgX19k
ZXZpbml0IHNuZF9tYWNlX2F1ZGlvX2NvbnRyb2xfbmV3KHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAp
Cit7CisJaW50IGVycjsKKworCWVyciA9IHNuZF9jdGxfYWRkKGNoaXAtPmNhcmQsCisJCXNuZF9j
dGxfbmV3MSgmc25kX21hY2VfYXVkaW9fY3RybF9yZWNsZXZlbCwgY2hpcCkpOworCWlmICgwID4g
ZXJyKSByZXR1cm4gZXJyOworCisJZXJyID0gc25kX2N0bF9hZGQoY2hpcC0+Y2FyZCwKKwkJc25k
X2N0bF9uZXcxKCZzbmRfbWFjZV9hdWRpb19jdHJsX2xpbmUsIGNoaXApKTsKKwlpZiAoMCA+IGVy
cikgcmV0dXJuIGVycjsKKworCWVyciA9IHNuZF9jdGxfYWRkKGNoaXAtPmNhcmQsCisJCXNuZF9j
dGxfbmV3MSgmc25kX21hY2VfYXVkaW9fY3RybF9jZCwgY2hpcCkpOworCWlmICgwID4gZXJyKSBy
ZXR1cm4gZXJyOworCisJZXJyID0gc25kX2N0bF9hZGQoY2hpcC0+Y2FyZCwKKwkJc25kX2N0bF9u
ZXcxKCZzbmRfbWFjZV9hdWRpb19jdHJsX21pYywgY2hpcCkpOworCWlmICgwID4gZXJyKSByZXR1
cm4gZXJyOworCisJZXJyID0gc25kX2N0bF9hZGQoY2hpcC0+Y2FyZCwKKwkJc25kX2N0bF9uZXcx
KCZzbmRfbWFjZV9hdWRpb19jdHJsX3BjbTAsIGNoaXApKTsKKwlpZiAoMCA+IGVycikgcmV0dXJu
IGVycjsKKworCWVyciA9IHNuZF9jdGxfYWRkKGNoaXAtPmNhcmQsCisJCXNuZF9jdGxfbmV3MSgm
c25kX21hY2VfYXVkaW9fY3RybF9wY20xLCBjaGlwKSk7CisJaWYgKDAgPiBlcnIpIHJldHVybiBl
cnI7CisKKwkvKnBsYW4gYSBtaXhlciBjb250cm9sIHRoYXQgY2FuIGNoYW5nZSB0aGlzKi8KKwlj
aGlwLT5leHRfdm9sX2ZvciA9IEFEMTg0M19HQUlOX1BDTV8wOworCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyB2b2lkIHNuZF9tYWNlX2F1ZGlvX3Byb2NfcmVhZAorCShzbmRfaW5mb19lbnRyeV90
ICpwcm9jX2VudHJ5LCBzbmRfaW5mb19idWZmZXJfdCAqYnVmZmVyKQoreworCXNuZF9tYWNlX2F1
ZGlvX3Byb2NfZW50cnlfdCAqZW50cnk7CisKKwlzbmRfaXByaW50ZihidWZmZXIsICJNQUNFIEF1
ZGlvIGRlYnVnIGluZm8uXG4iKTsKKworCWxpc3RfZm9yX2VhY2hfZW50cnkoZW50cnksICZzbmRf
bWFjZV9hdWRpb19wcm9jX2xpc3QsIGxpbmspIHsKKworCQlpZiAoTlVMTCA9PSBlbnRyeS0+dmFs
X3N0cikKKwkJCXNuZF9pcHJpbnRmKGJ1ZmZlciwgIiVzOiBcdCVsZFxuIiwKKwkJCQllbnRyeS0+
bmFtZSwgZW50cnktPnZhbF9pbnQpOworCQllbHNlCisJCQlzbmRfaXByaW50ZihidWZmZXIsICIl
czogXHQlc1xuIiwKKwkJCQllbnRyeS0+bmFtZSwgZW50cnktPnZhbF9zdHIpOworCX0KKworfQor
CisvKiB0aGlzIGlzIGNhbGxlZCBpbnNpZGUgdGhlIHZvbHVtZSBpbnRlcnJ1cHQsIGJ1dCBpcyBp
dCBhcHByb3ByaWF0ZQorICogdG8gYmUgYWxsb2NhdGluZyBtZW1vcnkgZHVyaW5nIGFuIGludGVy
cnVwdD8gKi8KK3N0YXRpYyBzbmRfbWFjZV9hdWRpb19wcm9jX2VudHJ5X3QqIHNuZF9tYWNlX2F1
ZGlvX3Byb2NfZW50cnlfYXBwZW5kCisJKGNoYXIgKm5hbWUpCit7CisJc25kX21hY2VfYXVkaW9f
cHJvY19lbnRyeV90ICplbnRyeSA9CisJCWt6YWxsb2Moc2l6ZW9mKHNuZF9tYWNlX2F1ZGlvX3By
b2NfZW50cnlfdCksIEdGUF9BVE9NSUMpOworCisJZW50cnktPm5hbWUgPSBuYW1lOworCisJbGlz
dF9hZGRfdGFpbCgmZW50cnktPmxpbmssICZzbmRfbWFjZV9hdWRpb19wcm9jX2xpc3QpOworCisJ
cmV0dXJuIGVudHJ5OworCit9CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEFM
U0Egc2V0dXAgKioqKioqKioqKioqKioqKioqKioqKioqKiovCisKKy8qIGNoaXAgc3BlY2lmaWMg
ZGVzdHJ1Y3RvciAqLworc3RhdGljIGludCBzbmRfbWFjZV9hdWRpb19mcmVlKHNuZF9tYWNlX2F1
ZGlvX3QgKmNoaXApCit7CisJaW50IGlycTsKKworcHJpbnRrKCJzbmRfbWFjZV9hdWRpb19mcmVl
IGNhbGxlZFxuIik7CisKKwkvKiByZXNldCB0aGUgaW50ZXJmYWNlICovCisJd3JpdGVxKE1BQ0Vf
QVVESU9fQ1RSTF9SRVNFVCwgJm1hY2UtPnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCXVkZWxheSgx
KTsKKwl3cml0ZXEoMEwsICZtYWNlLT5wZXJpZi5hdWRpby5jb250cm9sKTsKKworCS8qIHVuZG8g
RE1BID8gKi8KKworCS8qIHJlbGVhc2UgSVJRJ3MgKi8KKwlmb3IgKGlycT1NQUNFSVNBX0FVRElP
X1NXX0lSUTsgaXJxPD1NQUNFSVNBX0FVRElPM19NRVJSX0lSUTsgaXJxKyspeworCQlmcmVlX2ly
cShpcnEsIGNoaXApOworCX0KKworCS8qIHNodXRkb3duIHRoZSBhZDE4NDM/ICovCisJLyogZnJl
ZSBjb2RlYyBzdHJ1Y3QqLworCWtmcmVlKGNoaXAtPmFkMTg0Myk7CisJc25kX2NhcmRfZnJlZShj
aGlwLT5jYXJkKTsKKwlzbmRfbWFjZV9hdWRpb19jaGlwID0gTlVMTDsKKworCXJldHVybiAwOwor
fQorCisvKiBjaGlwIHNwZWNpZmljIGNvbnN0cnVjdG9yICovCitzdGF0aWMgaW50IF9fZGV2aW5p
dCBzbmRfbWFjZV9hdWRpb19jcmVhdGUKKwkoc25kX2NhcmRfdCAqY2FyZCwgc25kX21hY2VfYXVk
aW9fdCAqKnJjaGlwKQoreworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXA7CisJaW50IGVyciwgaXJx
OworCXVuc2lnbmVkIGxvbmcgbWFjZV9yZWc7CisKKwkqcmNoaXAgPSBOVUxMOworCWNoaXAgPSBj
YXJkLT5wcml2YXRlX2RhdGE7CisJY2hpcC0+Y2FyZCA9IGNhcmQ7CisKKwkvKiBETUEgcmluZyBi
dWZmZXIgKi8KKwljaGlwLT5yaW5nX2Jhc2UgPSBkbWFfYWxsb2NfY29oZXJlbnQoTlVMTCwgTUFD
RUlTQV9SSU5HQlVGRkVSU19TSVpFLAorCQkmY2hpcC0+cmluZ19iYXNlX2hhbmRsZSwgMCk7CisJ
ZXJyID0gKE5VTEwgPT0gY2hpcC0+cmluZ19iYXNlKT8tRU5PTUVNOjA7IC8qIHVnbHkgKi8KKwlp
ZiAoMD4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKK3ByaW50aygiYWxsb2NhdGVkIHJpbmcgYmFz
ZS4gQ1BVIGFkZHI9MHglbFgsIEJ1cyBhZGRyPTB4JWxYXG4iLAorCWNoaXAtPnJpbmdfYmFzZSwg
Y2hpcC0+cmluZ19iYXNlX2hhbmRsZSk7CisKKwkvKiBNaXJyb3IgcmluZyBidWZmZXIgYXJyYW5n
ZW1lbnQgZm9yIGFsc2EgaW4gdGhlIGhvcGUgdG8gb25lIGRheQorCSAqIHJlbW92ZSB0aGUgaW50
ZXJtZWRpYXRlIHN0ZXAgKGRtYSBwdXNoKSBhbmQgaGF2ZSBhbHNhIHdyaXRlIHRvCisJICogdGhl
IHJpbmcgYnVmZmVyCisJICoganVuazogbm8gcmVhbCBodyBhdCB0aGlzIHBvaW50ICovCisvKglj
aGlwLT5hbHNhX2RtYV9iYXNlID0ga3phbGxvYygzKihNQUNFX0FVRElPX1JJTkdfU0laRSksIDAp
OworCWVyciA9IChOVUxMID09IGNoaXAtPmFsc2FfZG1hX2Jhc2UpPy1FTk9NRU06MDsgKi8vKiB1
Z2x5ICovCisvKglpZiAoMD4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7Ki8KKworCS8qIFNlZSBpZiB0
aGlzIHdpbGwgYmUgRE1BLWFibGUgZm9yIE1hY2UgKi8KKwkvKmp1bmsgPSBkbWFfbWFwX3Npbmds
ZShOVUxMLCBjaGlwLT5hbHNhX2RtYV9iYXNlLAorCQkzKk1BQ0VfQVVESU9fUklOR19TSVpFLCBQ
Q0lfRE1BX0JJRElSRUNUSU9OQUwpOyovCisvKgorCWNoaXAtPmFsc2FfZG1hX2Jhc2UgPSBkbWFf
YWxsb2NfY29oZXJlbnQoTlVMTCwgMypNQUNFX0FVRElPX1JJTkdfU0laRSwKKwkJJmp1bmssIEdG
UF9VU0VSfF9fR0ZQX0RNQSk7Ki8KKworcHJpbnRrKCJzaXplb2Ygdm9pZCo9JWxkLCB1bnNpZ25l
ZCBsb25nPSVsZCwgaW50PSVsZCwgIgorCSJ1MzI9JWxkLCB1MzIqPSVsZCwgdTY0PSVsZCwgdTY0
Kj0lbGRcbiIsCisJc2l6ZW9mKHZvaWQqKSwgc2l6ZW9mKHVuc2lnbmVkIGxvbmcpLCBzaXplb2Yo
aW50KSwKKwlzaXplb2YodTMyKSwgc2l6ZW9mKHUzMiopLCBzaXplb2YodTY0KSwgc2l6ZW9mKHU2
NCopKTsKKworCS8qIEFsbG9jYXRlIElSUXMgKi8KKwlmb3IgKGlycT1NQUNFSVNBX0FVRElPX1NX
X0lSUTsgaXJxPD1NQUNFSVNBX0FVRElPM19NRVJSX0lSUTsgaXJxKyspeworCQkvKk5PVEUgV2hh
dCBkb2VzIHJlcWV1c3RfaXJxIHJldHVybj8gKi8KKwkJZXJyID0gcmVxdWVzdF9pcnEoaXJxLAor
CQkJKGlycXJldHVybl90KCopKGludCwgdm9pZCosIHN0cnVjdCBwdF9yZWdzKikpCisJCQkJJnNu
ZF9tYWNlX2F1ZGlvX2ludGVycnVwdCwKKwkJCVNBX0lOVEVSUlVQVHxTQV9TSElSUSwgIk1hY2Ug
QXVkaW8iLCBjaGlwKTsKKwkJaWYgKDAgPiBlcnIpIGdvdG8gRVJST1JfRVhJVDsKKwl9CisKKwkv
KiBjaGVjayBpZiB0aGUgY29kZWMgaXMgcHJlc2VudCAqLworCW1hY2VfcmVnID0gcmVhZHEoJm1h
Y2UtPnBlcmlmLmF1ZGlvLmNvbnRyb2wpOworCWVyciA9IChtYWNlX3JlZyAmIE1BQ0VfQVVESU9f
Q1RSTF9DT0RFQ19QUkVTRU5UKT4wPyAwIDogLUVOT0VOVDsKKwlpZiAoMCA+IGVycikgZ290byBF
UlJPUl9FWElUOworCisJLyogcmVzZXQgdGhlIGludGVyZmFjZSBhbmQgYWQxODQzICovCisJd3Jp
dGVxKE1BQ0VfQVVESU9fQ1RSTF9SRVNFVCwgJm1hY2UtPnBlcmlmLmF1ZGlvLmNvbnRyb2wpOwor
CXVkZWxheSgxMCk7CisJd3JpdGVxKDBMLCAmbWFjZS0+cGVyaWYuYXVkaW8uY29udHJvbCk7CisK
KwkvKiBzZXQgcmluZyBiYXNlICovCisJd3JpdGVxKGNoaXAtPnJpbmdfYmFzZV9oYW5kbGUsICZt
YWNlLT5wZXJpZi5jdHJsLnJpbmdiYXNlKTsKKwltYigpOworCisJLyogc3BpbiBsb2NrcyAqLwor
CXNwaW5fbG9ja19pbml0KCZjaGlwLT5hZDE4NDNfbG9jayk7CisKKwkvKiBhZDE4NDMgc2V0dXAg
Ki8KKwljaGlwLT5hZDE4NDMgPSBrbWFsbG9jKHNpemVvZihhZDE4NDNfdCksIEdGUF9LRVJORUwp
OworCWVyciA9IChOVUxMID09IGNoaXAtPmFkMTg0Myk/LUVOT01FTTowOworCWlmICgwID4gZXJy
KSBnb3RvIEVSUk9SX0VYSVQ7CisKKwljaGlwLT5hZDE4NDMtPmNoaXAgPSAgY2hpcDsKKwljaGlw
LT5hZDE4NDMtPnJlYWQgPQorCQkoaW50KCopKHZvaWQqLCBpbnQpKSZtYWNlX2F1ZGlvX3JlZ19y
ZWFkOworCWNoaXAtPmFkMTg0My0+d3JpdGUgPQorCQkoaW50KCopKHZvaWQqLCBpbnQsIGludCkp
Jm1hY2VfYXVkaW9fcmVnX3dyaXRlOworCisJLyogYXQgbW8gd2UgZG9udCB3YW50IGFueSBjb2Rl
YyB1cGRhdGUgaXJxcyAoU1cpICovCisJd3JpdGVxKDBMLCAmbWFjZS0+cGVyaWYuYXVkaW8uY29k
ZWNfbWFzayk7CisKKwllcnIgPSBhZDE4NDNfaW5pdChjaGlwLT5hZDE4NDMpOworCWlmICgwID4g
ZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkqcmNoaXAgPSBjaGlwOworCXNuZF9tYWNlX2F1ZGlv
X2NoaXAgPSBjaGlwOworCisJcmV0dXJuIDA7CisKK0VSUk9SX0VYSVQ6CisJc25kX3ByaW50ayhL
RVJOX0VSUiAiQXR0ZW1wIHRvIGluaXRpYWxpc2UgTUFDRSBBdWRpbyBmYWlsZWRcbiIpOworCXNu
ZF9tYWNlX2F1ZGlvX2ZyZWUoY2hpcCk7CisJcmV0dXJuIGVycjsKK30KKworLyogY29uc3RydWN0
ZXIgKi8KK3N0YXRpYyBpbnQgX19kZXZpbml0IHNuZF9tYWNlX2F1ZGlvX3Byb2JlKHZvaWQpCit7
CisJc25kX2NhcmRfdCAgICAgICpjYXJkOworCXNuZF9tYWNlX2F1ZGlvX3QgKmNoaXA7CisJaW50
IGVycjsKKworCS8qIGNyZWF0ZSBhbHNhIHN0dWZmKi8KKwljYXJkID0gc25kX2NhcmRfbmV3KGFs
c2FfaW5kZXgsIGFsc2FfaWQsCisJCVRISVNfTU9EVUxFLCBzaXplb2Yoc25kX21hY2VfYXVkaW9f
dCkpOworCWlmIChOVUxMID09IGNhcmQpIHJldHVybiAtRU5PTUVNOworCisJLyogc3V0dXAgb3Vy
IHN0dWZmKi8KKwllcnIgPSBzbmRfbWFjZV9hdWRpb19jcmVhdGUoY2FyZCwgJmNoaXApOworCWlm
ICgwID4gZXJyKSBnb3RvIEVSUk9SX0VYSVQ7CisKKwkvKiB0ZWxsIHRoZSB3b3JsZCB3aG8gd2Ug
YXJlICovCisJc3RyY3B5KGNhcmQtPmRyaXZlciwgIlNHSSBPMiBNQUNFIEF1ZGlvIERpcnZlciIp
OworCXN0cmNweShjYXJkLT5zaG9ydG5hbWUsICJNQUNFIEF1ZGlvIik7CisJc3ByaW50ZihjYXJk
LT5sb25nbmFtZSwgIiVzIiwKKwkJY2FyZC0+c2hvcnRuYW1lICk7CisKKwkvKiBhdHRhY2ggb3Vy
IGJpdHMnbidib2JzICovCisJZXJyID0gc25kX21hY2VfYXVkaW9fcGNtX25ldyhjaGlwKTsKKwlp
ZiAoMCA+IGVycikgZ290byBFUlJPUl9FWElUOworCisJZXJyID0gc25kX21hY2VfYXVkaW9fY29u
dHJvbF9uZXcoY2hpcCk7CisJaWYgKDAgPiBlcnIpIGdvdG8gRVJST1JfRVhJVDsKKworCWVyciA9
IHNuZF9jYXJkX3Byb2NfbmV3KGNhcmQsICJkZWJ1ZyIsICZjaGlwLT5wcm9jKTsKKwlpZiAoMCA+
IGVycikgZ290byBFUlJPUl9FWElUOworCisJc25kX2luZm9fc2V0X3RleHRfb3BzKGNoaXAtPnBy
b2MsIGNoaXAsIHNuZF9tYWNlX2F1ZGlvX3Byb2NfcmVhZCk7CisKKwkvKiBhbmQgd2UncmUgZG9u
ZSAqLworCWVyciA9IHNuZF9jYXJkX3JlZ2lzdGVyKGNhcmQpOworCWlmICgwID4gZXJyKSBnb3Rv
IEVSUk9SX0VYSVQ7CisKKwlyZXR1cm4gMDsKK0VSUk9SX0VYSVQ6CisJc25kX3ByaW50ayhLRVJO
X0VSUiAiUHJvYmUgZm9yIE1BQ0UgQXVkaW8gZmFpbGVkXG4iKTsKKwlzbmRfY2FyZF9mcmVlKGNh
cmQpOworCisJcmV0dXJuIGVycjsKK30KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
IE1BQ0UgYWNjZXNzICoqKioqKioqKioqKioqKioqKioqKioqKioqKi8KK3N0YXRpYyBpbnQgbWFj
ZV9hdWRpb19yZWdfcmVhZChzbmRfbWFjZV9hdWRpb190ICpjaGlwLCBpbnQgcmVnKQoreworCWlu
dCB2YWw7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwl1bnNpZ25lZCBpbnQgY2hlY2s7CisKKwlz
cGluX2xvY2tfaXJxc2F2ZSgmY2hpcC0+YWQxODQzX2xvY2ssIGZsYWdzKTsKKwl3cml0ZXEoTUFD
RV9BVURJT19DT0RFQ19SRUFEKHJlZyksCisJCSZtYWNlLT5wZXJpZi5hdWRpby5jb2RlY19jb250
cm9sKTsKKwltYigpOworCisJY2hlY2sgPSByZWFkcSgmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNf
Y29udHJvbCk7IC8qIGZsdXNoIGJ1cyAqLworCWlmICgoTUFDRV9BVURJT19DT0RFQ19SRUFEKHJl
ZykpICE9IGNoZWNrKQorCQlwcmludGsoIk1BQ0UgQXVkaW8gcmVnIHJlYWQgaGljLXVwIHNlbnQg
JVgsIGdvdCAlWFxuIiwKKwkJCShNQUNFX0FVRElPX0NPREVDX1JFQUQocmVnKSksIGNoZWNrKTsK
KworCXVkZWxheSgyMDApOworCXZhbCA9IHJlYWR3KCZtYWNlLT5wZXJpZi5hdWRpby5jb2RlY19y
ZWFkKTsKKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNoaXAtPmFkMTg0M19sb2NrLCBmbGFn
cyk7CisKKwlyZXR1cm4gdmFsOworfQorCitzdGF0aWMgaW50IG1hY2VfYXVkaW9fcmVnX3dyaXRl
KHNuZF9tYWNlX2F1ZGlvX3QgKmNoaXAsIGludCByZWcsIGludCB3b3JkKQoreworCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7CisJdW5zaWduZWQgaW50IGNoZWNrOworCisJc3Bpbl9sb2NrX2lycXNhdmUo
JmNoaXAtPmFkMTg0M19sb2NrLCBmbGFncyk7CisKKwl3cml0ZXEoTUFDRV9BVURJT19DT0RFQ19X
UklURShyZWcsIHdvcmQpLAorCQkmbWFjZS0+cGVyaWYuYXVkaW8uY29kZWNfY29udHJvbCk7CisJ
bWIoKTsKKworCWNoZWNrID0gcmVhZHEoJm1hY2UtPnBlcmlmLmF1ZGlvLmNvZGVjX2NvbnRyb2wp
OyAvKiBmbHVzaCBidXMgKi8KKwlpZiAoKE1BQ0VfQVVESU9fQ09ERUNfV1JJVEUocmVnLCB3b3Jk
KSkgIT0gY2hlY2spCisJCXByaW50aygiTUFDRSBBdWRpbyByZWcgd3JpdGUgaGljLXVwIHNlbnQg
JVgsIGdvdCAlWFxuIiwKKwkJCShNQUNFX0FVRElPX0NPREVDX1dSSVRFKHJlZywgd29yZCkpLCBj
aGVjayk7CisKKwl1ZGVsYXkoMjAwKTsKKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNoaXAt
PmFkMTg0M19sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqKioqKioqKioqKioq
KioqKioqKioqIG1vZHVsZSBzZXR1cCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCisK
K3N0YXRpYyBpbnQgX19pbml0IHNuZF9jYXJkX21hY2VfYXVkaW9faW5pdCh2b2lkKQoreworCWlu
dCBlcnI7CisKKwllcnIgPSBzbmRfbWFjZV9hdWRpb19wcm9iZSgpOworCWlmICgwID4gZXJyKSBn
b3RvIEVSUk9SX0VYSVQ7CisKKwlyZXR1cm4gMDsKK0VSUk9SX0VYSVQ6CisjaWZkZWYgTU9EVUxF
CisJcHJpbnRrKEtFUk5fRVJSICJNYWNlIEF1ZGlvIG5vdCBmb3VuZCBvciBkZXZpY2UgYnVzeVxu
Iik7CisjZW5kaWYKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBfX2V4aXQgc25kX2Nh
cmRfbWFjZV9hdWRpb19leGl0KHZvaWQpCit7CisJaWYgKE5VTEwgIT0gc25kX21hY2VfYXVkaW9f
Y2hpcCkKKwkJc25kX21hY2VfYXVkaW9fZnJlZShzbmRfbWFjZV9hdWRpb19jaGlwKTsKK30KKwor
TU9EVUxFX0FVVEhPUigiVGhvcmJlbiBKw6RuZGxpbmcgPHRqLnRyZXZlbHlhbkBnbWFpbC5jb20+
Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIlNHSSBPMiBNQUNFIEF1ZGlvIik7CitNT0RVTEVfTElD
RU5TRSgiR1BMIik7CitNT0RVTEVfU1VQUE9SVEVEX0RFVklDRSgie3tTaWxpY29uIEdyYXBoaWNz
LCBPMiBNQUNFIEF1ZGlvfX0iKTsKKworbW9kdWxlX3BhcmFtKGFsc2FfaW5kZXgsIGludCwgMDQ0
NCk7CitNT0RVTEVfUEFSTV9ERVNDKGFsc2FfaW5kZXgsICJJbmRleCB2YWx1ZSBmb3IgTUFDRSBB
dWRpbyIpOworbW9kdWxlX3BhcmFtKGFsc2FfaWQsIGNoYXJwLCAwNDQ0KTsKK01PRFVMRV9QQVJN
X0RFU0MoYWxzYV9pZCwgIklEIHN0cmluZyBmb3IgTUFDRSBBdWRpbyIpOworbW9kdWxlX3BhcmFt
KGFsc2FfZW5hYmxlLCBib29sLCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoYWxzYV9lbmFibGUs
ICJFbmFibGUgTUFDRSBBdWRpbyIpOworCittb2R1bGVfaW5pdChzbmRfY2FyZF9tYWNlX2F1ZGlv
X2luaXQpCittb2R1bGVfZXhpdChzbmRfY2FyZF9tYWNlX2F1ZGlvX2V4aXQpCisKCmRpZmYgLU51
IGxpbnV4LTIuNi4xOS43LmIvc291bmQvbWlwcy9NYWtlZmlsZSBsaW51eC0yLjYuMTkuNy9zb3Vu
ZC9taXBzL01ha2VmaWxlCi0tLSBsaW51eC0yLjYuMTkuNy5iL3NvdW5kL21pcHMvTWFrZWZpbGUJ
MjAwNy0wMy0xMCAxMjoxMToyMy4wMDAwMDAwMDAgKzAwMDAKKysrIGxpbnV4LTIuNi4xOS43L3Nv
dW5kL21pcHMvTWFrZWZpbGUJMjAwNy0wMy0xMiAxMzozMzowOS4wMDAwMDAwMDAgKzAwMDAKQEAg
LTMsNiArMyw5IEBACiAjCiAKIHNuZC1hdTF4MDAtb2JqcyA6PSBhdTF4MDAubworc25kLW1hY2Ut
YXVkaW8tb2JqcyA6PSBtYWNlX2F1ZGlvLm8gYWQxODQzLm8KIAogIyBUb3BsZXZlbCBNb2R1bGUg
RGVwZW5kZW5jeQogb2JqLSQoQ09ORklHX1NORF9BVTFYMDApICs9IHNuZC1hdTF4MDAubworb2Jq
LSQoQ09ORklHX1NORF9NQUNFX0FVRElPKSArPSBzbmQtbWFjZS1hdWRpby5vCisKCmRpZmYgLU51
IGxpbnV4LTIuNi4xOS43LmIvaW5jbHVkZS9zb3VuZC9hZDE4NDMuaCBsaW51eC0yLjYuMTkuNy9p
bmNsdWRlL3NvdW5kL2FkMTg0My5oCi0tLSBsaW51eC0yLjYuMTkuNy5iL2luY2x1ZGUvc291bmQv
YWQxODQzLmgJMTk3MC0wMS0wMSAwMTowMDowMC4wMDAwMDAwMDAgKzAxMDAKKysrIGxpbnV4LTIu
Ni4xOS43L2luY2x1ZGUvc291bmQvYWQxODQzLmgJMjAwNy0wMy0xMiAxMzozNToxMy4wMDAwMDAw
MDAgKzAwMDAKQEAgLTAsMCArMSw0NyBAQAorLyoKKyAqIFRoaXMgZmlsZSBpcyBzdWJqZWN0IHRv
IHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljCisgKiBM
aWNlbnNlLiAgU2VlIHRoZSBmaWxlICJDT1BZSU5HIiBpbiB0aGUgbWFpbiBkaXJlY3Rvcnkgb2Yg
dGhpcyBhcmNoaXZlCisgKiBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqIENvcHlyaWdodCAyMDAz
IFZpdmllbiBDaGFwcGVsaWVyIDx2aXZpZW4uY2hhcHBlbGllckBsaW51eC1taXBzLm9yZz4KKyAq
LworCisjaWZuZGVmIF9fU09VTkRfQUQxODQzX0gKKyNkZWZpbmUgX19TT1VORF9BRDE4NDNfSAor
Cit0eXBlZGVmIHN0cnVjdCB7CisgIHZvaWQgKmNoaXA7CisgIGludCAoKiByZWFkKSh2b2lkICpj
aGlwLCBpbnQgcmVnKTsKKyAgaW50ICgqIHdyaXRlKSh2b2lkICpjaGlwLCBpbnQgcmVnLCBpbnQg
dmFsKTsKK30gYWQxODQzX3Q7CisKKyNkZWZpbmUgQUQxODQzX0dBSU5fUkVDTEVWIDAKKyNkZWZp
bmUgQUQxODQzX0dBSU5fTElORSAgIDEKKyNkZWZpbmUgQUQxODQzX0dBSU5fQ0QgICAgIDIKKyNk
ZWZpbmUgQUQxODQzX0dBSU5fTUlDICAgIDMKKyNkZWZpbmUgQUQxODQzX0dBSU5fUENNXzAgIDQK
KyNkZWZpbmUgQUQxODQzX0dBSU5fUENNXzEgIDUKKyNkZWZpbmUgQUQxODQzX0dBSU5fU0laRSAg
IEFEMTg0M19HQUlOX1BDTV8xKzEKKworaW50IGFkMTg0M19nZXRfZ2FpbihhZDE4NDNfdCAqYWQx
ODQzLCBpbnQgaWQpOworaW50IGFkMTg0M19zZXRfZ2FpbihhZDE4NDNfdCAqYWQxODQzLCBpbnQg
aWQsIGludCBuZXd2YWwpOworaW50IGFkMTg0M19nZXRfcmVjc3JjKGFkMTg0M190ICphZDE4NDMp
Owordm9pZCBhZDE4NDNfc2V0X3Jlc2FtcGxlX21vZGUoYWQxODQzX3QgKmFkMTg0MywgaW50IG9u
b2ZmKTsKK2ludCBhZDE4NDNfc2V0X3JlY3NyYyhhZDE4NDNfdCAqYWQxODQzLCBpbnQgbmV3c3Jj
KTsKK2ludCBhZDE4NDNfZ2V0X291dHNyYyhhZDE4NDNfdCAqYWQxODQzKTsKK2ludCBhZDE4NDNf
c2V0X291dHNyYyhhZDE4NDNfdCAqYWQxODQzLCBpbnQgbWFzayk7Cit2b2lkIGFkMTg0M19zZXR1
cF9kYWMoYWQxODQzX3QgKmFkMTg0MywKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgaWQsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZyYW1lcmF0ZSwKKyAg
ICAgICAgICAgICAgICAgICAgICBzbmRfcGNtX2Zvcm1hdF90IGZtdCwKKyAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBpbnQgY2hhbm5lbHMpOwordm9pZCBhZDE4NDNfc2h1dGRvd25fZGFj
KGFkMTg0M190ICphZDE4NDMsCisgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IGlkKTsKK3ZvaWQgYWQxODQzX3NldHVwX2FkYyhhZDE4NDNfdCAqYWQxODQzLAorICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmcmFtZXJhdGUsCisgICAgICAgICAgICAgICAgICAg
ICAgc25kX3BjbV9mb3JtYXRfdCBmbXQsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IGNoYW5uZWxzKTsKK3ZvaWQgYWQxODQzX3NodXRkb3duX2FkYyhhZDE4NDNfdCAqYWQxODQz
KTsKK2ludCBhZDE4NDNfaW5pdChhZDE4NDNfdCAqYWQxODQzKTsKKworI2VuZGlmIC8qIF9fU09V
TkRfQUQxODQzX0ggKi8K
------=_Part_3506_7761875.1173713165503--
