Received: with ECARTIS (v1.0.0; list linux-mips); Thu, 07 Apr 2005 13:29:52 +0100 (BST)
Received: from alg145.algor.co.uk ([IPv6:::ffff:62.254.210.145]:21010 "EHLO
	dmz.algor.co.uk") by linux-mips.org with ESMTP id <S8224942AbVDGM3g>;
	Thu, 7 Apr 2005 13:29:36 +0100
Received: from alg158.algor.co.uk ([62.254.210.158] helo=olympia.mips.com)
	by dmz.algor.co.uk with esmtp (Exim 3.35 #1 (Debian))
	id 1DJWBi-0000iD-00; Thu, 07 Apr 2005 13:32:46 +0100
Received: from arsenal.mips.com ([192.168.192.197])
	by olympia.mips.com with esmtp (Exim 3.36 #1 (Debian))
	id 1DJW7e-0008O1-00; Thu, 07 Apr 2005 13:28:34 +0100
Received: from dom by arsenal.mips.com with local (Exim 4.44)
	id 1DJW7d-0002WM-KW; Thu, 07 Apr 2005 13:28:33 +0100
From:	Dominic Sweetman <dom@mips.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <16981.10097.547098.639380@arsenal.mips.com>
Date:	Thu, 7 Apr 2005 13:28:33 +0100
To:	Greg Weeks <greg.weeks@timesys.com>
Cc:	Ralf Baechle <ralf@linux-mips.org>, linux-mips@linux-mips.org
Subject: Re: memcpy prefetch
In-Reply-To: <4255240E.4050701@timesys.com>
References: <4253D67C.4010705@timesys.com>
	<20050406200848.GB4978@linux-mips.org>
	<4255240E.4050701@timesys.com>
X-Mailer: VM 7.17 under 21.4 (patch 17) "Jumbo Shrimp" XEmacs Lucid
X-MTUK-Scanner:	Found to be clean
X-MTUK-SpamCheck: not spam (whitelisted), SpamAssassin (score=-4.823,
	required 4, AWL, BAYES_00)
Return-Path: <dom@mips.com>
X-Envelope-To: <"|/home/ecartis/ecartis -s linux-mips"> (uid 0)
X-Orcpt: rfc822;linux-mips@linux-mips.org
Original-Recipient: rfc822;linux-mips@linux-mips.org
X-archive-position: 7625
X-ecartis-version: Ecartis v1.0.0
Sender: linux-mips-bounce@linux-mips.org
Errors-to: linux-mips-bounce@linux-mips.org
X-original-sender: dom@mips.com
Precedence: bulk
X-list: linux-mips


Greg Weeks (greg.weeks@timesys.com) writes:

> What's the performance hit for doing a pref on a cache line that is 
> already pref'd? Does it turn into a nop, or do we get some horrible 
> degenerate case?

The specification for the prefetch instruction is fairly wide, to
permit different implementations to act differently.  It's perfectly
legal for it to be a no-op.  However, implementors are told that they
should not do anything which would make performance *worse* than if it
was a no-op.

> Are 64 bit processors always at least 32 byte cache line size?

There's no reliable correlation.  If you were to go round the
"autogenerated at kernel-startup-time" route, then you can figure out
the line size from the "Config" registers (MIPS32- or MIPS64-compliant
CPUs) or from a table of CPU IDs or otherwise (earlier CPUs)...

--
Dominic Sweetman
MIPS Technologies
