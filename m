Received: with ECARTIS (v1.0.0; list linux-mips); Sun, 10 Jul 2016 15:08:29 +0200 (CEST)
Received: from fzex.ruijie.com.cn ([120.35.11.201]:47933 "EHLO
        mxfz.ruijie.com.cn" rhost-flags-OK-FAIL-OK-FAIL)
        by eddie.linux-mips.org with ESMTP id S23992998AbcGJNIWRjsaJ (ORCPT
        <rfc822;linux-mips@linux-mips.org>); Sun, 10 Jul 2016 15:08:22 +0200
Received: from FZEX.ruijie.com.cn ([fe80::3515:e8b7:859f:b0a6]) by
 fzex2.ruijie.com.cn ([fe80::8d50:8240:513b:8e5b%12]) with mapi id
 14.03.0123.003; Sun, 10 Jul 2016 21:08:16 +0800
From:   <yhb@ruijie.com.cn>
To:     <ralf@linux-mips.org>
CC:     <linux-mips@linux-mips.org>
Subject: MIPS: Make the ASID wrapping problem expose earlier
Thread-Topic: MIPS: Make the ASID wrapping problem expose earlier
Thread-Index: AdHaq7r8ZZGCqdrnT0Kn4C44f9LBTA==
Date:   Sun, 10 Jul 2016 13:08:15 +0000
Message-ID: <80B78A8B8FEE6145A87579E8435D78C30205D5FD@fzex.ruijie.com.cn>
Accept-Language: zh-CN, en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [192.168.21.106]
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Return-Path: <yhb@ruijie.com.cn>
X-Envelope-To: <"|/home/ecartis/ecartis -s linux-mips"> (uid 0)
X-Orcpt: rfc822;linux-mips@linux-mips.org
Original-Recipient: rfc822;linux-mips@linux-mips.org
X-archive-position: 54277
X-ecartis-version: Ecartis v1.0.0
Sender: linux-mips-bounce@linux-mips.org
Errors-to: linux-mips-bounce@linux-mips.org
X-original-sender: yhb@ruijie.com.cn
Precedence: bulk
List-help: <mailto:ecartis@linux-mips.org?Subject=help>
List-unsubscribe: <mailto:ecartis@linux-mips.org?subject=unsubscribe%20linux-mips>
List-software: Ecartis version 1.0.0
List-Id: linux-mips <linux-mips.eddie.linux-mips.org>
X-List-ID: linux-mips <linux-mips.eddie.linux-mips.org>
List-subscribe: <mailto:ecartis@linux-mips.org?subject=subscribe%20linux-mips>
List-owner: <mailto:ralf@linux-mips.org>
List-post: <mailto:linux-mips@linux-mips.org>
List-archive: <http://www.linux-mips.org/archives/linux-mips/>
X-list: linux-mips

RnJvbSAxNmMwZDEwMWVmMmJlNzkxNmUwMDg4ZWViYjgxMDEzNzAyZDBkMGQ4IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQ0KRnJvbTogeWhiIDx5aGJAcnVpamllLmNvbS5jbj4NCkRhdGU6IFN1biwg
MTAgSnVsIDIwMTYgMTk6Mzk6NDMgKzA4MDANClN1YmplY3Q6IFtQQVRDSF0gTUlQUzogTWFrZSB0
aGUgQVNJRCB3cmFwcGluZyBwcm9ibGVtIGV4cG9zZSBlYXJsaWVyDQoNCiAgT3VyIGNvbXBhbnkg
dXNlcyB0aGUgTGludXgga2VybmVsIDIuNi4zMi4xMywgYW5kIHJlY2VudGx5IHRoZSBBU0lEIHdy
YXBwaW5nIHByb2JsZW0gZm9yIHRoZSBNSVBTNjQgQ1BVcyBnZXRzIHVzIGludG8gdHJvdWJsZTog
TWFueSBwcm9jZXNzZXMgY3Jhc2ggZXZlcnkgYWJvdXQgMTAwIGRheXMuIFdlIGZpbmQgb3V0IHRo
YXQgQ1BVIEFTSUQgd3JhcHMgdG8gMC4NCnN0cnVjdCBjcHVpbmZvX21pcHMgew0KCXVuc2lnbmVk
IGludAkJdWRlbGF5X3ZhbDsNCgl1bnNpZ25lZCBpbnQJCWFzaWRfY2FjaGU7LyogVGhlIHR5cGUg
b2YgYXNpZF9jYWNoZSBpcyB1bnNpZ25lZCBpbnQhICovDQoJLi4uDQp9Ow0KDQpzdGF0aWMgaW5s
aW5lIHZvaWQNCmdldF9uZXdfbW11X2NvbnRleHQoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2ln
bmVkIGxvbmcgY3B1KQ0Kew0KCXVuc2lnbmVkIGxvbmcgYXNpZCA9IGFzaWRfY2FjaGUoY3B1KTsv
KiAoMSlUaGUgdHlwZSBvZiBhc2lkX2NhY2hlKGNwdSkgaXMgdW5zaWduZWQgaW50LiBTdXBwb3Nl
IGl0cyBjdXJyZW50IHZhbHVlIGlzIDB4RkZGRiBGRkZGLiAqLw0KDQoJaWYgKCEgKChhc2lkICs9
IEFTSURfSU5DKSAmIEFTSURfTUFTSykgKSB7LyogKDIpYXNpZCBpcyAweDEgMDAwMCAwMDAwLiAq
Lw0KCQkuLi4NCgkJaWYgKCFhc2lkKQkJLyogKDMpYXNpZCBpcyBub3QgemVybyEgKi8NCgkJCWFz
aWQgPSBBU0lEX0ZJUlNUX1ZFUlNJT047DQoJfQ0KCWNwdV9jb250ZXh0KGNwdSwgbW0pID0gYXNp
ZF9jYWNoZShjcHUpID0gYXNpZDsvKiAoNClCb3RoIGNwdV9jb250ZXh0KGNwdSwgbW0pIGFuZCBh
c2lkX2NhY2hlKGNwdSkgYXJlIHplcm8hICovDQp9DQoNCiAgRnVuY3Rpb24gc3dpdGNoX21tOg0K
CS8qIENoZWNrIGlmIG91ciBBU0lEIGlzIG9mIGFuIG9sZGVyIHZlcnNpb24gYW5kIHRodXMgaW52
YWxpZCAqLw0KCWlmICgoY3B1X2NvbnRleHQoY3B1LCBuZXh0KSBeIGFzaWRfY2FjaGUoY3B1KSkg
JiBBU0lEX1ZFUlNJT05fTUFTSykNCgkJZ2V0X25ld19tbXVfY29udGV4dChuZXh0LCBjcHUpOw0K
ICBJZiB0aGUgdmVyc2lvbiBvZiBhc2lkX2NhY2hlKGNwdSkgaXMgemVybywgYW5kIGNwdV9jb250
ZXh0KGNwdSwgbmV4dCkgaXMgemVybywgdGhpcyBmdW5jdGlvbiB3aWxsIG5vdCBhc3NpZ24gbmV3
IEFTSUQgdG8gdGhlIG5leHQgcHJvY2Vzcy4NCg0KICBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZSBB
U0lEcyBvZiBtYW55IHByb2Nlc3NlcyBhcmUgemVybywgYW5kIG1hbnkgcHJvY2Vzc2VzIGNyYXNo
Lg0KICBNYW55IExpbnV4IGRpc3RyaWJ1dGlvbnMgc3VjaCBhcyAyLjYuMzIuNzEgYW5kIDMuMTAu
eCBkb24ndCBmaXggdGhpcyBidWcuDQogIEkgc3Ryb25nbHkgYWR2aXNlIHRoYXQgdGhlIGNvbW11
bml0eSBhcHBseSB0aGUgcGF0Y2ggIk1JUFM6IENoYW5nZSB0eXBlIG9mIGFzaWRfY2FjaGUgdG8g
dW5zaWduZWQgbG9uZyIgdG8gYWxsIGxvbmd0ZXJtIGJyYW5jaGVzLg0KDQogIEluIG9yZGVyIHRv
IG1ha2UgdGhlIEFTSUQgd3JhcHBpbmcgcHJvYmxlbSBleHBvc2UgZWFybGllciwgc2V0IHRoZSBp
bml0aWFsIHZhbHVlIG9mIGFzaWRfY2FjaGUoY3B1KSB0byBBU0lEX0lOSVRJQUxfVkFMVUUoKCh1
bnNpZ25lZCBsb25nKS0xKSAmIEFTSURfVkVSU0lPTl9NQVNLKS4NCiAgSW4gb3JkZXIgdG8gcHJl
dmVudCBsYXRlciByZXZpc2lvbiBmcm9tIGludHJvZHVjaW5nIHRoZSBidWcgYWdhaW4sIGNvbXBh
cmUgdGhlIGxlbmd0aCBvZiBhc2lkIGFuZCBhc2lkX2NhY2hlKGNwdSkgaW4gZnVuY3Rpb24gZ2V0
X25ld19tbXVfY29udGV4dCBhbmQga3ZtX2dldF9uZXdfbW11X2NvbnRleHQ6DQoJQlVJTERfQlVH
X09OKHNpemVvZihhc2lkKSAhPSBzaXplb2YoYXNpZF9jYWNoZShjcHUpKSk7DQoNClNpZ25lZC1v
ZmYtYnk6IHloYiA8eWhiQHJ1aWppZS5jb20uY24+DQotLS0NCiBhcmNoL21pcHMvaW5jbHVkZS9h
c20vbW11X2NvbnRleHQuaCB8IDEyICsrKysrKysrKysrLQ0KIGFyY2gvbWlwcy9rZXJuZWwvdHJh
cHMuYyAgICAgICAgICAgIHwgIDIgKy0NCiBhcmNoL21pcHMva3ZtL3RsYi5jICAgICAgICAgICAg
ICAgICB8ICAyICsrDQogMyBmaWxlcyBjaGFuZ2VkLCAxNCBpbnNlcnRpb25zKCspLCAyIGRlbGV0
aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvYXJjaC9taXBzL2luY2x1ZGUvYXNtL21tdV9jb250ZXh0
LmggYi9hcmNoL21pcHMvaW5jbHVkZS9hc20vbW11X2NvbnRleHQuaA0KaW5kZXggNDU5MTRiNS4u
OWU0OTJmZiAxMDA2NDQNCi0tLSBhL2FyY2gvbWlwcy9pbmNsdWRlL2FzbS9tbXVfY29udGV4dC5o
DQorKysgYi9hcmNoL21pcHMvaW5jbHVkZS9hc20vbW11X2NvbnRleHQuaA0KQEAgLTk3LDYgKzk3
LDEzIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBlbnRlcl9sYXp5X3RsYihzdHJ1Y3QgbW1fc3RydWN0
ICptbSwgc3RydWN0IHRhc2tfc3RydWN0ICp0c2spDQogI2RlZmluZSBBU0lEX1ZFUlNJT05fTUFT
SyAgKCh1bnNpZ25lZCBsb25nKX4oQVNJRF9NQVNLfChBU0lEX01BU0stMSkpKQ0KICNkZWZpbmUg
QVNJRF9GSVJTVF9WRVJTSU9OICgodW5zaWduZWQgbG9uZykofkFTSURfVkVSU0lPTl9NQVNLKSAr
IDEpDQogDQorLyoNCisgKiBZdSBIdWFiaW5nDQorICogSW4gb3JkZXIgdG8gbWFrZSB0aGUgQVNJ
RCB3cmFwcGluZyBwcm9ibGVtIGV4cG9zZSBlYXJsaWVyLA0KKyAqIHNldCB0aGUgaW5pdGlhbCB2
YWx1ZSBvZiBhc2lkX2NhY2hlKGNwdSkgdG8gYSBsYXJnZSB2YWx1ZS4NCisgKi8NCisjZGVmaW5l
IEFTSURfSU5JVElBTF9WQUxVRSAoKCh1bnNpZ25lZCBsb25nKS0xKSAmIEFTSURfVkVSU0lPTl9N
QVNLKQ0KKw0KIC8qIE5vcm1hbCwgY2xhc3NpYyBNSVBTIGdldF9uZXdfbW11X2NvbnRleHQgKi8N
CiBzdGF0aWMgaW5saW5lIHZvaWQNCiBnZXRfbmV3X21tdV9jb250ZXh0KHN0cnVjdCBtbV9zdHJ1
Y3QgKm1tLCB1bnNpZ25lZCBsb25nIGNwdSkNCkBAIC0xMDQsNyArMTExLDEwIEBAIGdldF9uZXdf
bW11X2NvbnRleHQoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgY3B1KQ0KIAll
eHRlcm4gdm9pZCBrdm1fbG9jYWxfZmx1c2hfdGxiX2FsbCh2b2lkKTsNCiAJdW5zaWduZWQgbG9u
ZyBhc2lkID0gYXNpZF9jYWNoZShjcHUpOw0KIA0KLQlpZiAoISAoKGFzaWQgKz0gQVNJRF9JTkMp
ICYgQVNJRF9NQVNLKSApIHsNCisJQlVJTERfQlVHX09OKHNpemVvZihhc2lkKSAhPSBzaXplb2Yo
YXNpZF9jYWNoZShjcHUpKSk7DQorDQorCWFzaWQgKz0gQVNJRF9JTkM7DQorCWlmICghKGFzaWQg
JiBBU0lEX01BU0spKSB7DQogCQlpZiAoY3B1X2hhc192dGFnX2ljYWNoZSkNCiAJCQlmbHVzaF9p
Y2FjaGVfYWxsKCk7DQogI2lmZGVmIENPTkZJR19LVk0NCmRpZmYgLS1naXQgYS9hcmNoL21pcHMv
a2VybmVsL3RyYXBzLmMgYi9hcmNoL21pcHMva2VybmVsL3RyYXBzLmMNCmluZGV4IDRkNjAxNzM3
Li42MjY0Y2Q4IDEwMDY0NA0KLS0tIGEvYXJjaC9taXBzL2tlcm5lbC90cmFwcy5jDQorKysgYi9h
cmNoL21pcHMva2VybmVsL3RyYXBzLmMNCkBAIC0yMTM5LDcgKzIxMzksNyBAQCB2b2lkIHBlcl9j
cHVfdHJhcF9pbml0KGJvb2wgaXNfYm9vdF9jcHUpDQogCX0NCiANCiAJaWYgKCFjcHVfZGF0YVtj
cHVdLmFzaWRfY2FjaGUpDQotCQljcHVfZGF0YVtjcHVdLmFzaWRfY2FjaGUgPSBBU0lEX0ZJUlNU
X1ZFUlNJT047DQorCQljcHVfZGF0YVtjcHVdLmFzaWRfY2FjaGUgPSBBU0lEX0lOSVRJQUxfVkFM
VUU7DQogDQogCWF0b21pY19pbmMoJmluaXRfbW0ubW1fY291bnQpOw0KIAljdXJyZW50LT5hY3Rp
dmVfbW0gPSAmaW5pdF9tbTsNCmRpZmYgLS1naXQgYS9hcmNoL21pcHMva3ZtL3RsYi5jIGIvYXJj
aC9taXBzL2t2bS90bGIuYw0KaW5kZXggZTBlMWQwYS4uNzNjOGQ3YyAxMDA2NDQNCi0tLSBhL2Fy
Y2gvbWlwcy9rdm0vdGxiLmMNCisrKyBiL2FyY2gvbWlwcy9rdm0vdGxiLmMNCkBAIC01NjQsNiAr
NTY0LDggQEAgdm9pZCBrdm1fZ2V0X25ld19tbXVfY29udGV4dChzdHJ1Y3QgbW1fc3RydWN0ICpt
bSwgdW5zaWduZWQgbG9uZyBjcHUsDQogew0KIAl1bnNpZ25lZCBsb25nIGFzaWQgPSBhc2lkX2Nh
Y2hlKGNwdSk7DQogDQorCUJVSUxEX0JVR19PTihzaXplb2YoYXNpZCkgIT0gc2l6ZW9mKGFzaWRf
Y2FjaGUoY3B1KSkpOw0KKw0KIAlhc2lkICs9IEFTSURfSU5DOw0KIAlpZiAoIShhc2lkICYgQVNJ
RF9NQVNLKSkgew0KIAkJaWYgKGNwdV9oYXNfdnRhZ19pY2FjaGUpDQotLQ0K
