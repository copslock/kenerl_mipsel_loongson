Received: (from majordomo@localhost)
	by oss.sgi.com (8.11.2/8.11.3) id g2SCxPN09336
	for linux-mips-outgoing; Thu, 28 Mar 2002 04:59:25 -0800
Received: from delta.ds2.pg.gda.pl (macro@delta.ds2.pg.gda.pl [213.192.72.1])
	by oss.sgi.com (8.11.2/8.11.3) with SMTP id g2SCxKq09332
	for <linux-mips@oss.sgi.com>; Thu, 28 Mar 2002 04:59:20 -0800
Received: from localhost by delta.ds2.pg.gda.pl (8.9.3/8.9.3) with SMTP id OAA11915;
	Thu, 28 Mar 2002 14:01:51 +0100 (MET)
Date: Thu, 28 Mar 2002 14:01:51 +0100 (MET)
From: "Maciej W. Rozycki" <macro@ds2.pg.gda.pl>
To: Harald Koerfgen <hkoerfg@web.de>
cc: Dave Airlie <airlied@csn.ul.ie>, Ralf Baechle <ralf@uni-koblenz.de>,
   linux-mips@fnet.fr, linux-mips@oss.sgi.com
Subject: Re: [patch] linux: declance multicast filter fixes
In-Reply-To: <E16qKqX-00062M-00@smtp.web.de>
Message-ID: <Pine.GSO.3.96.1020328134253.11187B-100000@delta.ds2.pg.gda.pl>
Organization: Technical University of Gdansk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Sender: owner-linux-mips@oss.sgi.com
Precedence: bulk

On Wed, 27 Mar 2002, Harald Koerfgen wrote:

> The 7990 is basically a 16-bit chip in a 32-bit environment, and, AFAIR, uses 
> two different DMA modes to access host memory. One is a 16-bit word-by-word 
> access for the ring descriptors and the other is 8 16-bit-words-bursts for 
> accessing the ring buffers themselves, where the LANCE only generates one 
> target address per burst.
> 
> The IOASIC is, just as the CPU, only capable of doing 32-bit transfers 
> to/from memory. So 16-bit LANCE accesses are translated into 32-bit IOASIC 
> accesses but a part of the DMA target addresses are generated by the LANCE.

 But the I/O ASIC chip is smart enough to merge data from the 8-bit ROM
device without problems and present four consecutive bytes as 32-bit
quantities to the host CPU.  Why couldn't it do the same for the LANCE?
Host memory addresses are generated on behalf of the LANCE by the I/O ASIC
anyway.

 Of course not all designers have a clue, sigh...  A brief study of
available documentation suggests no merging mode was implemented for the
LANCE and bit 0 of addresses generated is simply hardwired to 0. :-(

-- 
+  Maciej W. Rozycki, Technical University of Gdansk, Poland   +
+--------------------------------------------------------------+
+        e-mail: macro@ds2.pg.gda.pl, PGP key available        +
